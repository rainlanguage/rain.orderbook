{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../node_modules/flowbite-svelte-icons/dist/CheckOutline.svelte","../../../../../../../node_modules/flowbite-svelte-icons/dist/CloseOutline.svelte","../../../../../../src/lib/services/applySettings.ts","../../../../../../src/lib/components/CodeMirrorConfigSource.svelte","../../../../../../src/routes/settings/+page.svelte"],"sourcesContent":["<script>import { getContext } from \"svelte\";\nimport { twMerge } from \"tailwind-merge\";\nconst ctx = getContext(\"iconCtx\") ?? {};\nconst sizes = {\n    xs: \"w-3 h-3\",\n    sm: \"w-4 h-4\",\n    md: \"w-5 h-5\",\n    lg: \"w-6 h-6\",\n    xl: \"w-8 h-8\"\n};\nexport let size = ctx.size || \"md\";\nexport let role = ctx.role || \"img\";\nexport let strokeLinecap = ctx.strokeLinecap || \"round\";\nexport let strokeLinejoin = ctx.strokeLinejoin || \"round\";\nexport let strokeWidth = ctx.strokeWidth || \"2\";\nexport let ariaLabel = \"check outline\";\n</script>\n\n<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  fill=\"none\"\n  {...$$restProps}\n  class={twMerge('shrink-0', sizes[size], $$props.class)}\n  {role}\n  aria-label={ariaLabel}\n  viewBox=\"0 0 16 12\"\n  on:click\n  on:keydown\n  on:keyup\n  on:focus\n  on:blur\n  on:mouseenter\n  on:mouseleave\n  on:mouseover\n  on:mouseout\n>\n  <path\n    stroke=\"currentColor\"\n    stroke-linecap={strokeLinecap}\n    stroke-linejoin={strokeLinejoin}\n    stroke-width={strokeWidth}\n    d=\"M1 5.917 5.724 10.5 15 1.5\"\n  />\n</svg>\n\n<!--\n@component\n[Go to docs](https://flowbite-svelte-icons.vercel.app/)\n## Props\n@prop export let size: 'xs' | 'sm' | 'md' | 'lg' | 'xl' = ctx.size || 'md';\n@prop export let role = ctx.role || 'img';\n@prop export let strokeLinecap: 'round' | 'inherit' | 'butt' | 'square' | null | undefined =\n    ctx.strokeLinecap || 'round';\n@prop export let strokeLinejoin: 'round' | 'inherit' | 'miter' | 'bevel' | null | undefined =\n    ctx.strokeLinejoin || 'round';\n@prop export let strokeWidth = ctx.strokeWidth || '2';\n@prop export let ariaLabel = 'check outline';\n-->\n","<script>import { getContext } from \"svelte\";\nimport { twMerge } from \"tailwind-merge\";\nconst ctx = getContext(\"iconCtx\") ?? {};\nconst sizes = {\n    xs: \"w-3 h-3\",\n    sm: \"w-4 h-4\",\n    md: \"w-5 h-5\",\n    lg: \"w-6 h-6\",\n    xl: \"w-8 h-8\"\n};\nexport let size = ctx.size || \"md\";\nexport let role = ctx.role || \"img\";\nexport let strokeLinecap = ctx.strokeLinecap || \"round\";\nexport let strokeLinejoin = ctx.strokeLinejoin || \"round\";\nexport let strokeWidth = ctx.strokeWidth || \"2\";\nexport let ariaLabel = \"close outline\";\n</script>\n\n<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  fill=\"none\"\n  {...$$restProps}\n  class={twMerge('shrink-0', sizes[size], $$props.class)}\n  {role}\n  aria-label={ariaLabel}\n  viewBox=\"0 0 14 14\"\n  on:click\n  on:keydown\n  on:keyup\n  on:focus\n  on:blur\n  on:mouseenter\n  on:mouseleave\n  on:mouseover\n  on:mouseout\n>\n  <path\n    stroke=\"currentColor\"\n    stroke-linecap={strokeLinecap}\n    stroke-linejoin={strokeLinejoin}\n    stroke-width={strokeWidth}\n    d=\"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6\"\n  />\n</svg>\n\n<!--\n@component\n[Go to docs](https://flowbite-svelte-icons.vercel.app/)\n## Props\n@prop export let size: 'xs' | 'sm' | 'md' | 'lg' | 'xl' = ctx.size || 'md';\n@prop export let role = ctx.role || 'img';\n@prop export let strokeLinecap: 'round' | 'inherit' | 'butt' | 'square' | null | undefined =\n    ctx.strokeLinecap || 'round';\n@prop export let strokeLinejoin: 'round' | 'inherit' | 'miter' | 'bevel' | null | undefined =\n    ctx.strokeLinejoin || 'round';\n@prop export let strokeWidth = ctx.strokeWidth || '2';\n@prop export let ariaLabel = 'close outline';\n-->\n","import type { Writable } from 'svelte/store';\nimport { reportErrorToSentry, SentrySeverityLevel } from '$lib/services/sentry';\nimport { checkSettingsErrors } from './config';\n\nexport type ParseConfigSourceFn = (settingsContent: string) => Promise<void>;\n\nexport interface ApplySettingsResult {\n  settingsStatus: 'checking' | 'success' | 'error';\n  errorMessage?: string;\n}\n\nexport async function applySettings(\n  settingsContent: string,\n  settingsTextStore: Writable<string>,\n): Promise<ApplySettingsResult> {\n  try {\n    await checkSettingsErrors([settingsContent]);\n    settingsTextStore.set(settingsContent);\n    return { settingsStatus: 'success' };\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    reportErrorToSentry(error, SentrySeverityLevel.Info);\n    return { settingsStatus: 'error', errorMessage };\n  }\n}\n","<script lang=\"ts\">\n  import CodeMirror from 'svelte-codemirror-editor';\n  import { codeMirrorTheme } from '$lib/stores/darkMode';\n  import { yaml } from '@codemirror/lang-yaml';\n  import { checkConfigErrors } from '$lib/services/configCodemirrorProblems';\n  import { RawRainlangExtension } from 'codemirror-rainlang';\n  import { openLintPanel } from '@codemirror/lint';\n\n  export let value: string;\n  export let disabled = false;\n  export let styles = {};\n\n  const configStringExtension = new RawRainlangExtension({\n    hover: async () => null,\n    completion: async () => null,\n    diagnostics: async (textDocument) => checkConfigErrors([textDocument.text]),\n  });\n</script>\n\n<CodeMirror\n  bind:value\n  extensions={[configStringExtension]}\n  lang={yaml()}\n  theme={$codeMirrorTheme}\n  readonly={disabled}\n  useTab={true}\n  tabSize={2}\n  styles={{\n    '&': {\n      width: '100%',\n    },\n    ...styles,\n  }}\n  on:ready={(e) => {\n    openLintPanel(e.detail);\n  }}\n/>\n\n<style global>\n  :global(.Í¼1 .cm-panel.cm-panel-lint ul [aria-selected]) {\n    background-color: inherit;\n  }\n</style>\n","<script lang=\"ts\">\n  import { Alert, Spinner } from 'flowbite-svelte';\n  import { settingsText, settingsFile } from '$lib/stores/settings';\n  import { PageHeader } from '@rainlanguage/ui-components';\n  import CodeMirrorConfigSource from '$lib/components/CodeMirrorConfigSource.svelte';\n  import FileTextarea from '$lib/components/FileTextarea.svelte';\n  import { useDebouncedFn } from '$lib/utils/asyncDebounce';\n  import { onMount } from 'svelte';\n  import { CheckOutline, CloseOutline } from 'flowbite-svelte-icons';\n  import { page } from '$app/stores';\n  import { applySettings, type ApplySettingsResult } from '$lib/services/applySettings';\n  import { get } from 'svelte/store';\n\n  let settingsStatus: ApplySettingsResult['settingsStatus'] = 'checking';\n  let errorMessage: string | undefined = undefined;\n  let height = 500;\n\n  function updateHeight() {\n    height = window.innerHeight - 320;\n  }\n\n  onMount(() => {\n    updateHeight();\n    window.addEventListener('resize', updateHeight);\n    const fileText = get(settingsFile).text;\n    if (fileText && fileText.trim() !== '') {\n      handleApply(fileText);\n    } else {\n      settingsStatus = 'success';\n      errorMessage = undefined;\n    }\n    return () => window.removeEventListener('resize', updateHeight);\n  });\n\n  async function handleApply(settingsContent: string): Promise<void> {\n    settingsStatus = 'checking';\n    errorMessage = undefined;\n\n    const result = await applySettings(settingsContent, settingsText);\n\n    settingsStatus = result.settingsStatus;\n    if (result.errorMessage) {\n      errorMessage = result.errorMessage;\n    }\n  }\n\n  const { debouncedFn: debouncedHandleApply } = useDebouncedFn(handleApply, 1000);\n\n  $: if (\n    $settingsFile.text !== undefined &&\n    typeof $settingsFile.text === 'string' &&\n    $settingsFile.text.trim() !== ''\n  ) {\n    debouncedHandleApply($settingsFile.text);\n  }\n</script>\n\n<div class=\"mb-4\">\n  <PageHeader title=\"Settings\" pathname={$page.url.pathname} />\n\n  <Alert color=\"blue\" class=\"mb-4 mt-8 text-lg\">\n    Looking for some settings to get started? Check out the <a\n      class=\"underline\"\n      target=\"_blank\"\n      href=\"https://docs.rainlang.xyz/raindex/getting-started\">getting started guide</a\n    >\n  </Alert>\n</div>\n\n<FileTextarea textFile={settingsFile}>\n  <svelte:fragment slot=\"alert\">\n    {#if settingsStatus === 'checking'}\n      <Alert color=\"blue\" class=\"flex h-10 items-center text-blue-600 dark:text-blue-400\">\n        <Spinner class=\"mr-2\" size=\"4\" />\n        <span>Checking settings...</span>\n      </Alert>\n    {:else if settingsStatus === 'success'}\n      <Alert color=\"green\" class=\"flex h-10 items-center text-green-600 dark:text-green-400\">\n        <CheckOutline class=\"mr-2\" size=\"xs\" />\n        <span>Settings applied successfully</span>\n      </Alert>\n    {:else if settingsStatus === 'error'}\n      <Alert color=\"red\" class=\"flex flex-col text-red-600 dark:text-red-400\">\n        <div class=\"mb-2 flex items-center\">\n          <CloseOutline class=\"mr-2\" size=\"xs\" />\n          <span>Error applying settings</span>\n        </div>\n        <span>{errorMessage}</span>\n      </Alert>\n    {/if}\n  </svelte:fragment>\n\n  <svelte:fragment slot=\"textarea\">\n    <CodeMirrorConfigSource\n      bind:value={$settingsFile.text}\n      styles={{ '&': { maxHeight: `${height - (errorMessage ? 35 : 0)}px`, height: '100%' } }}\n    />\n  </svelte:fragment>\n</FileTextarea>\n"],"names":[],"mappings":"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","x_google_ignoreList":[0,1]}