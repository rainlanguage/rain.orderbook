{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../packages/ui-components/dist/components/VaultCard.svelte","../../../../../../../packages/ui-components/dist/components/tables/OrdersListTable.svelte","../../../../../../src/routes/orders/+page.svelte"],"sourcesContent":["<script>import { goto } from \"$app/navigation\";\nexport let vault;\nconst handleClick = (event) => {\n  event.stopPropagation();\n  event.preventDefault();\n  goto(`/vaults/${vault.chainId}-${vault.orderbook}-${vault.id}`);\n};\n</script>\n\n<button\n\ttype=\"button\"\n\tclass=\"flex flex-col rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-left shadow-sm transition-colors hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-700 dark:hover:bg-gray-600\"\n\ton:click={handleClick}\n\tdata-testid=\"vault-card\"\n>\n\t<span class=\"font-semibold text-gray-800 dark:text-gray-200\">{vault.token.symbol}</span>\n\t<span class=\"truncate text-xs text-gray-500 dark:text-gray-400\">{vault.formattedBalance}</span>\n</button>\n","<script>import { getNetworkName } from \"../../utils/getNetworkName\";\nimport { goto } from \"$app/navigation\";\nimport { DotsVerticalOutline } from \"flowbite-svelte-icons\";\nimport { createInfiniteQuery, createQuery } from \"@tanstack/svelte-query\";\nimport { RaindexOrder } from \"@rainlanguage/orderbook\";\nimport TanstackAppTable from \"../TanstackAppTable.svelte\";\nimport { formatTimestampSecondsAsLocal } from \"../../services/time\";\nimport ListViewOrderbookFilters from \"../ListViewOrderbookFilters.svelte\";\nimport Hash, { HashType } from \"../Hash.svelte\";\nimport VaultCard from \"../VaultCard.svelte\";\nimport { DEFAULT_PAGE_SIZE, DEFAULT_REFRESH_INTERVAL } from \"../../queries/constants\";\nimport { QKEY_ORDERS, QKEY_TOKENS } from \"../../queries/keys\";\nimport {\n  Badge,\n  Button,\n  Dropdown,\n  DropdownItem,\n  TableBodyCell,\n  TableHeadCell\n} from \"flowbite-svelte\";\nimport { useAccount } from \"../../providers/wallet/useAccount\";\nimport { useRaindexClient } from \"../../hooks/useRaindexClient\";\nimport { getAllContexts } from \"svelte\";\nconst context = getAllContexts();\nexport let handleOrderRemoveModal = void 0;\nexport let selectedChainIds;\nexport let activeAccountsItems;\nexport let showInactiveOrders;\nexport let orderHash;\nexport let hideZeroBalanceVaults;\nexport let hideInactiveOrdersVaults;\nexport let showMyItemsOnly;\nexport let activeTokens;\nexport let activeOrderbookAddresses;\nconst { matchesAccount, account } = useAccount();\nconst raindexClient = useRaindexClient();\n$: owners = $activeAccountsItems && Object.values($activeAccountsItems).length > 0 ? Object.values($activeAccountsItems) : $showMyItemsOnly && $account ? [$account] : [];\n$: tokensQuery = createQuery({\n  queryKey: [QKEY_TOKENS, $selectedChainIds],\n  queryFn: async () => {\n    const result = await raindexClient.getAllVaultTokens($selectedChainIds);\n    if (result.error) throw new Error(result.error.readableMsg);\n    return result.value;\n  },\n  enabled: true\n});\n$: selectedTokens = $activeTokens?.filter(\n  (address) => !$tokensQuery.data || $tokensQuery.data.some((t) => t.address === address)\n) ?? [];\n$: orderbooksMap = raindexClient.getAllOrderbooks()?.value ?? /* @__PURE__ */ new Map();\n$: availableOrderbookAddresses = (() => {\n  const addrs = [];\n  orderbooksMap.forEach((cfg) => {\n    if ($selectedChainIds.length === 0 || $selectedChainIds.includes(cfg.network.chainId)) {\n      addrs.push(cfg.address.toLowerCase());\n    }\n  });\n  return addrs;\n})();\n$: selectedOrderbookAddresses = $activeOrderbookAddresses?.filter(\n  (address) => availableOrderbookAddresses.includes(address.toLowerCase())\n) ?? [];\n$: query = createInfiniteQuery({\n  queryKey: [\n    QKEY_ORDERS,\n    $selectedChainIds,\n    owners,\n    $showInactiveOrders,\n    $orderHash,\n    selectedTokens,\n    selectedOrderbookAddresses\n  ],\n  queryFn: async ({ pageParam }) => {\n    const result = await raindexClient.getOrders(\n      $selectedChainIds,\n      {\n        owners,\n        active: $showInactiveOrders ? void 0 : true,\n        orderHash: $orderHash || void 0,\n        tokens: selectedTokens.length > 0 ? { inputs: selectedTokens, outputs: selectedTokens } : void 0,\n        orderbookAddresses: selectedOrderbookAddresses.length > 0 ? selectedOrderbookAddresses : void 0\n      },\n      pageParam + 1\n    );\n    if (result.error) throw new Error(result.error.readableMsg);\n    return result.value;\n  },\n  initialPageParam: 0,\n  getNextPageParam(lastPage, _allPages, lastPageParam) {\n    return lastPage.length === DEFAULT_PAGE_SIZE ? lastPageParam + 1 : void 0;\n  },\n  refetchInterval: DEFAULT_REFRESH_INTERVAL,\n  enabled: true\n});\nconst AppTable = TanstackAppTable;\n</script>\n\n<ListViewOrderbookFilters\n\t{selectedChainIds}\n\t{activeAccountsItems}\n\t{showMyItemsOnly}\n\t{showInactiveOrders}\n\t{orderHash}\n\t{hideZeroBalanceVaults}\n\t{hideInactiveOrdersVaults}\n\t{tokensQuery}\n\t{activeTokens}\n\t{selectedTokens}\n\t{activeOrderbookAddresses}\n\t{selectedOrderbookAddresses}\n/>\n\n<AppTable\n\t{query}\n\tqueryKey={QKEY_ORDERS}\n\temptyMessage=\"No Orders Found\"\n\ton:clickRow={(e) => {\n\t\tgoto(`/orders/${e.detail.item.chainId}-${e.detail.item.orderbook}-${e.detail.item.orderHash}`);\n\t}}\n>\n\t<svelte:fragment slot=\"title\">\n\t\t<div class=\"mt-2 flex w-full justify-between\">\n\t\t\t<div class=\"text-3xl font-medium dark:text-white\" data-testid=\"title\">Orders</div>\n\t\t\t<slot name=\"filters\" />\n\t\t</div>\n\t</svelte:fragment>\n\n\t<svelte:fragment slot=\"head\">\n\t\t<TableHeadCell data-testid=\"orderListHeadingNetwork\" padding=\"p-4\">Network</TableHeadCell>\n\t\t<TableHeadCell data-testid=\"orderListHeadingActive\" padding=\"p-4\">Active</TableHeadCell>\n\t\t<TableHeadCell data-testid=\"orderListHeadingID\" padding=\"p-4\">Order</TableHeadCell>\n\t\t<TableHeadCell data-testid=\"orderListHeadingOwner\" padding=\"p-4\">Owner</TableHeadCell>\n\t\t<TableHeadCell data-testid=\"orderListHeadingOrderbook\" padding=\"p-4\">Orderbook</TableHeadCell>\n\t\t<TableHeadCell data-testid=\"orderListHeadingLastAdded\" padding=\"p-4\">Last Added</TableHeadCell>\n\t\t<TableHeadCell data-testid=\"orderListHeadingInputs\" padding=\"px-2 py-4\"\n\t\t\t>Input Token(s)</TableHeadCell\n\t\t>\n\t\t<TableHeadCell data-testid=\"orderListHeadingOutputs\" padding=\"px-2 py-4\"\n\t\t\t>Output Token(s)</TableHeadCell\n\t\t>\n\t\t<TableHeadCell data-testid=\"orderListHeadingTrades\" padding=\"px-2 py-4\">Trades</TableHeadCell>\n\t</svelte:fragment>\n\n\t<svelte:fragment slot=\"bodyRow\" let:item>\n\t\t<TableBodyCell data-testid=\"orderListRowNetwork\" tdClass=\"px-4 py-2\">\n\t\t\t{getNetworkName(Number(item.chainId))}\n\t\t</TableBodyCell>\n\t\t<TableBodyCell data-testid=\"orderListRowActive\" tdClass=\"px-4 py-2\">\n\t\t\t{#if item.active}\n\t\t\t\t<Badge color=\"green\">Active</Badge>\n\t\t\t{:else}\n\t\t\t\t<Badge color=\"yellow\">Inactive</Badge>\n\t\t\t{/if}\n\t\t</TableBodyCell>\n\t\t<TableBodyCell data-testid=\"orderListRowID\" tdClass=\"break-all px-4 py-4\">\n\t\t\t<Hash type={HashType.Identifier} value={item.orderHash} />\n\t\t</TableBodyCell>\n\t\t<TableBodyCell data-testid=\"orderListRowOwner\" tdClass=\"break-all px-4 py-2\">\n\t\t\t<Hash type={HashType.Wallet} value={item.owner} />\n\t\t</TableBodyCell>\n\t\t<TableBodyCell data-testid=\"orderListRowOrderbook\" tdClass=\"break-all px-4 py-2\">\n\t\t\t<Hash type={HashType.Identifier} value={item.orderbook} />\n\t\t</TableBodyCell>\n\t\t<TableBodyCell data-testid=\"orderListRowLastAdded\" tdClass=\"break-word px-4 py-2\">\n\t\t\t{formatTimestampSecondsAsLocal(item.timestampAdded)}\n\t\t</TableBodyCell>\n\n\t\t<TableBodyCell data-testid=\"orderListRowInputs\" tdClass=\"p-2 whitespace-normal\">\n\t\t\t<div class=\"grid w-full grid-cols-1 gap-2 sm:grid-cols-2\">\n\t\t\t\t{#each item.inputsList.items as vault}\n\t\t\t\t\t<VaultCard {vault} />\n\t\t\t\t{/each}\n\t\t\t\t{#each item.inputsOutputsList.items as vault}\n\t\t\t\t\t{#if !item.inputsList.items.find((v) => v.id === vault.id)}\n\t\t\t\t\t\t<VaultCard {vault} />\n\t\t\t\t\t{/if}\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t</TableBodyCell>\n\n\t\t<TableBodyCell data-testid=\"orderListRowOutputs\" tdClass=\"p-2 whitespace-normal\">\n\t\t\t<div class=\"grid w-full grid-cols-1 gap-2 sm:grid-cols-2\">\n\t\t\t\t{#each item.outputsList.items as vault}\n\t\t\t\t\t<VaultCard {vault} />\n\t\t\t\t{/each}\n\t\t\t\t{#each item.inputsOutputsList.items as vault}\n\t\t\t\t\t{#if !item.outputsList.items.find((v) => v.id === vault.id)}\n\t\t\t\t\t\t<VaultCard {vault} />\n\t\t\t\t\t{/if}\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t</TableBodyCell>\n\n\t\t<TableBodyCell data-testid=\"orderListRowTrades\" tdClass=\"break-word p-2\">\n\t\t\t{item.tradesCount > 99 ? '>99' : item.tradesCount}\n\t\t</TableBodyCell>\n\t\t{#if matchesAccount(item.owner) && handleOrderRemoveModal}\n\t\t\t<div data-testid=\"wallet-actions\">\n\t\t\t\t<TableBodyCell tdClass=\"px-0 text-right\">\n\t\t\t\t\t{#if item.active}\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tcolor=\"alternative\"\n\t\t\t\t\t\t\toutline={false}\n\t\t\t\t\t\t\tdata-testid={`order-menu-${item.id}`}\n\t\t\t\t\t\t\tid={`order-menu-${item.id}`}\n\t\t\t\t\t\t\tclass=\"mr-2 border-none px-2\"\n\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<DotsVerticalOutline class=\"dark:text-white\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t{/if}\n\t\t\t\t</TableBodyCell>\n\n\t\t\t\t{#if item.active}\n\t\t\t\t\t<Dropdown placement=\"bottom-end\" triggeredBy={`#order-menu-${item.id}`}>\n\t\t\t\t\t\t<DropdownItem\n\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\thandleOrderRemoveModal(item, $query.refetch, context);\n\t\t\t\t\t\t\t}}>Remove</DropdownItem\n\t\t\t\t\t\t>\n\t\t\t\t\t</Dropdown>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t</svelte:fragment>\n</AppTable>\n","<script lang=\"ts\">\n  import { PageHeader } from '@rainlanguage/ui-components';\n  import { OrdersListTable } from '@rainlanguage/ui-components';\n  import { handleOrderRemoveModal } from '$lib/services/modal';\n  import {\n    selectedChainIds,\n    activeAccountsItems,\n    showInactiveOrders,\n    orderHash,\n    hideZeroBalanceVaults,\n    hideInactiveOrdersVaults,\n    activeTokens,\n    activeOrderbookAddresses,\n  } from '$lib/stores/settings';\n  import { page } from '$app/stores';\n  import { writable } from 'svelte/store';\n</script>\n\n<PageHeader title=\"Orders\" pathname={$page.url.pathname} />\n\n<OrdersListTable\n  {handleOrderRemoveModal}\n  {selectedChainIds}\n  {activeAccountsItems}\n  {showInactiveOrders}\n  {orderHash}\n  {hideZeroBalanceVaults}\n  {hideInactiveOrdersVaults}\n  {activeTokens}\n  {activeOrderbookAddresses}\n  showMyItemsOnly={writable(false)}\n/>\n"],"names":["handleOrderRemoveModal","selectedChainIds","activeAccountsItems","showInactiveOrders","orderHash","hideZeroBalanceVaults","hideInactiveOrdersVaults","activeTokens","activeOrderbookAddresses"],"mappings":"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"}