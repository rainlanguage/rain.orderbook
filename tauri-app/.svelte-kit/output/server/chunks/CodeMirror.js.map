{"version":3,"file":"CodeMirror.js","sources":["../../../../../node_modules/svelte-codemirror-editor/dist/CodeMirror.svelte"],"sourcesContent":["<script context=\"module\"></script>\n\n<script>import { createEventDispatcher, onDestroy, onMount } from \"svelte\";\nimport { basicSetup } from \"codemirror\";\nimport { EditorView, keymap, placeholder as placeholderExt } from \"@codemirror/view\";\nimport { EditorState, StateEffect } from \"@codemirror/state\";\nimport { indentWithTab } from \"@codemirror/commands\";\nimport { indentUnit } from \"@codemirror/language\";\nimport { debounce } from \"./util\";\nlet classes = \"\";\nexport { classes as class };\nexport let value = \"\";\nexport let basic = true;\nexport let lang = void 0;\nexport let theme = void 0;\nexport let extensions = [];\nexport let useTab = true;\nexport let tabSize = 2;\nexport let styles = void 0;\nexport let lineWrapping = false;\nexport let editable = true;\nexport let readonly = false;\nexport let placeholder = void 0;\nexport let nodebounce = false;\nconst is_browser = typeof window !== \"undefined\";\nconst dispatch = createEventDispatcher();\nlet element;\nlet view;\nlet update_from_prop = false;\nlet update_from_state = false;\nlet first_config = true;\nlet first_update = true;\n$: state_extensions = [\n  ...get_base_extensions(basic, useTab, tabSize, lineWrapping, placeholder, editable, readonly, lang),\n  ...get_theme(theme, styles),\n  ...extensions\n];\n$: view && update(value);\n$: view && state_extensions && reconfigure();\n$: on_change = nodebounce ? handle_change : debounce(handle_change, 300);\nonMount(() => {\n  view = create_editor_view();\n  dispatch(\"ready\", view);\n});\nonDestroy(() => view?.destroy());\nfunction create_editor_view() {\n  return new EditorView({\n    parent: element,\n    state: create_editor_state(value),\n    dispatch(transaction) {\n      view.update([transaction]);\n      if (!update_from_prop && transaction.docChanged) {\n        on_change();\n      }\n    }\n  });\n}\nfunction reconfigure() {\n  if (first_config) {\n    first_config = false;\n    return;\n  }\n  view.dispatch({\n    effects: StateEffect.reconfigure.of(state_extensions)\n  });\n  dispatch(\"reconfigure\", view);\n}\nfunction update(value2) {\n  if (first_update) {\n    first_update = false;\n    return;\n  }\n  if (update_from_state) {\n    update_from_state = false;\n    return;\n  }\n  update_from_prop = true;\n  view.setState(create_editor_state(value2));\n  update_from_prop = false;\n}\nfunction handle_change() {\n  const new_value = view.state.doc.toString();\n  if (new_value === value) return;\n  update_from_state = true;\n  value = new_value;\n  dispatch(\"change\", value);\n}\nfunction create_editor_state(value2) {\n  return EditorState.create({\n    doc: value2 ?? void 0,\n    extensions: state_extensions\n  });\n}\nfunction get_base_extensions(basic2, useTab2, tabSize2, lineWrapping2, placeholder2, editable2, readonly2, lang2) {\n  const extensions2 = [\n    indentUnit.of(\" \".repeat(tabSize2)),\n    EditorView.editable.of(editable2),\n    EditorState.readOnly.of(readonly2)\n  ];\n  if (basic2) extensions2.push(basicSetup);\n  if (useTab2) extensions2.push(keymap.of([indentWithTab]));\n  if (placeholder2) extensions2.push(placeholderExt(placeholder2));\n  if (lang2) extensions2.push(lang2);\n  if (lineWrapping2) extensions2.push(EditorView.lineWrapping);\n  return extensions2;\n}\nfunction get_theme(theme2, styles2) {\n  const extensions2 = [];\n  if (styles2) extensions2.push(EditorView.theme(styles2));\n  if (theme2) extensions2.push(theme2);\n  return extensions2;\n}\n</script>\n\n{#if is_browser}\n    <div class=\"codemirror-wrapper {classes}\" bind:this={element} />\n{:else}\n    <div class=\"scm-waiting {classes}\">\n        <div class=\"scm-waiting__loading scm-loading\">\n            <div class=\"scm-loading__spinner\" />\n            <p class=\"scm-loading__text\">Loading editor...</p>\n        </div>\n\n        <pre class=\"scm-pre cm-editor\">{value}</pre>\n    </div>\n{/if}\n\n<style>\n    .codemirror-wrapper :global(.cm-focused) {\n        outline: none;\n    }\n\n    .scm-waiting {\n        position: relative;\n    }\n    .scm-waiting__loading {\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n        background-color: rgba(255, 255, 255, 0.5);\n    }\n\n    .scm-loading {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    .scm-loading__spinner {\n        width: 1rem;\n        height: 1rem;\n        border-radius: 100%;\n        border: solid 2px #000;\n        border-top-color: transparent;\n        margin-right: 0.75rem;\n        animation: spin 1s linear infinite;\n    }\n    .scm-loading__text {\n        font-family: sans-serif;\n    }\n    .scm-pre {\n        font-size: 0.85rem;\n        font-family: monospace;\n        tab-size: 2;\n        -moz-tab-size: 2;\n        resize: none;\n        pointer-events: none;\n        user-select: none;\n        overflow: auto;\n    }\n\n    @keyframes spin {\n        0% {\n            transform: rotate(0deg);\n        }\n        100% {\n            transform: rotate(360deg);\n        }\n    }\n</style>\n"],"names":["placeholder","placeholderExt"],"mappings":";;;;;;;;;;;AASI,MAAA,EAAA,OAAA,UAAU,GAAE,IAAA;AAEL,MAAA,EAAA,QAAQ,GAAE,IAAA;AACV,MAAA,EAAA,QAAQ,KAAI,IAAA;AACZ,MAAA,EAAA,cAAa,IAAA;AACb,MAAA,EAAA,eAAc,IAAA;QACd,aAAU,CAAA,EAAA,IAAA;AACV,MAAA,EAAA,SAAS,KAAI,IAAA;AACb,MAAA,EAAA,UAAU,EAAC,IAAA;AACX,MAAA,EAAA,gBAAe,IAAA;AACf,MAAA,EAAA,eAAe,MAAK,IAAA;AACpB,MAAA,EAAA,WAAW,KAAI,IAAA;AACf,MAAA,EAAA,WAAW,MAAK,IAAA;AAChB,MAAA,eAAAA,uBAAoB,IAAA;AACpB,MAAA,EAAA,aAAa,MAAK,IAAA;QACvB,aAAU,OAAU,WAAW;AACpB,wBAAqB;MAClC;MACA;AAiBJ,YAAS,MAAO,MAAM,SAAO;WAiDpB,oBAAoB,QAAQ,SAAS,UAAU,eAAe,cAAc,WAAW,WAAW;UACnG,cAAW;AAAA,MACf,WAAW,GAAG,IAAI,OAAO,QAAQ,CAAA;AAAA,MACjC,WAAW,SAAS,GAAG,SAAS;AAAA,MAChC,YAAY,SAAS,GAAG,SAAS;AAAA;AAE/B,QAAA,OAAQ,aAAY,KAAK,UAAU;QACnC,QAAS,aAAY,KAAK,OAAO,GAAE,CAAE,aAAa,CAAA,CAAA;AAClD,QAAA,aAAc,aAAY,KAAKC,YAAe,YAAY,CAAA;AAC1D,QAAA,MAAO,aAAY,KAAK,KAAK;AAC7B,QAAA,cAAe,aAAY,KAAK,WAAW,YAAY;WACpD;AAAA;WAEA,UAAU,QAAQ,SAAO;UAC1B,cAAW,CAAA;QACb,QAAS,aAAY,KAAK,WAAW,MAAM,OAAO,CAAA;AAClD,QAAA,OAAQ,aAAY,KAAK,MAAM;WAC5B;AAAA;;;;;;;;;;;;;;;;AA9EU;AAAA,IACd,GAAA,oBAAoB,OAAO,QAAQ,SAAS,cAAcD,eAAa,UAAU,UAAU,IAAI;AAAA,OAC/F,UAAU,OAAO,MAAM;AAAA,IACvB,GAAA;AAAA;YA+EA,aAC+B,eAAA,wBAAA,OAAA,2DAAqB,SAAO,CAAA,CAAA,YAEnC,eAAA,iBAAA,OAAA,mTAMW,KAAK,CAAA,cAAA;;","x_google_ignoreList":[0]}