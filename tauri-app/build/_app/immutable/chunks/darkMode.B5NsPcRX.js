import{s as ba,x as Gs,i as ts,f as Se,r as Yo,I as $u,q as Ii,u as Zo,v as ct,w as ao,e as co,c as uo,b as fo,R as qs,G as ut,y as go,z as po,A as mo,H as va,W as Qo}from"./scheduler.D5AhQk_9.js";import{S as Uu,i as Xu,g as Gu,b as ni,e as qu,t as ri}from"./index.Y9UT4V4X.js";import{g as bo}from"./spread.CgU5AtxT.js";import{w as Ju,d as wa}from"./index.CVS4X9MZ.js";const vo="-",Yu=n=>{const t=Qu(n),{conflictingClassGroups:e,conflictingClassGroupModifiers:i}=n;return{getClassGroupId:o=>{const l=o.split(vo);return l[0]===""&&l.length!==1&&l.shift(),ya(l,t)||Zu(o)},getConflictingClassGroupIds:(o,l)=>{const h=e[o]||[];return l&&i[o]?[...h,...i[o]]:h}}},ya=(n,t)=>{if(n.length===0)return t.classGroupId;const e=n[0],i=t.nextPart.get(e),s=i?ya(n.slice(1),i):void 0;if(s)return s;if(t.validators.length===0)return;const r=n.join(vo);return t.validators.find(({validator:o})=>o(r))?.classGroupId},tl=/^\[(.+)\]$/,Zu=n=>{if(tl.test(n)){const t=tl.exec(n)[1],e=t?.substring(0,t.indexOf(":"));if(e)return"arbitrary.."+e}},Qu=n=>{const{theme:t,prefix:e}=n,i={nextPart:new Map,validators:[]};return ef(Object.entries(n.classGroups),e).forEach(([r,o])=>{ur(o,i,r,t)}),i},ur=(n,t,e,i)=>{n.forEach(s=>{if(typeof s=="string"){const r=s===""?t:el(t,s);r.classGroupId=e;return}if(typeof s=="function"){if(tf(s)){ur(s(i),t,e,i);return}t.validators.push({validator:s,classGroupId:e});return}Object.entries(s).forEach(([r,o])=>{ur(o,el(t,r),e,i)})})},el=(n,t)=>{let e=n;return t.split(vo).forEach(i=>{e.nextPart.has(i)||e.nextPart.set(i,{nextPart:new Map,validators:[]}),e=e.nextPart.get(i)}),e},tf=n=>n.isThemeGetter,ef=(n,t)=>t?n.map(([e,i])=>{const s=i.map(r=>typeof r=="string"?t+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([o,l])=>[t+o,l])):r);return[e,s]}):n,sf=n=>{if(n<1)return{get:()=>{},set:()=>{}};let t=0,e=new Map,i=new Map;const s=(r,o)=>{e.set(r,o),t++,t>n&&(t=0,i=e,e=new Map)};return{get(r){let o=e.get(r);if(o!==void 0)return o;if((o=i.get(r))!==void 0)return s(r,o),o},set(r,o){e.has(r)?e.set(r,o):s(r,o)}}},xa="!",nf=n=>{const{separator:t,experimentalParseClassName:e}=n,i=t.length===1,s=t[0],r=t.length,o=l=>{const h=[];let a=0,c=0,u;for(let b=0;b<l.length;b++){let v=l[b];if(a===0){if(v===s&&(i||l.slice(b,b+r)===t)){h.push(l.slice(c,b)),c=b+r;continue}if(v==="/"){u=b;continue}}v==="["?a++:v==="]"&&a--}const f=h.length===0?l:l.substring(c),g=f.startsWith(xa),p=g?f.substring(1):f,m=u&&u>c?u-c:void 0;return{modifiers:h,hasImportantModifier:g,baseClassName:p,maybePostfixModifierPosition:m}};return e?l=>e({className:l,parseClassName:o}):o},rf=n=>{if(n.length<=1)return n;const t=[];let e=[];return n.forEach(i=>{i[0]==="["?(t.push(...e.sort(),i),e=[]):e.push(i)}),t.push(...e.sort()),t},of=n=>({cache:sf(n.cacheSize),parseClassName:nf(n),...Yu(n)}),lf=/\s+/,hf=(n,t)=>{const{parseClassName:e,getClassGroupId:i,getConflictingClassGroupIds:s}=t,r=[],o=n.trim().split(lf);let l="";for(let h=o.length-1;h>=0;h-=1){const a=o[h],{modifiers:c,hasImportantModifier:u,baseClassName:f,maybePostfixModifierPosition:g}=e(a);let p=!!g,m=i(p?f.substring(0,g):f);if(!m){if(!p){l=a+(l.length>0?" "+l:l);continue}if(m=i(f),!m){l=a+(l.length>0?" "+l:l);continue}p=!1}const b=rf(c).join(":"),v=u?b+xa:b,w=v+m;if(r.includes(w))continue;r.push(w);const x=s(m,p);for(let y=0;y<x.length;++y){const k=x[y];r.push(v+k)}l=a+(l.length>0?" "+l:l)}return l};function af(){let n=0,t,e,i="";for(;n<arguments.length;)(t=arguments[n++])&&(e=ka(t))&&(i&&(i+=" "),i+=e);return i}const ka=n=>{if(typeof n=="string")return n;let t,e="";for(let i=0;i<n.length;i++)n[i]&&(t=ka(n[i]))&&(e&&(e+=" "),e+=t);return e};function cf(n,...t){let e,i,s,r=o;function o(h){const a=t.reduce((c,u)=>u(c),n());return e=of(a),i=e.cache.get,s=e.cache.set,r=l,l(h)}function l(h){const a=i(h);if(a)return a;const c=hf(h,e);return s(h,c),c}return function(){return r(af.apply(null,arguments))}}const Y=n=>{const t=e=>e[n]||[];return t.isThemeGetter=!0,t},Sa=/^\[(?:([a-z-]+):)?(.+)\]$/i,uf=/^\d+\/\d+$/,ff=new Set(["px","full","screen"]),df=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gf=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,pf=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,mf=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,bf=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ie=n=>Ze(n)||ff.has(n)||uf.test(n),fe=n=>pi(n,"length",Mf),Ze=n=>!!n&&!Number.isNaN(Number(n)),An=n=>pi(n,"number",Ze),bi=n=>!!n&&Number.isInteger(Number(n)),vf=n=>n.endsWith("%")&&Ze(n.slice(0,-1)),R=n=>Sa.test(n),de=n=>df.test(n),wf=new Set(["length","size","percentage"]),yf=n=>pi(n,wf,Ca),xf=n=>pi(n,"position",Ca),kf=new Set(["image","url"]),Sf=n=>pi(n,kf,Ef),Cf=n=>pi(n,"",Af),vi=()=>!0,pi=(n,t,e)=>{const i=Sa.exec(n);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):e(i[2]):!1},Mf=n=>gf.test(n)&&!pf.test(n),Ca=()=>!1,Af=n=>mf.test(n),Ef=n=>bf.test(n),Tf=()=>{const n=Y("colors"),t=Y("spacing"),e=Y("blur"),i=Y("brightness"),s=Y("borderColor"),r=Y("borderRadius"),o=Y("borderSpacing"),l=Y("borderWidth"),h=Y("contrast"),a=Y("grayscale"),c=Y("hueRotate"),u=Y("invert"),f=Y("gap"),g=Y("gradientColorStops"),p=Y("gradientColorStopPositions"),m=Y("inset"),b=Y("margin"),v=Y("opacity"),w=Y("padding"),x=Y("saturate"),y=Y("scale"),k=Y("sepia"),S=Y("skew"),C=Y("space"),L=Y("translate"),N=()=>["auto","contain","none"],F=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",R,t],A=()=>[R,t],V=()=>["",ie,fe],_=()=>["auto",Ze,R],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],nt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],st=()=>["start","end","center","between","around","evenly","stretch"],U=()=>["","0",R],rt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],J=()=>[Ze,R];return{cacheSize:500,separator:":",theme:{colors:[vi],spacing:[ie,fe],blur:["none","",de,R],brightness:J(),borderColor:[n],borderRadius:["none","","full",de,R],borderSpacing:A(),borderWidth:V(),contrast:J(),grayscale:U(),hueRotate:J(),invert:U(),gap:A(),gradientColorStops:[n],gradientColorStopPositions:[vf,fe],inset:z(),margin:z(),opacity:J(),padding:A(),saturate:J(),scale:J(),sepia:U(),skew:J(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",R]}],container:["container"],columns:[{columns:[de]}],"break-after":[{"break-after":rt()}],"break-before":[{"break-before":rt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),R]}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bi,R]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",R]}],grow:[{grow:U()}],shrink:[{shrink:U()}],order:[{order:["first","last","none",bi,R]}],"grid-cols":[{"grid-cols":[vi]}],"col-start-end":[{col:["auto",{span:["full",bi,R]},R]}],"col-start":[{"col-start":_()}],"col-end":[{"col-end":_()}],"grid-rows":[{"grid-rows":[vi]}],"row-start-end":[{row:["auto",{span:[bi,R]},R]}],"row-start":[{"row-start":_()}],"row-end":[{"row-end":_()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",R]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",R]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...st()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...st(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...st(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",R,t]}],"min-w":[{"min-w":[R,t,"min","max","fit"]}],"max-w":[{"max-w":[R,t,"none","full","min","max","fit","prose",{screen:[de]},de]}],h:[{h:[R,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[R,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[R,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[R,t,"auto","min","max","fit"]}],"font-size":[{text:["base",de,fe]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",An]}],"font-family":[{font:[vi]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",R]}],"line-clamp":[{"line-clamp":["none",Ze,An]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ie,R]}],"list-image":[{"list-image":["none",R]}],"list-style-type":[{list:["none","disc","decimal",R]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ie,fe]}],"underline-offset":[{"underline-offset":["auto",ie,R]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",R]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",R]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),xf]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yf]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Sf]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:X()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[ie,R]}],"outline-w":[{outline:[ie,fe]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[ie,fe]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",de,Cf]}],"shadow-color":[{shadow:[vi]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...nt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":nt()}],filter:[{filter:["","none"]}],blur:[{blur:[e]}],brightness:[{brightness:[i]}],contrast:[{contrast:[h]}],"drop-shadow":[{"drop-shadow":["","none",de,R]}],grayscale:[{grayscale:[a]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[u]}],saturate:[{saturate:[x]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[e]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[h]}],"backdrop-grayscale":[{"backdrop-grayscale":[a]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",R]}],duration:[{duration:J()}],ease:[{ease:["linear","in","out","in-out",R]}],delay:[{delay:J()}],animate:[{animate:["none","spin","ping","pulse","bounce",R]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[bi,R]}],"translate-x":[{"translate-x":[L]}],"translate-y":[{"translate-y":[L]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",R]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",R]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",R]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[ie,fe,An]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Df=cf(Tf);function Lf(n){let t=n[2],e,i,s=n[2]&&En(n);return{c(){s&&s.c(),e=Gs()},l(r){s&&s.l(r),e=Gs()},m(r,o){s&&s.m(r,o),ts(r,e,o),i=!0},p(r,o){r[2]?t?ba(t,r[2])?(s.d(1),s=En(r),t=r[2],s.c(),s.m(e.parentNode,e)):s.p(r,o):(s=En(r),t=r[2],s.c(),s.m(e.parentNode,e)):t&&(s.d(1),s=null,t=r[2])},i(r){i||(ri(s,r),i=!0)},o(r){ni(s,r),i=!1},d(r){r&&Se(e),s&&s.d(r)}}}function Of(n){let t,e,i,s;const r=n[12].default,o=ao(r,n,n[11],null);let l=[{type:n[1]},n[4],{class:n[3]}],h={};for(let a=0;a<l.length;a+=1)h=Ii(h,l[a]);return{c(){t=co("button"),o&&o.c(),this.h()},l(a){t=uo(a,"BUTTON",{type:!0,class:!0});var c=fo(t);o&&o.l(c),c.forEach(Se),this.h()},h(){qs(t,h)},m(a,c){ts(a,t,c),o&&o.m(t,null),t.autofocus&&t.focus(),e=!0,i||(s=[ut(t,"click",n[22]),ut(t,"change",n[23]),ut(t,"keydown",n[24]),ut(t,"keyup",n[25]),ut(t,"touchstart",n[26],{passive:!0}),ut(t,"touchend",n[27]),ut(t,"touchcancel",n[28]),ut(t,"mouseenter",n[29]),ut(t,"mouseleave",n[30])],i=!0)},p(a,c){o&&o.p&&(!e||c[0]&2048)&&go(o,r,a,a[11],e?mo(r,a[11],c,null):po(a[11]),null),qs(t,h=bo(l,[(!e||c[0]&2)&&{type:a[1]},c[0]&16&&a[4],(!e||c[0]&8)&&{class:a[3]}]))},i(a){e||(ri(o,a),e=!0)},o(a){ni(o,a),e=!1},d(a){a&&Se(t),o&&o.d(a),i=!1,va(s)}}}function Pf(n){let t,e,i,s;const r=n[12].default,o=ao(r,n,n[11],null);let l=[{href:n[0]},n[4],{class:n[3]},{role:"button"}],h={};for(let a=0;a<l.length;a+=1)h=Ii(h,l[a]);return{c(){t=co("a"),o&&o.c(),this.h()},l(a){t=uo(a,"A",{href:!0,class:!0,role:!0});var c=fo(t);o&&o.l(c),c.forEach(Se),this.h()},h(){qs(t,h)},m(a,c){ts(a,t,c),o&&o.m(t,null),e=!0,i||(s=[ut(t,"click",n[13]),ut(t,"change",n[14]),ut(t,"keydown",n[15]),ut(t,"keyup",n[16]),ut(t,"touchstart",n[17],{passive:!0}),ut(t,"touchend",n[18]),ut(t,"touchcancel",n[19]),ut(t,"mouseenter",n[20]),ut(t,"mouseleave",n[21])],i=!0)},p(a,c){o&&o.p&&(!e||c[0]&2048)&&go(o,r,a,a[11],e?mo(r,a[11],c,null):po(a[11]),null),qs(t,h=bo(l,[(!e||c[0]&1)&&{href:a[0]},c[0]&16&&a[4],(!e||c[0]&8)&&{class:a[3]},{role:"button"}]))},i(a){e||(ri(o,a),e=!0)},o(a){ni(o,a),e=!1},d(a){a&&Se(t),o&&o.d(a),i=!1,va(s)}}}function En(n){let t,e;const i=n[12].default,s=ao(i,n,n[11],null);let r=[n[4],{class:n[3]}],o={};for(let l=0;l<r.length;l+=1)o=Ii(o,r[l]);return{c(){t=co(n[2]),s&&s.c(),this.h()},l(l){t=uo(l,(n[2]||"null").toUpperCase(),{class:!0});var h=fo(t);s&&s.l(h),h.forEach(Se),this.h()},h(){Qo(n[2])(t,o)},m(l,h){ts(l,t,h),s&&s.m(t,null),e=!0},p(l,h){s&&s.p&&(!e||h[0]&2048)&&go(s,i,l,l[11],e?mo(i,l[11],h,null):po(l[11]),null),Qo(l[2])(t,o=bo(r,[h[0]&16&&l[4],(!e||h[0]&8)&&{class:l[3]}]))},i(l){e||(ri(s,l),e=!0)},o(l){ni(s,l),e=!1},d(l){l&&Se(t),s&&s.d(l)}}}function Nf(n){let t,e,i,s;const r=[Pf,Of,Lf],o=[];function l(h,a){return h[0]?0:h[2]==="button"?1:2}return t=l(n),e=o[t]=r[t](n),{c(){e.c(),i=Gs()},l(h){e.l(h),i=Gs()},m(h,a){o[t].m(h,a),ts(h,i,a),s=!0},p(h,a){let c=t;t=l(h),t===c?o[t].p(h,a):(Gu(),ni(o[c],1,1,()=>{o[c]=null}),qu(),e=o[t],e?e.p(h,a):(e=o[t]=r[t](h),e.c()),ri(e,1),e.m(i.parentNode,i))},i(h){s||(ri(e),s=!0)},o(h){ni(e),s=!1},d(h){h&&Se(i),o[t].d(h)}}}function zf(n,t,e){const i=["pill","outline","size","href","type","color","shadow","tag","checked"];let s=Yo(t,i),{$$slots:r={},$$scope:o}=t;const l=$u("group");let{pill:h=!1}=t,{outline:a=!1}=t,{size:c=l?"sm":"md"}=t,{href:u=void 0}=t,{type:f="button"}=t,{color:g=l?a?"dark":"alternative":"primary"}=t,{shadow:p=!1}=t,{tag:m="button"}=t,{checked:b=void 0}=t;const v={alternative:"text-gray-900 bg-white border border-gray-200 hover:bg-gray-100 dark:bg-gray-800 dark:text-gray-400 hover:text-primary-700 focus-within:text-primary-700 dark:focus-within:text-white dark:hover:text-white dark:hover:bg-gray-700",blue:"text-white bg-blue-700 hover:bg-blue-800 dark:bg-blue-600 dark:hover:bg-blue-700",dark:"text-white bg-gray-800 hover:bg-gray-900 dark:bg-gray-800 dark:hover:bg-gray-700",green:"text-white bg-green-700 hover:bg-green-800 dark:bg-green-600 dark:hover:bg-green-700",light:"text-gray-900 bg-white border border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600",primary:"text-white bg-primary-700 hover:bg-primary-800 dark:bg-primary-600 dark:hover:bg-primary-700",purple:"text-white bg-purple-700 hover:bg-purple-800 dark:bg-purple-600 dark:hover:bg-purple-700",red:"text-white bg-red-700 hover:bg-red-800 dark:bg-red-600 dark:hover:bg-red-700",yellow:"text-white bg-yellow-400 hover:bg-yellow-500 ",none:""},w={alternative:"text-primary-700 border dark:text-primary-500 bg-gray-100 dark:bg-gray-700 border-gray-300 shadow-gray-300 dark:shadow-gray-800 shadow-inner",blue:"text-blue-900 bg-blue-400 dark:bg-blue-500 shadow-blue-700 dark:shadow-blue-800 shadow-inner",dark:"text-white bg-gray-500 dark:bg-gray-600 shadow-gray-800 dark:shadow-gray-900 shadow-inner",green:"text-green-900 bg-green-400 dark:bg-green-500 shadow-green-700 dark:shadow-green-800 shadow-inner",light:"text-gray-900 bg-gray-100 border border-gray-300 dark:bg-gray-500 dark:text-gray-900 dark:border-gray-700 shadow-gray-300 dark:shadow-gray-700 shadow-inner",primary:"text-primary-900 bg-primary-400 dark:bg-primary-500 shadow-primary-700 dark:shadow-primary-800 shadow-inner",purple:"text-purple-900 bg-purple-400 dark:bg-purple-500 shadow-purple-700 dark:shadow-purple-800 shadow-inner",red:"text-red-900 bg-red-400 dark:bg-red-500 shadow-red-700 dark:shadow-red-800 shadow-inner",yellow:"text-yellow-900 bg-yellow-300 dark:bg-yellow-400 shadow-yellow-500 dark:shadow-yellow-700 shadow-inner",none:""},x={alternative:"focus-within:ring-gray-200 dark:focus-within:ring-gray-700",blue:"focus-within:ring-blue-300 dark:focus-within:ring-blue-800",dark:"focus-within:ring-gray-300 dark:focus-within:ring-gray-700",green:"focus-within:ring-green-300 dark:focus-within:ring-green-800",light:"focus-within:ring-gray-200 dark:focus-within:ring-gray-700",primary:"focus-within:ring-primary-300 dark:focus-within:ring-primary-800",purple:"focus-within:ring-purple-300 dark:focus-within:ring-purple-900",red:"focus-within:ring-red-300 dark:focus-within:ring-red-900",yellow:"focus-within:ring-yellow-300 dark:focus-within:ring-yellow-900",none:""},y={alternative:"shadow-gray-500/50 dark:shadow-gray-800/80",blue:"shadow-blue-500/50 dark:shadow-blue-800/80",dark:"shadow-gray-500/50 dark:shadow-gray-800/80",green:"shadow-green-500/50 dark:shadow-green-800/80",light:"shadow-gray-500/50 dark:shadow-gray-800/80",primary:"shadow-primary-500/50 dark:shadow-primary-800/80",purple:"shadow-purple-500/50 dark:shadow-purple-800/80",red:"shadow-red-500/50 dark:shadow-red-800/80 ",yellow:"shadow-yellow-500/50 dark:shadow-yellow-800/80 ",none:""},k={alternative:"text-gray-900 dark:text-gray-400 hover:text-white border border-gray-800 hover:bg-gray-900 focus-within:bg-gray-900 focus-within:text-white focus-within:ring-gray-300 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-600 dark:focus-within:ring-gray-800",blue:"text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-600",dark:"text-gray-900 hover:text-white border border-gray-800 hover:bg-gray-900 focus-within:bg-gray-900 focus-within:text-white dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-600",green:"text-green-700 hover:text-white border border-green-700 hover:bg-green-800 dark:border-green-500 dark:text-green-500 dark:hover:text-white dark:hover:bg-green-600",light:"text-gray-500 hover:text-gray-900 bg-white border border-gray-200 dark:border-gray-600 dark:hover:text-white dark:text-gray-400 hover:bg-gray-50 dark:bg-gray-700 dark:hover:bg-gray-600",primary:"text-primary-700 hover:text-white border border-primary-700 hover:bg-primary-700 dark:border-primary-500 dark:text-primary-500 dark:hover:text-white dark:hover:bg-primary-600",purple:"text-purple-700 hover:text-white border border-purple-700 hover:bg-purple-800 dark:border-purple-400 dark:text-purple-400 dark:hover:text-white dark:hover:bg-purple-500",red:"text-red-700 hover:text-white border border-red-700 hover:bg-red-800 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600",yellow:"text-yellow-400 hover:text-white border border-yellow-400 hover:bg-yellow-500 dark:border-yellow-300 dark:text-yellow-300 dark:hover:text-white dark:hover:bg-yellow-400",none:""},S={xs:"px-3 py-2 text-xs",sm:"px-4 py-2 text-sm",md:"px-5 py-2.5 text-sm",lg:"px-5 py-3 text-base",xl:"px-6 py-3.5 text-base"},C=()=>a||g==="alternative"||g==="light";let L;function N(P){ct.call(this,n,P)}function F(P){ct.call(this,n,P)}function z(P){ct.call(this,n,P)}function A(P){ct.call(this,n,P)}function V(P){ct.call(this,n,P)}function _(P){ct.call(this,n,P)}function W(P){ct.call(this,n,P)}function X(P){ct.call(this,n,P)}function nt(P){ct.call(this,n,P)}function st(P){ct.call(this,n,P)}function U(P){ct.call(this,n,P)}function rt(P){ct.call(this,n,P)}function J(P){ct.call(this,n,P)}function Ct(P){ct.call(this,n,P)}function Ot(P){ct.call(this,n,P)}function ee(P){ct.call(this,n,P)}function ue(P){ct.call(this,n,P)}function $e(P){ct.call(this,n,P)}return n.$$set=P=>{e(39,t=Ii(Ii({},t),Zo(P))),e(4,s=Yo(t,i)),"pill"in P&&e(5,h=P.pill),"outline"in P&&e(6,a=P.outline),"size"in P&&e(7,c=P.size),"href"in P&&e(0,u=P.href),"type"in P&&e(1,f=P.type),"color"in P&&e(8,g=P.color),"shadow"in P&&e(9,p=P.shadow),"tag"in P&&e(2,m=P.tag),"checked"in P&&e(10,b=P.checked),"$$scope"in P&&e(11,o=P.$$scope)},n.$$.update=()=>{e(3,L=Df("text-center font-medium",l?"focus-within:ring-2":"focus-within:ring-4",l&&"focus-within:z-10",l||"focus-within:outline-none","inline-flex items-center justify-center "+S[c],a&&b&&"border dark:border-gray-900",a&&b&&w[g],a&&!b&&k[g],!a&&b&&w[g],!a&&!b&&v[g],g==="alternative"&&(l&&!b?"dark:bg-gray-700 dark:text-white dark:border-gray-700 dark:hover:border-gray-600 dark:hover:bg-gray-600":"dark:bg-transparent dark:border-gray-600 dark:hover:border-gray-600"),a&&g==="dark"&&(l?b?"bg-gray-900 border-gray-800 dark:border-white dark:bg-gray-600":"dark:text-white border-gray-800 dark:border-white":"dark:text-gray-400 dark:border-gray-700"),x[g],C()&&l&&"border-s-0 first:border-s",l?h&&"first:rounded-s-full last:rounded-e-full"||"first:rounded-s-lg last:rounded-e-lg":h&&"rounded-full"||"rounded-lg",p&&"shadow-lg",p&&y[g],t.disabled&&"cursor-not-allowed opacity-50",t.class))},t=Zo(t),[u,f,m,L,s,h,a,c,g,p,b,o,r,N,F,z,A,V,_,W,X,nt,st,U,rt,J,Ct,Ot,ee,ue,$e]}class vv extends Uu{constructor(t){super(),Xu(this,t,zf,Nf,ba,{pill:5,outline:6,size:7,href:0,type:1,color:8,shadow:9,tag:2,checked:10},null,[-1,-1])}}class ${lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){[t,e]=oi(this,t,e);let s=[];return this.decompose(0,t,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(e,this.length,s,1),qt.from(s,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=oi(this,t,e);let i=[];return this.decompose(t,e,i,0),qt.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),s=new Li(this),r=new Li(t);for(let o=e,l=e;;){if(s.next(o),r.next(o),o=0,s.lineBreak!=r.lineBreak||s.done!=r.done||s.value!=r.value)return!1;if(l+=s.value.length,s.done||l>=i)return!0}}iter(t=1){return new Li(this,t)}iterRange(t,e=this.length){return new Ma(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let s=this.line(t).from;i=this.iterRange(s,Math.max(s,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new Aa(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?$.empty:t.length<=32?new ot(t):qt.from(ot.split(t,[]))}}class ot extends ${constructor(t,e=Bf(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,s){for(let r=0;;r++){let o=this.text[r],l=s+o.length;if((e?i:l)>=t)return new _f(s,l,i,o);s=l+1,i++}}decompose(t,e,i,s){let r=t<=0&&e>=this.length?this:new ot(il(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(s&1){let o=i.pop(),l=Fs(r.text,o.text.slice(),0,r.length);if(l.length<=32)i.push(new ot(l,o.length+r.length));else{let h=l.length>>1;i.push(new ot(l.slice(0,h)),new ot(l.slice(h)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof ot))return super.replace(t,e,i);[t,e]=oi(this,t,e);let s=Fs(this.text,Fs(i.text,il(this.text,0,t)),e),r=this.length+i.length-(e-t);return s.length<=32?new ot(s,r):qt.from(ot.split(s,[]),r)}sliceString(t,e=this.length,i=`
`){[t,e]=oi(this,t,e);let s="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let l=this.text[o],h=r+l.length;r>t&&o&&(s+=i),t<h&&e>r&&(s+=l.slice(Math.max(0,t-r),e-r)),r=h+1}return s}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],s=-1;for(let r of t)i.push(r),s+=r.length+1,i.length==32&&(e.push(new ot(i,s)),i=[],s=-1);return s>-1&&e.push(new ot(i,s)),e}}class qt extends ${constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,s){for(let r=0;;r++){let o=this.children[r],l=s+o.length,h=i+o.lines-1;if((e?h:l)>=t)return o.lineInner(t,e,i,s);s=l+1,i=h+1}}decompose(t,e,i,s){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let l=this.children[r],h=o+l.length;if(t<=h&&e>=o){let a=s&((o<=t?1:0)|(h>=e?2:0));o>=t&&h<=e&&!a?i.push(l):l.decompose(t-o,e-o,i,a)}o=h+1}}replace(t,e,i){if([t,e]=oi(this,t,e),i.lines<this.lines)for(let s=0,r=0;s<this.children.length;s++){let o=this.children[s],l=r+o.length;if(t>=r&&e<=l){let h=o.replace(t-r,e-r,i),a=this.lines-o.lines+h.lines;if(h.lines<a>>4&&h.lines>a>>6){let c=this.children.slice();return c[s]=h,new qt(c,this.length-(e-t)+i.length)}return super.replace(r,l,h)}r=l+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`
`){[t,e]=oi(this,t,e);let s="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let l=this.children[r],h=o+l.length;o>t&&r&&(s+=i),t<h&&e>o&&(s+=l.sliceString(t-o,e-o,i)),o=h+1}return s}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof qt))return 0;let i=0,[s,r,o,l]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;s+=e,r+=e){if(s==o||r==l)return i;let h=this.children[s],a=t.children[r];if(h!=a)return i+h.scanIdentical(a,e);i+=h.length+1}}static from(t,e=t.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let g of t)i+=g.lines;if(i<32){let g=[];for(let p of t)p.flatten(g);return new ot(g,e)}let s=Math.max(32,i>>5),r=s<<1,o=s>>1,l=[],h=0,a=-1,c=[];function u(g){let p;if(g.lines>r&&g instanceof qt)for(let m of g.children)u(m);else g.lines>o&&(h>o||!h)?(f(),l.push(g)):g instanceof ot&&h&&(p=c[c.length-1])instanceof ot&&g.lines+p.lines<=32?(h+=g.lines,a+=g.length+1,c[c.length-1]=new ot(p.text.concat(g.text),p.length+1+g.length)):(h+g.lines>s&&f(),h+=g.lines,a+=g.length+1,c.push(g))}function f(){h!=0&&(l.push(c.length==1?c[0]:qt.from(c,a)),a=-1,h=c.length=0)}for(let g of t)u(g);return f(),l.length==1?l[0]:new qt(l,e)}}$.empty=new ot([""],0);function Bf(n){let t=-1;for(let e of n)t+=e.length+1;return t}function Fs(n,t,e=0,i=1e9){for(let s=0,r=0,o=!0;r<n.length&&s<=i;r++){let l=n[r],h=s+l.length;h>=e&&(h>i&&(l=l.slice(0,i-s)),s<e&&(l=l.slice(e-s)),o?(t[t.length-1]+=l,o=!1):t.push(l)),s=h+1}return t}function il(n,t,e){return Fs(n,[""],t,e)}class Li{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof ot?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],r=this.offsets[i],o=r>>1,l=s instanceof ot?s.text.length:s.children.length;if(o==(e>0?l:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(s instanceof ot){let h=s.text[o+(e<0?-1:0)];if(this.offsets[i]+=e,h.length>Math.max(0,t))return this.value=t==0?h:e>0?h.slice(t):h.slice(0,h.length-t),this;t-=h.length}else{let h=s.children[o+(e<0?-1:0)];t>h.length?(t-=h.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(h),this.offsets.push(e>0?1:(h instanceof ot?h.text.length:h.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class Ma{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Li(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:s}=this.cursor.next(t);return this.pos+=(s.length+t)*e,this.value=s.length<=i?s:e<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Aa{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:s}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&($.prototype[Symbol.iterator]=function(){return this.iter()},Li.prototype[Symbol.iterator]=Ma.prototype[Symbol.iterator]=Aa.prototype[Symbol.iterator]=function(){return this});class _f{constructor(t,e,i,s){this.from=t,this.to=e,this.number=i,this.text=s}get length(){return this.to-this.from}}function oi(n,t,e){return t=Math.max(0,Math.min(n.length,t)),[t,Math.max(t,Math.min(n.length,e))]}let Qe="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<Qe.length;n++)Qe[n]+=Qe[n-1];function Rf(n){for(let t=1;t<Qe.length;t+=2)if(Qe[t]>n)return Qe[t-1]<=n;return!1}function sl(n){return n>=127462&&n<=127487}const nl=8205;function Yt(n,t,e=!0,i=!0){return(e?Ea:Ff)(n,t,i)}function Ea(n,t,e){if(t==n.length)return t;t&&Ta(n.charCodeAt(t))&&Da(n.charCodeAt(t-1))&&t--;let i=Oi(n,t);for(t+=fr(i);t<n.length;){let s=Oi(n,t);if(i==nl||s==nl||e&&Rf(s))t+=fr(s),i=s;else if(sl(s)){let r=0,o=t-2;for(;o>=0&&sl(Oi(n,o));)r++,o-=2;if(r%2==0)break;t+=2}else break}return t}function Ff(n,t,e){for(;t>0;){let i=Ea(n,t-2,e);if(i<t)return i;t--}return 0}function Ta(n){return n>=56320&&n<57344}function Da(n){return n>=55296&&n<56320}function Oi(n,t){let e=n.charCodeAt(t);if(!Da(e)||t+1==n.length)return e;let i=n.charCodeAt(t+1);return Ta(i)?(e-55296<<10)+(i-56320)+65536:e}function wv(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function fr(n){return n<65536?1:2}const dr=/\r\n?|\n/;var At=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(At||(At={}));class oe{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,s=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(i,s,r),s+=r):s+=o,i+=r}}iterChangedRanges(t,e=!1){gr(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],s=this.sections[e++];s<0?t.push(i,s):t.push(s,i)}return new oe(t)}composeDesc(t){return this.empty?t:t.empty?this:La(this,t)}mapDesc(t,e=!1){return t.empty?this:pr(this,t,e)}mapPos(t,e=-1,i=At.Simple){let s=0,r=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],h=this.sections[o++],a=s+l;if(h<0){if(a>t)return r+(t-s);r+=l}else{if(i!=At.Simple&&a>=t&&(i==At.TrackDel&&s<t&&a>t||i==At.TrackBefore&&s<t||i==At.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!l)return t==s||e<0?r:r+h;r+=h}s=a}if(t>s)throw new RangeError(`Position ${t} is out of range for changeset of length ${s}`);return r}touchesRange(t,e=t){for(let i=0,s=0;i<this.sections.length&&s<=e;){let r=this.sections[i++],o=this.sections[i++],l=s+r;if(o>=0&&s<=e&&l>=t)return s<t&&l>e?"cover":!0;s=l}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],s=this.sections[e++];t+=(t?" ":"")+i+(s>=0?":"+s:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new oe(t)}static create(t){return new oe(t)}}class ft extends oe{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return gr(this,(e,i,s,r,o)=>t=t.replace(s,s+(i-e),o),!1),t}mapDesc(t,e=!1){return pr(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let s=0,r=0;s<e.length;s+=2){let o=e[s],l=e[s+1];if(l>=0){e[s]=l,e[s+1]=o;let h=s>>1;for(;i.length<h;)i.push($.empty);i.push(o?t.slice(r,r+o):$.empty)}r+=o}return new ft(e,i)}compose(t){return this.empty?t:t.empty?this:La(this,t,!0)}map(t,e=!1){return t.empty?this:pr(this,t,e,!0)}iterChanges(t,e=!1){gr(this,t,e)}get desc(){return oe.create(this.sections)}filter(t){let e=[],i=[],s=[],r=new Wi(this);t:for(let o=0,l=0;;){let h=o==t.length?1e9:t[o++];for(;l<h||l==h&&r.len==0;){if(r.done)break t;let c=Math.min(r.len,h-l);vt(s,c,-1);let u=r.ins==-1?-1:r.off==0?r.ins:0;vt(e,c,u),u>0&&we(i,e,r.text),r.forward(c),l+=c}let a=t[o++];for(;l<a;){if(r.done)break t;let c=Math.min(r.len,a-l);vt(e,c,-1),vt(s,c,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(c),l+=c}}return{changes:new ft(e,i),filtered:oe.create(s)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],s=this.sections[e+1];s<0?t.push(i):s==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let s=[],r=[],o=0,l=null;function h(c=!1){if(!c&&!s.length)return;o<e&&vt(s,e-o,-1);let u=new ft(s,r);l=l?l.compose(u.map(l)):u,s=[],r=[],o=0}function a(c){if(Array.isArray(c))for(let u of c)a(u);else if(c instanceof ft){if(c.length!=e)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${e})`);h(),l=l?l.compose(c.map(l)):c}else{let{from:u,to:f=u,insert:g}=c;if(u>f||u<0||f>e)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${e})`);let p=g?typeof g=="string"?$.of(g.split(i||dr)):g:$.empty,m=p.length;if(u==f&&m==0)return;u<o&&h(),u>o&&vt(s,u-o,-1),vt(s,f-u,m),we(r,s,p),o=f}}return a(t),h(!l),l}static empty(t){return new ft(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let s=0;s<t.length;s++){let r=t[s];if(typeof r=="number")e.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)e.push(r[0],0);else{for(;i.length<s;)i.push($.empty);i[s]=$.of(r.slice(1)),e.push(r[0],i[s].length)}}}return new ft(e,i)}static createSet(t,e){return new ft(t,e)}}function vt(n,t,e,i=!1){if(t==0&&e<=0)return;let s=n.length-2;s>=0&&e<=0&&e==n[s+1]?n[s]+=t:t==0&&n[s]==0?n[s+1]+=e:i?(n[s]+=t,n[s+1]+=e):n.push(t,e)}function we(n,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(e);else{for(;n.length<i;)n.push($.empty);n.push(e)}}function gr(n,t,e){let i=n.inserted;for(let s=0,r=0,o=0;o<n.sections.length;){let l=n.sections[o++],h=n.sections[o++];if(h<0)s+=l,r+=l;else{let a=s,c=r,u=$.empty;for(;a+=l,c+=h,h&&i&&(u=u.append(i[o-2>>1])),!(e||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],h=n.sections[o++];t(s,a,r,c,u),s=a,r=c}}}function pr(n,t,e,i=!1){let s=[],r=i?[]:null,o=new Wi(n),l=new Wi(t);for(let h=-1;;)if(o.ins==-1&&l.ins==-1){let a=Math.min(o.len,l.len);vt(s,a,-1),o.forward(a),l.forward(a)}else if(l.ins>=0&&(o.ins<0||h==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!e))){let a=l.len;for(vt(s,l.ins,-1);a;){let c=Math.min(o.len,a);o.ins>=0&&h<o.i&&o.len<=c&&(vt(s,0,o.ins),r&&we(r,s,o.text),h=o.i),o.forward(c),a-=c}l.next()}else if(o.ins>=0){let a=0,c=o.len;for(;c;)if(l.ins==-1){let u=Math.min(c,l.len);a+=u,c-=u,l.forward(u)}else if(l.ins==0&&l.len<c)c-=l.len,l.next();else break;vt(s,a,h<o.i?o.ins:0),r&&h<o.i&&we(r,s,o.text),h=o.i,o.forward(o.len-c)}else{if(o.done&&l.done)return r?ft.createSet(s,r):oe.create(s);throw new Error("Mismatched change set lengths")}}function La(n,t,e=!1){let i=[],s=e?[]:null,r=new Wi(n),o=new Wi(t);for(let l=!1;;){if(r.done&&o.done)return s?ft.createSet(i,s):oe.create(i);if(r.ins==0)vt(i,r.len,0,l),r.next();else if(o.len==0&&!o.done)vt(i,0,o.ins,l),s&&we(s,i,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let h=Math.min(r.len2,o.len),a=i.length;if(r.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;vt(i,h,c,l),s&&c&&we(s,i,o.text)}else o.ins==-1?(vt(i,r.off?0:r.len,h,l),s&&we(s,i,r.textBit(h))):(vt(i,r.off?0:r.len,o.off?0:o.ins,l),s&&!o.off&&we(s,i,o.text));l=(r.ins>h||o.ins>=0&&o.len>h)&&(l||i.length>a),r.forward2(h),o.forward(h)}}}}class Wi{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?$.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?$.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class ze{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let i,s;return this.empty?i=s=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),s=t.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new ze(i,s,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return D.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return D.range(this.anchor,i)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return D.range(t.anchor,t.head)}static create(t,e,i){return new ze(t,e,i)}}class D{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:D.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(t.ranges[i],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new D([this.main],0)}addRange(t,e=!0){return D.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,D.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new D(t.ranges.map(e=>ze.fromJSON(e)),t.main)}static single(t,e=t){return new D([D.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<t.length;s++){let r=t[s];if(r.empty?r.from<=i:r.from<i)return D.normalized(t.slice(),e);i=r.to}return new D(t,e)}static cursor(t,e=0,i,s){return ze.create(t,t,(e==0?0:e<0?8:16)|(i==null?7:Math.min(6,i))|(s??16777215)<<6)}static range(t,e,i,s){let r=(i??16777215)<<6|(s==null?7:Math.min(6,s));return e<t?ze.create(e,t,48|r):ze.create(t,e,(e>t?8:0)|r)}static normalized(t,e=0){let i=t[e];t.sort((s,r)=>s.from-r.from),e=t.indexOf(i);for(let s=1;s<t.length;s++){let r=t[s],o=t[s-1];if(r.empty?r.from<=o.to:r.from<o.to){let l=o.from,h=Math.max(r.to,o.to);s<=e&&e--,t.splice(--s,2,r.anchor>r.head?D.range(h,l):D.range(l,h))}}return new D(t,e)}}function Oa(n,t){for(let e of n.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let wo=0;class O{constructor(t,e,i,s,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=s,this.id=wo++,this.default=t([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(t={}){return new O(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:yo),!!t.static,t.enables)}of(t){return new Vs([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Vs(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Vs(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}}function yo(n,t){return n==t||n.length==t.length&&n.every((e,i)=>e===t[i])}class Vs{constructor(t,e,i,s){this.dependencies=t,this.facet=e,this.type=i,this.value=s,this.id=wo++}dynamicSlot(t){var e;let i=this.value,s=this.facet.compareInput,r=this.id,o=t[r]>>1,l=this.type==2,h=!1,a=!1,c=[];for(let u of this.dependencies)u=="doc"?h=!0:u=="selection"?a=!0:((e=t[u.id])!==null&&e!==void 0?e:1)&1||c.push(t[u.id]);return{create(u){return u.values[o]=i(u),1},update(u,f){if(h&&f.docChanged||a&&(f.docChanged||f.selection)||mr(u,c)){let g=i(u);if(l?!rl(g,u.values[o],s):!s(g,u.values[o]))return u.values[o]=g,1}return 0},reconfigure:(u,f)=>{let g,p=f.config.address[r];if(p!=null){let m=Ys(f,p);if(this.dependencies.every(b=>b instanceof O?f.facet(b)===u.facet(b):b instanceof Ht?f.field(b,!1)==u.field(b,!1):!0)||(l?rl(g=i(u),m,s):s(g=i(u),m)))return u.values[o]=m,0}else g=i(u);return u.values[o]=g,1}}}}function rl(n,t,e){if(n.length!=t.length)return!1;for(let i=0;i<n.length;i++)if(!e(n[i],t[i]))return!1;return!0}function mr(n,t){let e=!1;for(let i of t)Pi(n,i)&1&&(e=!0);return e}function Vf(n,t,e){let i=e.map(h=>n[h.id]),s=e.map(h=>h.type),r=i.filter(h=>!(h&1)),o=n[t.id]>>1;function l(h){let a=[];for(let c=0;c<i.length;c++){let u=Ys(h,i[c]);if(s[c]==2)for(let f of u)a.push(f);else a.push(u)}return t.combine(a)}return{create(h){for(let a of i)Pi(h,a);return h.values[o]=l(h),1},update(h,a){if(!mr(h,r))return 0;let c=l(h);return t.compare(c,h.values[o])?0:(h.values[o]=c,1)},reconfigure(h,a){let c=mr(h,i),u=a.config.facets[t.id],f=a.facet(t);if(u&&!c&&yo(e,u))return h.values[o]=f,0;let g=l(h);return t.compare(g,f)?(h.values[o]=f,0):(h.values[o]=g,1)}}}const ol=O.define({static:!0});class Ht{constructor(t,e,i,s,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=s,this.spec=r,this.provides=void 0}static define(t){let e=new Ht(wo++,t.create,t.update,t.compare||((i,s)=>i===s),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(ol).find(i=>i.field==this);return(e?.create||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,s)=>{let r=i.values[e],o=this.updateF(r,s);return this.compareF(r,o)?0:(i.values[e]=o,1)},reconfigure:(i,s)=>s.config.address[this.id]!=null?(i.values[e]=s.field(this),0):(i.values[e]=this.create(i),1)}}init(t){return[this,ol.of({field:this,create:t})]}get extension(){return this}}const Ne={lowest:4,low:3,default:2,high:1,highest:0};function wi(n){return t=>new Pa(t,n)}const gn={highest:wi(Ne.highest),high:wi(Ne.high),default:wi(Ne.default),low:wi(Ne.low),lowest:wi(Ne.lowest)};class Pa{constructor(t,e){this.inner=t,this.prec=e}}class pn{of(t){return new br(this,t)}reconfigure(t){return pn.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class br{constructor(t,e){this.compartment=t,this.inner=e}}class Js{constructor(t,e,i,s,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=s,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let s=[],r=Object.create(null),o=new Map;for(let f of If(t,e,o))f instanceof Ht?s.push(f):(r[f.facet.id]||(r[f.facet.id]=[])).push(f);let l=Object.create(null),h=[],a=[];for(let f of s)l[f.id]=a.length<<1,a.push(g=>f.slot(g));let c=i?.config.facets;for(let f in r){let g=r[f],p=g[0].facet,m=c&&c[f]||[];if(g.every(b=>b.type==0))if(l[p.id]=h.length<<1|1,yo(m,g))h.push(i.facet(p));else{let b=p.combine(g.map(v=>v.value));h.push(i&&p.compare(b,i.facet(p))?i.facet(p):b)}else{for(let b of g)b.type==0?(l[b.id]=h.length<<1|1,h.push(b.value)):(l[b.id]=a.length<<1,a.push(v=>b.dynamicSlot(v)));l[p.id]=a.length<<1,a.push(b=>Vf(b,p,g))}}let u=a.map(f=>f(l));return new Js(t,o,u,l,h,r)}}function If(n,t,e){let i=[[],[],[],[],[]],s=new Map;function r(o,l){let h=s.get(o);if(h!=null){if(h<=l)return;let a=i[h].indexOf(o);a>-1&&i[h].splice(a,1),o instanceof br&&e.delete(o.compartment)}if(s.set(o,l),Array.isArray(o))for(let a of o)r(a,l);else if(o instanceof br){if(e.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let a=t.get(o.compartment)||o.inner;e.set(o.compartment,a),r(a,l)}else if(o instanceof Pa)r(o.inner,o.prec);else if(o instanceof Ht)i[l].push(o),o.provides&&r(o.provides,l);else if(o instanceof Vs)i[l].push(o),o.facet.extensions&&r(o.facet.extensions,Ne.default);else{let a=o.extension;if(!a)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(a,l)}}return r(n,Ne.default),i.reduce((o,l)=>o.concat(l))}function Pi(n,t){if(t&1)return 2;let e=t>>1,i=n.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[e]=4;let s=n.computeSlot(n,n.config.dynamicSlots[e]);return n.status[e]=2|s}function Ys(n,t){return t&1?n.config.staticValues[t>>1]:n.values[t>>1]}const Na=O.define(),vr=O.define({combine:n=>n.some(t=>t),static:!0}),za=O.define({combine:n=>n.length?n[0]:void 0,static:!0}),Ba=O.define(),_a=O.define(),Ra=O.define(),Fa=O.define({combine:n=>n.length?n[0]:!1});class mi{constructor(t,e){this.type=t,this.value=e}static define(){return new Wf}}class Wf{of(t){return new mi(this,t)}}class Hf{constructor(t){this.map=t}of(t){return new tt(this,t)}}class tt{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new tt(this.type,e)}is(t){return this.type==t}static define(t={}){return new Hf(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let s of t){let r=s.map(e);r&&i.push(r)}return i}}tt.reconfigure=tt.define();tt.appendConfig=tt.define();class yt{constructor(t,e,i,s,r,o){this.startState=t,this.changes=e,this.selection=i,this.effects=s,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Oa(i,e.newLength),r.some(l=>l.type==yt.time)||(this.annotations=r.concat(yt.time.of(Date.now())))}static create(t,e,i,s,r,o){return new yt(t,e,i,s,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(yt.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}yt.time=mi.define();yt.userEvent=mi.define();yt.addToHistory=mi.define();yt.remote=mi.define();function jf(n,t){let e=[];for(let i=0,s=0;;){let r,o;if(i<n.length&&(s==t.length||t[s]>=n[i]))r=n[i++],o=n[i++];else if(s<t.length)r=t[s++],o=t[s++];else return e;!e.length||e[e.length-1]<r?e.push(r,o):e[e.length-1]<o&&(e[e.length-1]=o)}}function Va(n,t,e){var i;let s,r,o;return e?(s=t.changes,r=ft.empty(t.changes.length),o=n.changes.compose(t.changes)):(s=t.changes.map(n.changes),r=n.changes.mapDesc(t.changes,!0),o=n.changes.compose(s)),{changes:o,selection:t.selection?t.selection.map(r):(i=n.selection)===null||i===void 0?void 0:i.map(s),effects:tt.mapEffects(n.effects,s).concat(tt.mapEffects(t.effects,r)),annotations:n.annotations.length?n.annotations.concat(t.annotations):t.annotations,scrollIntoView:n.scrollIntoView||t.scrollIntoView}}function wr(n,t,e){let i=t.selection,s=ti(t.annotations);return t.userEvent&&(s=s.concat(yt.userEvent.of(t.userEvent))),{changes:t.changes instanceof ft?t.changes:ft.of(t.changes||[],e,n.facet(za)),selection:i&&(i instanceof D?i:D.single(i.anchor,i.head)),effects:ti(t.effects),annotations:s,scrollIntoView:!!t.scrollIntoView}}function Ia(n,t,e){let i=wr(n,t.length?t[0]:{},n.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let r=1;r<t.length;r++){t[r].filter===!1&&(e=!1);let o=!!t[r].sequential;i=Va(i,wr(n,t[r],o?i.changes.newLength:n.doc.length),o)}let s=yt.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return $f(e?Kf(s):s)}function Kf(n){let t=n.startState,e=!0;for(let s of t.facet(Ba)){let r=s(n);if(r===!1){e=!1;break}Array.isArray(r)&&(e=e===!0?r:jf(e,r))}if(e!==!0){let s,r;if(e===!1)r=n.changes.invertedDesc,s=ft.empty(t.doc.length);else{let o=n.changes.filter(e);s=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}n=yt.create(t,s,n.selection&&n.selection.map(r),tt.mapEffects(n.effects,r),n.annotations,n.scrollIntoView)}let i=t.facet(_a);for(let s=i.length-1;s>=0;s--){let r=i[s](n);r instanceof yt?n=r:Array.isArray(r)&&r.length==1&&r[0]instanceof yt?n=r[0]:n=Ia(t,ti(r),!1)}return n}function $f(n){let t=n.startState,e=t.facet(Ra),i=n;for(let s=e.length-1;s>=0;s--){let r=e[s](n);r&&Object.keys(r).length&&(i=Va(i,wr(t,r,n.changes.newLength),!0))}return i==n?n:yt.create(t,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const Uf=[];function ti(n){return n==null?Uf:Array.isArray(n)?n:[n]}var se=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(se||(se={}));const Xf=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let yr;try{yr=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Gf(n){if(yr)return yr.test(n);for(let t=0;t<n.length;t++){let e=n[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Xf.test(e)))return!0}return!1}function qf(n){return t=>{if(!/\S/.test(t))return se.Space;if(Gf(t))return se.Word;for(let e=0;e<n.length;e++)if(t.indexOf(n[e])>-1)return se.Word;return se.Other}}class K{constructor(t,e,i,s,r,o){this.config=t,this.doc=e,this.selection=i,this.values=s,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)Pi(this,l<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return Pi(this,i),Ys(this,i)}update(...t){return Ia(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:s}=e;for(let l of t.effects)l.is(pn.reconfigure)?(e&&(s=new Map,e.compartments.forEach((h,a)=>s.set(a,h)),e=null),s.set(l.value.compartment,l.value.extension)):l.is(tt.reconfigure)?(e=null,i=l.value):l.is(tt.appendConfig)&&(e=null,i=ti(i).concat(l.value));let r;e?r=t.startState.values.slice():(e=Js.resolve(i,s,this),r=new K(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(h,a)=>a.reconfigure(h,this),null).values);let o=t.startState.facet(vr)?t.newSelection:t.newSelection.asSingle();new K(e,t.newDoc,o,r,(l,h)=>h.update(l,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:D.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),s=this.changes(i.changes),r=[i.range],o=ti(i.effects);for(let l=1;l<e.ranges.length;l++){let h=t(e.ranges[l]),a=this.changes(h.changes),c=a.map(s);for(let f=0;f<l;f++)r[f]=r[f].map(c);let u=s.mapDesc(a,!0);r.push(h.range.map(u)),s=s.compose(c),o=tt.mapEffects(o,c).concat(tt.mapEffects(ti(h.effects),u))}return{changes:s,selection:D.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof ft?t:ft.of(t,this.doc.length,this.facet(K.lineSeparator))}toText(t){return $.of(t.split(this.facet(K.lineSeparator)||dr))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(Pi(this,e),Ys(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let s=t[i];s instanceof Ht&&this.config.address[s.id]!=null&&(e[i]=s.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i){for(let r in i)if(Object.prototype.hasOwnProperty.call(t,r)){let o=i[r],l=t[r];s.push(o.init(h=>o.spec.fromJSON(l,h)))}}return K.create({doc:t.doc,selection:D.fromJSON(t.selection),extensions:e.extensions?s.concat([e.extensions]):s})}static create(t={}){let e=Js.resolve(t.extensions||[],new Map),i=t.doc instanceof $?t.doc:$.of((t.doc||"").split(e.staticFacet(K.lineSeparator)||dr)),s=t.selection?t.selection instanceof D?t.selection:D.single(t.selection.anchor,t.selection.head):D.single(0);return Oa(s,i.length),e.staticFacet(vr)||(s=s.asSingle()),new K(e,i,s,e.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(K.tabSize)}get lineBreak(){return this.facet(K.lineSeparator)||`
`}get readOnly(){return this.facet(Fa)}phrase(t,...e){for(let i of this.facet(K.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let r=+(s||1);return!r||r>e.length?i:e[r-1]})),t}languageDataAt(t,e,i=-1){let s=[];for(let r of this.facet(Na))for(let o of r(this,e,i))Object.prototype.hasOwnProperty.call(o,t)&&s.push(o[t]);return s}charCategorizer(t){return qf(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:s}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-i,l=t-i;for(;o>0;){let h=Yt(e,o,!1);if(r(e.slice(h,o))!=se.Word)break;o=h}for(;l<s;){let h=Yt(e,l);if(r(e.slice(l,h))!=se.Word)break;l=h}return o==l?null:D.range(o+i,l+i)}}K.allowMultipleSelections=vr;K.tabSize=O.define({combine:n=>n.length?n[0]:4});K.lineSeparator=za;K.readOnly=Fa;K.phrases=O.define({compare(n,t){let e=Object.keys(n),i=Object.keys(t);return e.length==i.length&&e.every(s=>n[s]==t[s])}});K.languageData=Na;K.changeFilter=Ba;K.transactionFilter=_a;K.transactionExtender=Ra;pn.reconfigure=tt.define();function es(n,t,e={}){let i={};for(let s of n)for(let r of Object.keys(s)){let o=s[r],l=i[r];if(l===void 0)i[r]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(e,r))i[r]=e[r](l,o);else throw new Error("Config merge conflict for field "+r)}for(let s in t)i[s]===void 0&&(i[s]=t[s]);return i}class li{eq(t){return this==t}range(t,e=t){return xr.create(t,e,this)}}li.prototype.startSide=li.prototype.endSide=0;li.prototype.point=!1;li.prototype.mapMode=At.TrackDel;let xr=class Wa{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new Wa(t,e,i)}};function kr(n,t){return n.from-t.from||n.value.startSide-t.value.startSide}class xo{constructor(t,e,i,s){this.from=t,this.to=e,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,s=0){let r=i?this.to:this.from;for(let o=s,l=r.length;;){if(o==l)return o;let h=o+l>>1,a=r[h]-t||(i?this.value[h].endSide:this.value[h].startSide)-e;if(h==o)return a>=0?o:l;a>=0?l=h:o=h+1}}between(t,e,i,s){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(i,1e9,!1,r);r<o;r++)if(s(this.from[r]+t,this.to[r]+t,this.value[r])===!1)return!1}map(t,e){let i=[],s=[],r=[],o=-1,l=-1;for(let h=0;h<this.value.length;h++){let a=this.value[h],c=this.from[h]+t,u=this.to[h]+t,f,g;if(c==u){let p=e.mapPos(c,a.startSide,a.mapMode);if(p==null||(f=g=p,a.startSide!=a.endSide&&(g=e.mapPos(c,a.endSide),g<f)))continue}else if(f=e.mapPos(c,a.startSide),g=e.mapPos(u,a.endSide),f>g||f==g&&a.startSide>0&&a.endSide<=0)continue;(g-f||a.endSide-a.startSide)<0||(o<0&&(o=f),a.point&&(l=Math.max(l,g-f)),i.push(a),s.push(f-o),r.push(g-o))}return{mapped:i.length?new xo(s,r,i,l):null,pos:o}}}class j{constructor(t,e,i,s){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=s}static create(t,e,i,s){return new j(t,e,i,s)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:s=0,filterTo:r=this.length}=t,o=t.filter;if(e.length==0&&!o)return this;if(i&&(e=e.slice().sort(kr)),this.isEmpty)return e.length?j.of(e):this;let l=new Ha(this,null,-1).goto(0),h=0,a=[],c=new _e;for(;l.value||h<e.length;)if(h<e.length&&(l.from-e[h].from||l.startSide-e[h].value.startSide)>=0){let u=e[h++];c.addInner(u.from,u.to,u.value)||a.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(h==e.length||this.chunkEnd(l.chunkIndex)<e[h].from)&&(!o||s>this.chunkEnd(l.chunkIndex)||r<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||s>l.to||r<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||a.push(xr.create(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!a.length?j.empty:this.nextLayer.update({add:a,filter:o,filterFrom:s,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],s=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],h=this.chunk[o],a=t.touchesRange(l,l+h.length);if(a===!1)s=Math.max(s,h.maxPoint),e.push(h),i.push(t.mapPos(l));else if(a===!0){let{mapped:c,pos:u}=h.map(l,t);c&&(s=Math.max(s,c.maxPoint),e.push(c),i.push(u))}}let r=this.nextLayer.map(t);return e.length==0?r:new j(i,e,r||j.empty,s)}between(t,e,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s];if(e>=r&&t<=r+o.length&&o.between(r,t-r,e-r,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return Hi.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Hi.from(t).goto(e)}static compare(t,e,i,s,r=-1){let o=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),l=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),h=ll(o,l,i),a=new yi(o,h,r),c=new yi(l,h,r);i.iterGaps((u,f,g)=>hl(a,u,c,f,g,s)),i.empty&&i.length==0&&hl(a,0,c,0,0,s)}static eq(t,e,i=0,s){s==null&&(s=999999999);let r=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0),o=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let l=ll(r,o),h=new yi(r,l,0).goto(i),a=new yi(o,l,0).goto(i);for(;;){if(h.to!=a.to||!Sr(h.active,a.active)||h.point&&(!a.point||!h.point.eq(a.point)))return!1;if(h.to>s)return!0;h.next(),a.next()}}static spans(t,e,i,s,r=-1){let o=new yi(t,null,r).goto(e),l=e,h=o.openStart;for(;;){let a=Math.min(o.to,i);if(o.point){let c=o.activeForPoint(o.to),u=o.pointFrom<e?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,h);s.point(l,a,o.point,c,u,o.pointRank),h=Math.min(o.openEnd(a),c.length)}else a>l&&(s.span(l,a,o.active,h),h=o.openEnd(a));if(o.to>i)return h+(o.point&&o.to>i?1:0);l=o.to,o.next()}}static of(t,e=!1){let i=new _e;for(let s of t instanceof xr?[t]:e?Jf(t):t)i.add(s.from,s.to,s.value);return i.finish()}static join(t){if(!t.length)return j.empty;let e=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let s=t[i];s!=j.empty;s=s.nextLayer)e=new j(s.chunkPos,s.chunk,e,Math.max(s.maxPoint,e.maxPoint));return e}}j.empty=new j([],[],null,-1);function Jf(n){if(n.length>1)for(let t=n[0],e=1;e<n.length;e++){let i=n[e];if(kr(t,i)>0)return n.slice().sort(kr);t=i}return n}j.empty.nextLayer=j.empty;class _e{finishChunk(t){this.chunks.push(new xo(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new _e)).add(t,e,i)}addInner(t,e,i){let s=t-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(j.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=j.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function ll(n,t,e){let i=new Map;for(let r of n)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&i.set(r.chunk[o],r.chunkPos[o]);let s=new Set;for(let r of t)for(let o=0;o<r.chunk.length;o++){let l=i.get(r.chunk[o]);l!=null&&(e?e.mapPos(l):l)==r.chunkPos[o]&&!e?.touchesRange(l,l+r.chunk[o].length)&&s.add(r.chunk[o])}return s}class Ha{constructor(t,e,i,s=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<t||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Hi{constructor(t){this.heap=t}static from(t,e=null,i=-1){let s=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&s.push(new Ha(o,e,i,r));return s.length==1?s[0]:new Hi(s)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)Tn(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)Tn(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Tn(this.heap,0)}}}function Tn(n,t){for(let e=n[t];;){let i=(t<<1)+1;if(i>=n.length)break;let s=n[i];if(i+1<n.length&&s.compare(n[i+1])>=0&&(s=n[i+1],i++),e.compare(s)<0)break;n[i]=e,n[t]=s,t=i}}class yi{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Hi.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){cs(this.active,t),cs(this.activeTo,t),cs(this.activeRank,t),this.minActive=al(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:s,rank:r}=this.cursor;for(;e<this.activeRank.length&&(r-this.activeRank[e]||s-this.activeTo[e])>0;)e++;us(this.active,e,i),us(this.activeTo,e,s),us(this.activeRank,e,r),t&&us(t,e,this.cursor.from),this.minActive=al(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>t){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&cs(i,s)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let s=i.length-1;s>=0&&i[s]<t;s--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function hl(n,t,e,i,s,r){n.goto(t),e.goto(i);let o=i+s,l=i,h=i-t;for(;;){let a=n.to+h-e.to||n.endSide-e.endSide,c=a<0?n.to+h:e.to,u=Math.min(c,o);if(n.point||e.point?n.point&&e.point&&(n.point==e.point||n.point.eq(e.point))&&Sr(n.activeForPoint(n.to),e.activeForPoint(e.to))||r.comparePoint(l,u,n.point,e.point):u>l&&!Sr(n.active,e.active)&&r.compareRange(l,u,n.active,e.active),c>o)break;l=c,a<=0&&n.next(),a>=0&&e.next()}}function Sr(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!=t[e]&&!n[e].eq(t[e]))return!1;return!0}function cs(n,t){for(let e=t,i=n.length-1;e<i;e++)n[e]=n[e+1];n.pop()}function us(n,t,e){for(let i=n.length-1;i>=t;i--)n[i+1]=n[i];n[t]=e}function al(n,t){let e=-1,i=1e9;for(let s=0;s<t.length;s++)(t[s]-i||n[s].endSide-n[e].endSide)<0&&(e=s,i=t[s]);return e}function ko(n,t,e=n.length){let i=0;for(let s=0;s<e;)n.charCodeAt(s)==9?(i+=t-i%t,s++):(i++,s=Yt(n,s));return i}function Cr(n,t,e,i){for(let s=0,r=0;;){if(r>=t)return s;if(s==n.length)break;r+=n.charCodeAt(s)==9?e-r%e:1,s=Yt(n,s)}return i===!0?-1:n.length}const Mr="",cl=typeof Symbol>"u"?"__"+Mr:Symbol.for(Mr),Ar=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ce{constructor(t,e){this.rules=[];let{finish:i}=e||{};function s(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,l,h,a){let c=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&l==null)return h.push(o[0]+";");for(let g in l){let p=l[g];if(/&/.test(g))r(g.split(/,\s*/).map(m=>o.map(b=>m.replace(/&/,b))).reduce((m,b)=>m.concat(b)),p,h);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+g+") should be a primitive value.");r(s(g),p,c,f)}else p!=null&&c.push(g.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(c.length||f)&&h.push((i&&!u&&!a?o.map(i):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in t)r(s(o),t[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=ul[cl]||1;return ul[cl]=t+1,Mr+t.toString(36)}static mount(t,e,i){let s=t[Ar],r=i&&i.nonce;s?r&&s.setNonce(r):s=new Yf(t,r),s.mount(Array.isArray(e)?e:[e],t)}}let fl=new Map;class Yf{constructor(t,e){let i=t.ownerDocument||t,s=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&s.CSSStyleSheet){let r=fl.get(i);if(r)return t[Ar]=r;this.sheet=new s.CSSStyleSheet,fl.set(i,this)}else this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[Ar]=this}mount(t,e){let i=this.sheet,s=0,r=0;for(let o=0;o<t.length;o++){let l=t[o],h=this.modules.indexOf(l);if(h<r&&h>-1&&(this.modules.splice(h,1),r--,h=-1),h==-1){if(this.modules.splice(r++,0,l),i)for(let a=0;a<l.rules.length;a++)i.insertRule(l.rules[a],s++)}else{for(;r<h;)s+=this.modules[r++].rules.length;s+=l.rules.length,r++}}if(i)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let o="";for(let h=0;h<this.modules.length;h++)o+=this.modules[h].getRules()+`
`;this.styleTag.textContent=o;let l=e.head||e;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var Me={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ji={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Zf=typeof navigator<"u"&&/Mac/.test(navigator.platform),Qf=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var bt=0;bt<10;bt++)Me[48+bt]=Me[96+bt]=String(bt);for(var bt=1;bt<=24;bt++)Me[bt+111]="F"+bt;for(var bt=65;bt<=90;bt++)Me[bt]=String.fromCharCode(bt+32),ji[bt]=String.fromCharCode(bt);for(var Dn in Me)ji.hasOwnProperty(Dn)||(ji[Dn]=Me[Dn]);function td(n){var t=Zf&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Qf&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?ji:Me)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function Ki(n){let t;return n.nodeType==11?t=n.getSelection?n:n.ownerDocument:t=n,t.getSelection()}function Er(n,t){return t?n==t||n.contains(t.nodeType!=1?t.parentNode:t):!1}function Is(n,t){if(!t.anchorNode)return!1;try{return Er(n,t.anchorNode)}catch{return!1}}function hi(n){return n.nodeType==3?Fe(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Ni(n,t,e,i){return e?dl(n,t,e,i,-1)||dl(n,t,e,i,1):!1}function Re(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t}function Zs(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function dl(n,t,e,i,s){for(;;){if(n==e&&t==i)return!0;if(t==(s<0?0:Qt(n))){if(n.nodeName=="DIV")return!1;let r=n.parentNode;if(!r||r.nodeType!=1)return!1;t=Re(n)+(s<0?0:1),n=r}else if(n.nodeType==1){if(n=n.childNodes[t+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;t=s<0?Qt(n):0}else return!1}}function Qt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function is(n,t){let e=t?n.left:n.right;return{left:e,right:e,top:n.top,bottom:n.bottom}}function ed(n){let t=n.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function ja(n,t){let e=t.width/n.offsetWidth,i=t.height/n.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-n.offsetWidth)<1)&&(e=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-n.offsetHeight)<1)&&(i=1),{scaleX:e,scaleY:i}}function id(n,t,e,i,s,r,o,l){let h=n.ownerDocument,a=h.defaultView||window;for(let c=n,u=!1;c&&!u;)if(c.nodeType==1){let f,g=c==h.body,p=1,m=1;if(g)f=ed(a);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(u=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let w=c.getBoundingClientRect();({scaleX:p,scaleY:m}=ja(c,w)),f={left:w.left,right:w.left+c.clientWidth*p,top:w.top,bottom:w.top+c.clientHeight*m}}let b=0,v=0;if(s=="nearest")t.top<f.top?(v=-(f.top-t.top+o),e>0&&t.bottom>f.bottom+v&&(v=t.bottom-f.bottom+v+o)):t.bottom>f.bottom&&(v=t.bottom-f.bottom+o,e<0&&t.top-v<f.top&&(v=-(f.top+v-t.top+o)));else{let w=t.bottom-t.top,x=f.bottom-f.top;v=(s=="center"&&w<=x?t.top+w/2-x/2:s=="start"||s=="center"&&e<0?t.top-o:t.bottom-x+o)-f.top}if(i=="nearest"?t.left<f.left?(b=-(f.left-t.left+r),e>0&&t.right>f.right+b&&(b=t.right-f.right+b+r)):t.right>f.right&&(b=t.right-f.right+r,e<0&&t.left<f.left+b&&(b=-(f.left+b-t.left+r))):b=(i=="center"?t.left+(t.right-t.left)/2-(f.right-f.left)/2:i=="start"==l?t.left-r:t.right-(f.right-f.left)+r)-f.left,b||v)if(g)a.scrollBy(b,v);else{let w=0,x=0;if(v){let y=c.scrollTop;c.scrollTop+=v/m,x=(c.scrollTop-y)*m}if(b){let y=c.scrollLeft;c.scrollLeft+=b/p,w=(c.scrollLeft-y)*p}t={left:t.left-w,top:t.top-x,right:t.right-w,bottom:t.bottom-x},w&&Math.abs(w-b)<1&&(i="nearest"),x&&Math.abs(x-v)<1&&(s="nearest")}if(g)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function sd(n){let t=n.ownerDocument,e,i;for(let s=n.parentNode;s&&!(s==t.body||e&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:e,y:i}}class nd{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?Qt(e):0),i,Math.min(t.focusOffset,i?Qt(i):0))}set(t,e,i,s){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=s}}let Ue=null;function Ka(n){if(n.setActive)return n.setActive();if(Ue)return n.focus(Ue);let t=[];for(let e=n;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(n.focus(Ue==null?{get preventScroll(){return Ue={preventScroll:!0},!0}}:void 0),!Ue){Ue=!1;for(let e=0;e<t.length;){let i=t[e++],s=t[e++],r=t[e++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=r&&(i.scrollLeft=r)}}}let gl;function Fe(n,t,e=t){let i=gl||(gl=document.createRange());return i.setEnd(n,e),i.setStart(n,t),i}function ei(n,t,e,i){let s={key:t,code:t,keyCode:e,which:e,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let r=new KeyboardEvent("keydown",s);r.synthetic=!0,n.dispatchEvent(r);let o=new KeyboardEvent("keyup",s);return o.synthetic=!0,n.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function rd(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function $a(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function od(n,t){let e=t.focusNode,i=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=i)return!1;for(i=Math.min(i,Qt(e));;)if(i){if(e.nodeType!=1)return!1;let s=e.childNodes[i-1];s.contentEditable=="false"?i--:(e=s,i=Qt(e))}else{if(e==n)return!0;i=Re(e),e=e.parentNode}}function Ua(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function Xa(n,t){for(let e=n,i=t;;){if(e.nodeType==3&&i>0)return{node:e,offset:i};if(e.nodeType==1&&i>0){if(e.contentEditable=="false")return null;e=e.childNodes[i-1],i=Qt(e)}else if(e.parentNode&&!Zs(e))i=Re(e),e=e.parentNode;else return null}}function Ga(n,t){for(let e=n,i=t;;){if(e.nodeType==3&&i<e.nodeValue.length)return{node:e,offset:i};if(e.nodeType==1&&i<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[i],i=0}else if(e.parentNode&&!Zs(e))i=Re(e)+1,e=e.parentNode;else return null}}class wt{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new wt(t.parentNode,Re(t),e)}static after(t,e){return new wt(t.parentNode,Re(t)+1,e)}}const So=[];class q{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let i=this.dom,s=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=s?s.nextSibling:i.firstChild)){let l=q.get(r);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(t,e),o.flags&=-8}if(r=s?s.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&r!=o.dom&&(e.written=!0),o.dom.parentNode==i)for(;r&&r!=o.dom;)r=pl(r);else i.insertBefore(o.dom,r);s=o.dom}for(r=s?s.nextSibling:i.firstChild,r&&e&&e.node==i&&(e.written=!0);r;)r=pl(r)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let s=Qt(t)==0?0:e==0?-1:1;for(;;){let r=t.parentNode;if(r==this.dom)break;s==0&&r.firstChild!=r.lastChild&&(t==r.firstChild?s=-1:s=1),t=r}s<0?i=t:i=t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!q.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,r=0;;s++){let o=this.children[s];if(o.dom==i)return r;r+=o.length+o.breakAfter}}domBoundsAround(t,e,i=0){let s=-1,r=-1,o=-1,l=-1;for(let h=0,a=i,c=i;h<this.children.length;h++){let u=this.children[h],f=a+u.length;if(a<t&&f>e)return u.domBoundsAround(t,e,a);if(f>=t&&s==-1&&(s=h,r=a),a>e&&u.dom.parentNode==this.dom){o=h,l=c;break}c=f,a=f+u.breakAfter}return{from:r,to:l<0?i+this.length:l,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=So){this.markDirty();for(let s=t;s<e;s++){let r=this.children[s];r.parent==this&&i.indexOf(r)<0&&r.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new qa(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,s,r,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}q.prototype.breakAfter=0;function pl(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class qa{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Ja(n,t,e,i,s,r,o,l,h){let{children:a}=n,c=a.length?a[t]:null,u=r.length?r[r.length-1]:null,f=u?u.breakAfter:o;if(!(t==i&&c&&!o&&!f&&r.length<2&&c.merge(e,s,r.length?u:null,e==0,l,h))){if(i<a.length){let g=a[i];g&&(s<g.length||g.breakAfter&&u?.breakAfter)?(t==i&&(g=g.split(s),s=0),!f&&u&&g.merge(0,s,u,!0,0,h)?r[r.length-1]=g:((s||g.children.length&&!g.children[0].length)&&g.merge(0,s,null,!1,0,h),r.push(g))):g?.breakAfter&&(u?u.breakAfter=1:o=1),i++}for(c&&(c.breakAfter=o,e>0&&(!o&&r.length&&c.merge(e,c.length,r[0],!1,l,0)?c.breakAfter=r.shift().breakAfter:(e<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(e,c.length,null,!1,l,0),t++));t<i&&r.length;)if(a[i-1].become(r[r.length-1]))i--,r.pop(),h=r.length?0:l;else if(a[t].become(r[0]))t++,r.shift(),l=r.length?0:h;else break;!r.length&&t&&i<a.length&&!a[t-1].breakAfter&&a[i].merge(0,0,a[t-1],!1,l,h)&&t--,(t<i||r.length)&&n.replaceChildren(t,i,r)}}function Ya(n,t,e,i,s,r){let o=n.childCursor(),{i:l,off:h}=o.findPos(e,1),{i:a,off:c}=o.findPos(t,-1),u=t-e;for(let f of i)u+=f.length;n.length+=u,Ja(n,a,c,l,h,i,0,s,r)}let Mt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Tr=typeof document<"u"?document:{documentElement:{style:{}}};const Dr=/Edge\/(\d+)/.exec(Mt.userAgent),Za=/MSIE \d/.test(Mt.userAgent),Lr=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mt.userAgent),mn=!!(Za||Lr||Dr),ml=!mn&&/gecko\/(\d+)/i.test(Mt.userAgent),Ln=!mn&&/Chrome\/(\d+)/.exec(Mt.userAgent),bl="webkitFontSmoothing"in Tr.documentElement.style,Qa=!mn&&/Apple Computer/.test(Mt.vendor),vl=Qa&&(/Mobile\/\w+/.test(Mt.userAgent)||Mt.maxTouchPoints>2);var T={mac:vl||/Mac/.test(Mt.platform),windows:/Win/.test(Mt.platform),linux:/Linux|X11/.test(Mt.platform),ie:mn,ie_version:Za?Tr.documentMode||6:Lr?+Lr[1]:Dr?+Dr[1]:0,gecko:ml,gecko_version:ml?+(/Firefox\/(\d+)/.exec(Mt.userAgent)||[0,0])[1]:0,chrome:!!Ln,chrome_version:Ln?+Ln[1]:0,ios:vl,android:/Android\b/.test(Mt.userAgent),webkit:bl,safari:Qa,webkit_version:bl?+(/\bAppleWebKit\/(\d+)/.exec(Mt.userAgent)||[0,0])[1]:0,tabSize:Tr.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const ld=256;class Vt extends q{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,i){return this.flags&8||i&&(!(i instanceof Vt)||this.length-(e-t)+i.length>ld||i.flags&8)?!1:(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Vt(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new wt(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return hd(this.dom,t,e)}}class ae extends q{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let s of e)s.setParent(this)}setAttrs(t){if($a(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,s,r,o){return i&&(!(i instanceof ae&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&o<=0)?!1:(Ya(this,t,e,i?i.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(t){let e=[],i=0,s=-1,r=0;for(let l of this.children){let h=i+l.length;h>t&&e.push(i<t?l.split(t-i):l),s<0&&i>=t&&(s=r),i=h,r++}let o=this.length-t;return this.length=t,s>-1&&(this.children.length=s,this.markDirty()),new ae(this.mark,e,o)}domAtPos(t){return tc(this,t)}coordsAt(t,e){return ic(this,t,e)}}function hd(n,t,e){let i=n.nodeValue.length;t>i&&(t=i);let s=t,r=t,o=0;t==0&&e<0||t==i&&e>=0?T.chrome||T.gecko||(t?(s--,o=1):r<i&&(r++,o=-1)):e<0?s--:r<i&&r++;let l=Fe(n,s,r).getClientRects();if(!l.length)return null;let h=l[(o?o<0:e>=0)?0:l.length-1];return T.safari&&!o&&h.width==0&&(h=Array.prototype.find.call(l,a=>a.width)||h),o?is(h,o<0):h||null}class ye extends q{static create(t,e,i){return new ye(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=ye.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,s,r,o){return i&&(!(i instanceof ye)||!this.widget.compare(i.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof ye&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return $.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):$.empty}domAtPos(t){return(this.length?t==0:this.side>0)?wt.before(this.dom):wt.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let s=this.dom.getClientRects(),r=null;if(!s.length)return null;let o=this.side?this.side<0:t>0;for(let l=o?s.length-1:0;r=s[l],!(t>0?l==0:l==s.length-1||r.top<r.bottom);l+=o?-1:1);return is(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ai extends q{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof ai&&t.side==this.side}split(){return new ai(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?wt.before(this.dom):wt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return $.empty}get isHidden(){return!0}}Vt.prototype.children=ye.prototype.children=ai.prototype.children=So;function tc(n,t){let e=n.dom,{children:i}=n,s=0;for(let r=0;s<i.length;s++){let o=i[s],l=r+o.length;if(!(l==r&&o.getSide()<=0)){if(t>r&&t<l&&o.dom.parentNode==e)return o.domAtPos(t-r);if(t<=r)break;r=l}}for(let r=s;r>0;r--){let o=i[r-1];if(o.dom.parentNode==e)return o.domAtPos(o.length)}for(let r=s;r<i.length;r++){let o=i[r];if(o.dom.parentNode==e)return o.domAtPos(0)}return new wt(e,0)}function ec(n,t,e){let i,{children:s}=n;e>0&&t instanceof ae&&s.length&&(i=s[s.length-1])instanceof ae&&i.mark.eq(t.mark)?ec(i,t.children[0],e-1):(s.push(t),t.setParent(n)),n.length+=t.length}function ic(n,t,e){let i=null,s=-1,r=null,o=-1;function l(a,c){for(let u=0,f=0;u<a.children.length&&f<=c;u++){let g=a.children[u],p=f+g.length;p>=c&&(g.children.length?l(g,c-f):(!r||r.isHidden&&e>0)&&(p>c||f==p&&g.getSide()>0)?(r=g,o=c-f):(f<c||f==p&&g.getSide()<0&&!g.isHidden)&&(i=g,s=c-f)),f=p}}l(n,t);let h=(e<0?i:r)||i||r;return h?h.coordsAt(Math.max(0,h==i?s:o),e):ad(n)}function ad(n){let t=n.dom.lastChild;if(!t)return n.dom.getBoundingClientRect();let e=hi(t);return e[e.length-1]||null}function Or(n,t){for(let e in n)e=="class"&&t.class?t.class+=" "+n.class:e=="style"&&t.style?t.style+=";"+n.style:t[e]=n[e];return t}const wl=Object.create(null);function Qs(n,t,e){if(n==t)return!0;n||(n=wl),t||(t=wl);let i=Object.keys(n),s=Object.keys(t);if(i.length-(e&&i.indexOf(e)>-1?1:0)!=s.length-(e&&s.indexOf(e)>-1?1:0))return!1;for(let r of i)if(r!=e&&(s.indexOf(r)==-1||n[r]!==t[r]))return!1;return!0}function Pr(n,t,e){let i=!1;if(t)for(let s in t)e&&s in e||(i=!0,s=="style"?n.style.cssText="":n.removeAttribute(s));if(e)for(let s in e)t&&t[s]==e[s]||(i=!0,s=="style"?n.style.cssText=e[s]:n.setAttribute(s,e[s]));return i}function cd(n){let t=Object.create(null);for(let e=0;e<n.attributes.length;e++){let i=n.attributes[e];t[i.name]=i.value}return t}class Le{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var xt=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(xt||(xt={}));class I extends li{constructor(t,e,i,s){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(t){return new ss(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new Ae(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,s;if(t.isBlockGap)i=-5e8,s=4e8;else{let{start:r,end:o}=sc(t,e);i=(r?e?-3e8:-1:5e8)-1,s=(o?e?2e8:1:-6e8)+1}return new Ae(t,i,s,e,t.widget||null,!0)}static line(t){return new ns(t)}static set(t,e=!1){return j.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}I.none=j.empty;class ss extends I{constructor(t){let{start:e,end:i}=sc(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof ss&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((i=t.attrs)===null||i===void 0?void 0:i.class))&&Qs(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}ss.prototype.point=!1;class ns extends I{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof ns&&this.spec.class==t.spec.class&&Qs(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}ns.prototype.mapMode=At.TrackBefore;ns.prototype.point=!0;class Ae extends I{constructor(t,e,i,s,r,o){super(e,i,r,t),this.block=s,this.isReplace=o,this.mapMode=s?e<=0?At.TrackBefore:At.TrackAfter:At.TrackDel}get type(){return this.startSide!=this.endSide?xt.WidgetRange:this.startSide<=0?xt.WidgetBefore:xt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Ae&&ud(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}Ae.prototype.point=!0;function sc(n,t=!1){let{inclusiveStart:e,inclusiveEnd:i}=n;return e==null&&(e=n.inclusive),i==null&&(i=n.inclusive),{start:e??t,end:i??t}}function ud(n,t){return n==t||!!(n&&t&&n.compare(t))}function Nr(n,t,e,i=0){let s=e.length-1;s>=0&&e[s]+i>=n?e[s]=Math.max(e[s],t):e.push(n,t)}class ht extends q{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,s,r,o){if(i){if(!(i instanceof ht))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),Ya(this,t,e,i?i.children.slice():[],r,o),!0}split(t){let e=new ht;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i,off:s}=this.childPos(t);s&&(e.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let r=i;r<this.children.length;r++)e.append(this.children[r],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Qs(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){ec(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Or(e,this.attrs||{})),i&&(this.attrs=Or({class:i},this.attrs||{}))}domAtPos(t){return tc(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?this.flags&4&&($a(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Pr(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let s=this.dom.lastChild;for(;s&&q.get(s)instanceof ae;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=q.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!T.ios||!this.children.some(r=>r instanceof Vt))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let i of this.children){if(!(i instanceof Vt)||/[^ -~]/.test(i.text))return null;let s=hi(i.dom);if(s.length!=1)return null;t+=s[0].width,e=s[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let i=ic(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,r=i.bottom-i.top;if(Math.abs(r-s.lineHeight)<2&&s.textHeight<r){let o=(r-s.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(t){return t instanceof ht&&this.children.length==0&&t.children.length==0&&Qs(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,s=0;i<t.children.length;i++){let r=t.children[i],o=s+r.length;if(o>=e){if(r instanceof ht)return r;if(o>e)break}s=o+r.breakAfter}return null}}class le extends q{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,s,r,o){return i&&(!(i instanceof le)||!this.widget.compare(i.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?wt.before(this.dom):wt.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new le(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return So}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):$.empty}domBoundsAround(){return null}become(t){return t instanceof le&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);return i||(this.widget instanceof zr?null:is(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e==i?!1:t<0?e<0:i>0}}class zr extends Le{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class zi{constructor(t,e,i,s){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof le&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new ht),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(fs(new ai(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof le)&&this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:r,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=r,this.textOff=0}let s=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(fs(new Vt(this.text.slice(this.textOff,this.textOff+s)),e),i),this.atCursorPos=!0,this.textOff+=s,t-=s,i=0}}span(t,e,i,s){this.buildText(e-t,i,s),this.pos=e,this.openStart<0&&(this.openStart=s)}point(t,e,i,s,r,o){if(this.disallowBlockEffectsFor[o]&&i instanceof Ae){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=e-t;if(i instanceof Ae)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new le(i.widget||ci.block,l,i));else{let h=ye.create(i.widget||ci.inline,l,l?0:i.startSide),a=this.atCursorPos&&!h.isEditable&&r<=s.length&&(t<e||i.startSide>0),c=!h.isEditable&&(t<e||r>s.length||i.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!a&&!h.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),a&&(u.append(fs(new ai(1),s),r),r=s.length+Math.max(0,r-s.length)),u.append(fs(h,s),r),this.atCursorPos=c,this.pendingBuffer=c?t<e||r>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,s,r){let o=new zi(t,e,i,r);return o.openEnd=j.spans(s,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function fs(n,t){for(let e of t)n=new ae(e,[n],n.length);return n}class ci extends Le{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}ci.inline=new ci("span");ci.block=new ci("div");var it=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(it||(it={}));const Ve=it.LTR,Co=it.RTL;function nc(n){let t=[];for(let e=0;e<n.length;e++)t.push(1<<+n[e]);return t}const fd=nc("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),dd=nc("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Br=Object.create(null),Kt=[];for(let n of["()","[]","{}"]){let t=n.charCodeAt(0),e=n.charCodeAt(1);Br[t]=e,Br[e]=-t}function rc(n){return n<=247?fd[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?dd[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const gd=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class xe{get dir(){return this.level%2?Co:Ve}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,s){let r=-1;for(let o=0;o<t.length;o++){let l=t[o];if(l.from<=e&&l.to>=e){if(l.level==i)return o;(r<0||(s!=0?s<0?l.from<e:l.to>e:t[r].level>l.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function oc(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++){let i=n[e],s=t[e];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!oc(i.inner,s.inner))return!1}return!0}const G=[];function pd(n,t,e,i,s){for(let r=0;r<=i.length;r++){let o=r?i[r-1].to:t,l=r<i.length?i[r].from:e,h=r?256:s;for(let a=o,c=h,u=h;a<l;a++){let f=rc(n.charCodeAt(a));f==512?f=c:f==8&&u==4&&(f=16),G[a]=f==4?2:f,f&7&&(u=f),c=f}for(let a=o,c=h,u=h;a<l;a++){let f=G[a];if(f==128)a<l-1&&c==G[a+1]&&c&24?f=G[a]=c:G[a]=256;else if(f==64){let g=a+1;for(;g<l&&G[g]==64;)g++;let p=a&&c==8||g<e&&G[g]==8?u==1?1:8:256;for(let m=a;m<g;m++)G[m]=p;a=g-1}else f==8&&u==1&&(G[a]=1);c=f,f&7&&(u=f)}}}function md(n,t,e,i,s){let r=s==1?2:1;for(let o=0,l=0,h=0;o<=i.length;o++){let a=o?i[o-1].to:t,c=o<i.length?i[o].from:e;for(let u=a,f,g,p;u<c;u++)if(g=Br[f=n.charCodeAt(u)])if(g<0){for(let m=l-3;m>=0;m-=3)if(Kt[m+1]==-g){let b=Kt[m+2],v=b&2?s:b&4?b&1?r:s:0;v&&(G[u]=G[Kt[m]]=v),l=m;break}}else{if(Kt.length==189)break;Kt[l++]=u,Kt[l++]=f,Kt[l++]=h}else if((p=G[u])==2||p==1){let m=p==s;h=m?0:1;for(let b=l-3;b>=0;b-=3){let v=Kt[b+2];if(v&2)break;if(m)Kt[b+2]|=2;else{if(v&4)break;Kt[b+2]|=4}}}}}function bd(n,t,e,i){for(let s=0,r=i;s<=e.length;s++){let o=s?e[s-1].to:n,l=s<e.length?e[s].from:t;for(let h=o;h<l;){let a=G[h];if(a==256){let c=h+1;for(;;)if(c==l){if(s==e.length)break;c=e[s++].to,l=s<e.length?e[s].from:t}else if(G[c]==256)c++;else break;let u=r==1,f=(c<t?G[c]:i)==1,g=u==f?u?1:2:i;for(let p=c,m=s,b=m?e[m-1].to:n;p>h;)p==b&&(p=e[--m].from,b=m?e[m-1].to:n),G[--p]=g;h=c}else r=a,h++}}}function _r(n,t,e,i,s,r,o){let l=i%2?2:1;if(i%2==s%2)for(let h=t,a=0;h<e;){let c=!0,u=!1;if(a==r.length||h<r[a].from){let m=G[h];m!=l&&(c=!1,u=m==16)}let f=!c&&l==1?[]:null,g=c?i:i+1,p=h;t:for(;;)if(a<r.length&&p==r[a].from){if(u)break t;let m=r[a];if(!c)for(let b=m.to,v=a+1;;){if(b==e)break t;if(v<r.length&&r[v].from==b)b=r[v++].to;else{if(G[b]==l)break t;break}}if(a++,f)f.push(m);else{m.from>h&&o.push(new xe(h,m.from,g));let b=m.direction==Ve!=!(g%2);Rr(n,b?i+1:i,s,m.inner,m.from,m.to,o),h=m.to}p=m.to}else{if(p==e||(c?G[p]!=l:G[p]==l))break;p++}f?_r(n,h,p,i+1,s,f,o):h<p&&o.push(new xe(h,p,g)),h=p}else for(let h=e,a=r.length;h>t;){let c=!0,u=!1;if(!a||h>r[a-1].to){let m=G[h-1];m!=l&&(c=!1,u=m==16)}let f=!c&&l==1?[]:null,g=c?i:i+1,p=h;t:for(;;)if(a&&p==r[a-1].to){if(u)break t;let m=r[--a];if(!c)for(let b=m.from,v=a;;){if(b==t)break t;if(v&&r[v-1].to==b)b=r[--v].from;else{if(G[b-1]==l)break t;break}}if(f)f.push(m);else{m.to<h&&o.push(new xe(m.to,h,g));let b=m.direction==Ve!=!(g%2);Rr(n,b?i+1:i,s,m.inner,m.from,m.to,o),h=m.from}p=m.from}else{if(p==t||(c?G[p-1]!=l:G[p-1]==l))break;p--}f?_r(n,p,h,i+1,s,f,o):p<h&&o.push(new xe(p,h,g)),h=p}}function Rr(n,t,e,i,s,r,o){let l=t%2?2:1;pd(n,s,r,i,l),md(n,s,r,i,l),bd(s,r,i,l),_r(n,s,r,t,e,i,o)}function vd(n,t,e){if(!n)return[new xe(0,0,t==Co?1:0)];if(t==Ve&&!e.length&&!gd.test(n))return lc(n.length);if(e.length)for(;n.length>G.length;)G[G.length]=256;let i=[],s=t==Ve?0:1;return Rr(n,s,s,e,0,n.length,i),i}function lc(n){return[new xe(0,n,0)]}let hc="";function wd(n,t,e,i,s){var r;let o=i.head-n.from,l=xe.find(t,o,(r=i.bidiLevel)!==null&&r!==void 0?r:-1,i.assoc),h=t[l],a=h.side(s,e);if(o==a){let f=l+=s?1:-1;if(f<0||f>=t.length)return null;h=t[l=f],o=h.side(!s,e),a=h.side(s,e)}let c=Yt(n.text,o,h.forward(s,e));(c<h.from||c>h.to)&&(c=a),hc=n.text.slice(Math.min(o,c),Math.max(o,c));let u=l==(s?t.length-1:0)?null:t[l+(s?1:-1)];return u&&c==a&&u.level+(s?0:1)<h.level?D.cursor(u.side(!s,e)+n.from,u.forward(s,e)?1:-1,u.level):D.cursor(c+n.from,h.forward(s,e)?-1:1,h.level)}function yd(n,t,e){for(let i=t;i<e;i++){let s=rc(n.charCodeAt(i));if(s==1)return Ve;if(s==2||s==4)return Co}return Ve}const ac=O.define(),cc=O.define(),uc=O.define(),fc=O.define(),Fr=O.define(),dc=O.define(),gc=O.define(),Mo=O.define(),Ao=O.define(),pc=O.define({combine:n=>n.some(t=>t)}),mc=O.define({combine:n=>n.some(t=>t)}),bc=O.define();class ii{constructor(t,e="nearest",i="nearest",s=5,r=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=s,this.xMargin=r,this.isSnapshot=o}map(t){return t.empty?this:new ii(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new ii(D.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const ds=tt.define({map:(n,t)=>n.map(t)}),vc=tt.define();function Rt(n,t,e){let i=n.facet(fc);i.length?i[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}const be=O.define({combine:n=>n.length?n[0]:!0});let xd=0;const Mi=O.define();class dt{constructor(t,e,i,s,r){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=s,this.extension=r(this)}static define(t,e){const{eventHandlers:i,eventObservers:s,provide:r,decorations:o}=e||{};return new dt(xd++,t,i,s,l=>{let h=[Mi.of(l)];return o&&h.push($i.of(a=>{let c=a.plugin(l);return c?o(c):I.none})),r&&h.push(r(l)),h})}static fromClass(t,e){return dt.define(i=>new t(i),e)}}class On{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(i){if(Rt(e.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Rt(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(i){Rt(t.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const wc=O.define(),Eo=O.define(),$i=O.define(),yc=O.define(),To=O.define(),xc=O.define();function yl(n,t){let e=n.state.facet(xc);if(!e.length)return e;let i=e.map(r=>r instanceof Function?r(n):r),s=[];return j.spans(i,t.from,t.to,{point(){},span(r,o,l,h){let a=r-t.from,c=o-t.from,u=s;for(let f=l.length-1;f>=0;f--,h--){let g=l[f].spec.bidiIsolate,p;if(g==null&&(g=yd(t.text,a,c)),h>0&&u.length&&(p=u[u.length-1]).to==a&&p.direction==g)p.to=c,u=p.inner;else{let m={from:a,to:c,direction:g,inner:[]};u.push(m),u=m.inner}}}}),s}const kc=O.define();function Do(n){let t=0,e=0,i=0,s=0;for(let r of n.state.facet(kc)){let o=r(n);o&&(o.left!=null&&(t=Math.max(t,o.left)),o.right!=null&&(e=Math.max(e,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(s=Math.max(s,o.bottom)))}return{left:t,right:e,top:i,bottom:s}}const Ai=O.define();class Bt{constructor(t,e,i,s){this.fromA=t,this.toA=e,this.fromB=i,this.toB=s}join(t){return new Bt(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let s=t[e-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(e.length==0)return t;let i=[];for(let s=0,r=0,o=0,l=0;;s++){let h=s==t.length?null:t[s],a=o-l,c=h?h.fromB:1e9;for(;r<e.length&&e[r]<c;){let u=e[r],f=e[r+1],g=Math.max(l,u),p=Math.min(c,f);if(g<=p&&new Bt(g+a,p+a,g,p).addToSet(i),f>c)break;r+=2}if(!h)return i;new Bt(h.fromA,h.toA,h.fromB,h.toB).addToSet(i),o=h.toA,l=h.toB}}}class tn{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=ft.empty(this.startState.doc.length);for(let r of i)this.changes=this.changes.compose(r.changes);let s=[];this.changes.iterChangedRanges((r,o,l,h)=>s.push(new Bt(r,o,l,h))),this.changedRanges=s}static create(t,e,i){return new tn(t,e,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class xl extends q{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=I.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new ht],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Bt(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:a,toA:c})=>c<this.minWidthFrom||a>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?s=this.domChanged.newSel.head:!Td(t.changes,this.hasComposition)&&!t.selectionSet&&(s=t.state.selection.main.head));let r=s>-1?Sd(this.view,t.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:a,to:c}=this.hasComposition;i=new Bt(a,c,t.changes.mapPos(a,-1),t.changes.mapPos(c,1)).addToSet(i.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(T.ie||T.chrome)&&!r&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),h=Ad(o,l,t.changes);return i=Bt.extendWithRanges(i,h),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,t.startState.doc.length,r),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=T.chrome||T.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||s.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof le&&o.widget instanceof zr&&r.push(o.dom);s.updateGaps(r)}updateChildren(t,e,i){let s=i?i.range.addToSet(t.slice()):t,r=this.childCursor(e);for(let o=s.length-1;;o--){let l=o>=0?s[o]:null;if(!l)break;let{fromA:h,toA:a,fromB:c,toB:u}=l,f,g,p,m;if(i&&i.range.fromB<u&&i.range.toB>c){let y=zi.build(this.view.state.doc,c,i.range.fromB,this.decorations,this.dynamicDecorationMap),k=zi.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);g=y.breakAtStart,p=y.openStart,m=k.openEnd;let S=this.compositionView(i);k.breakAtStart?S.breakAfter=1:k.content.length&&S.merge(S.length,S.length,k.content[0],!1,k.openStart,0)&&(S.breakAfter=k.content[0].breakAfter,k.content.shift()),y.content.length&&S.merge(0,0,y.content[y.content.length-1],!0,0,y.openEnd)&&y.content.pop(),f=y.content.concat(S).concat(k.content)}else({content:f,breakAtStart:g,openStart:p,openEnd:m}=zi.build(this.view.state.doc,c,u,this.decorations,this.dynamicDecorationMap));let{i:b,off:v}=r.findPos(a,1),{i:w,off:x}=r.findPos(h,-1);Ja(this,w,x,b,v,f,g,p,m)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let i of e.effects)i.is(vc)&&(this.editContextFormatting=i.value)}compositionView(t){let e=new Vt(t.text.nodeValue);e.flags|=8;for(let{deco:s}of t.marks)e=new ae(s,[e],e.length);let i=new ht;return i.append(e,0),i}fixCompositionDOM(t){let e=(r,o)=>{o.flags|=8|(o.children.some(h=>h.flags&7)?1:0),this.markedForComposition.add(o);let l=q.get(r);l&&l!=o&&(l.dom=null),o.setDOM(r)},i=this.childPos(t.range.fromB,1),s=this.children[i.i];e(t.line,s);for(let r=t.marks.length-1;r>=-1;r--)i=s.childPos(i.off,1),s=s.children[i.i],e(r>=0?t.marks[r].node:t.text,s)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,s=i==this.dom,r=!s&&Is(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(s||e||r))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,h=this.moveToLine(this.domAtPos(l.anchor)),a=l.empty?h:this.moveToLine(this.domAtPos(l.head));if(T.gecko&&l.empty&&!this.hasComposition&&kd(h)){let u=document.createTextNode("");this.view.observer.ignore(()=>h.node.insertBefore(u,h.node.childNodes[h.offset]||null)),h=a=new wt(u,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!Ni(h.node,h.offset,c.anchorNode,c.anchorOffset)||!Ni(a.node,a.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,l))&&(this.view.observer.ignore(()=>{T.android&&T.chrome&&this.dom.contains(c.focusNode)&&Ed(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=Ki(this.view.root);if(u)if(l.empty){if(T.gecko){let f=Cd(h.node,h.offset);if(f&&f!=3){let g=(f==1?Xa:Ga)(h.node,h.offset);g&&(h=new wt(g.node,g.offset))}}u.collapse(h.node,h.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(h.node,h.offset);try{u.extend(a.node,a.offset)}catch{}}else{let f=document.createRange();l.anchor>l.head&&([h,a]=[a,h]),f.setEnd(a.node,a.offset),f.setStart(h.node,h.offset),u.removeAllRanges(),u.addRange(f)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(h,a)),this.impreciseAnchor=h.precise?null:new wt(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new wt(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&Ni(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=Ki(t.root),{anchorNode:s,anchorOffset:r}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let o=ht.find(this,e.head);if(!o)return;let l=o.posAtStart;if(e.head==l||e.head==l+o.length)return;let h=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!h||!a||h.bottom>a.top)return;let c=this.domAtPos(e.head+e.assoc);i.collapse(c.node,c.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let u=t.observer.selectionRange;t.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=e.from&&i.collapse(s,r)}moveToLine(t){let e=this.dom,i;if(t.node!=e)return t;for(let s=t.offset;!i&&s<e.childNodes.length;s++){let r=q.get(e.childNodes[s]);r instanceof ht&&(i=r.domAtPos(0))}for(let s=t.offset-1;!i&&s>=0;s--){let r=q.get(e.childNodes[s]);r instanceof ht&&(i=r.domAtPos(r.length))}return i?new wt(i.node,i.offset,!0):t}nearest(t){for(let e=t;e;){let i=q.get(e);if(i&&i.rootView==this)return i;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let s=this.children[e];if(i<s.length||s instanceof ht)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,s=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],h=r-l.breakAfter,a=h-l.length;if(h<t)break;if(a<=t&&(a<t||l.covers(-1))&&(h>t||l.covers(1))&&(!i||l instanceof ht&&!(i instanceof ht&&e>=0)))i=l,s=a;else if(i&&a==t&&h==t&&l instanceof le&&Math.abs(e)<2){if(l.deco.startSide<0)break;o&&(i=null)}r=a}return i?i.coordsAt(t-s,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),s=this.children[e];if(!(s instanceof ht))return null;for(;s.children.length;){let{i:l,off:h}=s.childPos(i,1);for(;;l++){if(l==s.children.length)return null;if((s=s.children[l]).length)break}i=h}if(!(s instanceof Vt))return null;let r=Yt(s.text,i);if(r==i)return null;let o=Fe(s.dom,i,r).getClientRects();for(let l=0;l<o.length;l++){let h=o[l];if(l==o.length-1||h.top<h.bottom&&h.left<h.right)return h}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:s}=t,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,h=this.view.textDirection==it.LTR;for(let a=0,c=0;c<this.children.length;c++){let u=this.children[c],f=a+u.length;if(f>s)break;if(a>=i){let g=u.dom.getBoundingClientRect();if(e.push(g.height),o){let p=u.dom.lastChild,m=p?hi(p):[];if(m.length){let b=m[m.length-1],v=h?b.right-g.left:g.right-b.left;v>l&&(l=v,this.minWidth=r,this.minWidthFrom=a,this.minWidthTo=f)}}}a=f+u.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?it.RTL:it.LTR}measureTextSize(){for(let r of this.children)if(r instanceof ht){let o=r.measureTextSize();if(o)return o}let t=document.createElement("div"),e,i,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let r=hi(t.firstChild)[0];e=t.getBoundingClientRect().height,i=r?r.width/27:7,s=r?r.height:e,t.remove()}),{lineHeight:e,charWidth:i,textHeight:s}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new qa(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,s=0;;s++){let r=s==e.viewports.length?null:e.viewports[s],o=r?r.from-1:this.length;if(o>i){let l=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(I.replace({widget:new zr(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!r)break;i=r.to+1}return I.set(t)}updateDeco(){let t=1,e=this.view.state.facet($i).map(r=>(this.dynamicDecorationMap[t++]=typeof r=="function")?r(this.view):r),i=!1,s=this.view.state.facet(yc).map((r,o)=>{let l=typeof r=="function";return l&&(i=!0),l?r(this.view):r});for(s.length&&(this.dynamicDecorationMap[t++]=i,e.push(j.join(s))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let a=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=a.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let a of this.view.state.facet(bc))try{if(a(this.view,t.range,t))return!0}catch(c){Rt(this.view.state,c,"scroll handler")}let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),s;if(!i)return;!e.empty&&(s=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let r=Do(this.view),o={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:l,offsetHeight:h}=this.view.scrollDOM;id(this.view.scrollDOM,o,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,l),-l),Math.max(Math.min(t.yMargin,h),-h),this.view.textDirection==it.LTR)}}function kd(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function Sc(n,t){let e=n.observer.selectionRange;if(!e.focusNode)return null;let i=Xa(e.focusNode,e.focusOffset),s=Ga(e.focusNode,e.focusOffset),r=i||s;if(s&&i&&s.node!=i.node){let l=q.get(s.node);if(!l||l instanceof Vt&&l.text!=s.node.nodeValue)r=s;else if(n.docView.lastCompositionAfterCursor){let h=q.get(i.node);!h||h instanceof Vt&&h.text!=i.node.nodeValue||(r=s)}}if(n.docView.lastCompositionAfterCursor=r!=i,!r)return null;let o=t-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function Sd(n,t,e){let i=Sc(n,e);if(!i)return null;let{node:s,from:r,to:o}=i,l=s.nodeValue;if(/[\n\r]/.test(l)||n.state.doc.sliceString(i.from,i.to)!=l)return null;let h=t.invertedDesc,a=new Bt(h.mapPos(r),h.mapPos(o),r,o),c=[];for(let u=s.parentNode;;u=u.parentNode){let f=q.get(u);if(f instanceof ae)c.push({node:u,deco:f.mark});else{if(f instanceof ht||u.nodeName=="DIV"&&u.parentNode==n.contentDOM)return{range:a,text:s,marks:c,line:u};if(u!=n.contentDOM)c.push({node:u,deco:new ss({inclusive:!0,attributes:cd(u),tagName:u.tagName.toLowerCase()})});else return null}}}function Cd(n,t){return n.nodeType!=1?0:(t&&n.childNodes[t-1].contentEditable=="false"?1:0)|(t<n.childNodes.length&&n.childNodes[t].contentEditable=="false"?2:0)}let Md=class{constructor(){this.changes=[]}compareRange(t,e){Nr(t,e,this.changes)}comparePoint(t,e){Nr(t,e,this.changes)}};function Ad(n,t,e){let i=new Md;return j.compare(n,t,e,i),i.changes}function Ed(n,t){for(let e=n;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function Td(n,t){let e=!1;return t&&n.iterChangedRanges((i,s)=>{i<t.to&&s>t.from&&(e=!0)}),e}function Dd(n,t,e=1){let i=n.charCategorizer(t),s=n.doc.lineAt(t),r=t-s.from;if(s.length==0)return D.cursor(t);r==0?e=1:r==s.length&&(e=-1);let o=r,l=r;e<0?o=Yt(s.text,r,!1):l=Yt(s.text,r);let h=i(s.text.slice(o,l));for(;o>0;){let a=Yt(s.text,o,!1);if(i(s.text.slice(a,o))!=h)break;o=a}for(;l<s.length;){let a=Yt(s.text,l);if(i(s.text.slice(l,a))!=h)break;l=a}return D.range(o+s.from,l+s.from)}function Ld(n,t){return t.left>n?t.left-n:Math.max(0,n-t.right)}function Od(n,t){return t.top>n?t.top-n:Math.max(0,n-t.bottom)}function Pn(n,t){return n.top<t.bottom-1&&n.bottom>t.top+1}function kl(n,t){return t<n.top?{top:t,left:n.left,right:n.right,bottom:n.bottom}:n}function Sl(n,t){return t>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:t}:n}function Vr(n,t,e){let i,s,r,o,l=!1,h,a,c,u;for(let p=n.firstChild;p;p=p.nextSibling){let m=hi(p);for(let b=0;b<m.length;b++){let v=m[b];s&&Pn(s,v)&&(v=kl(Sl(v,s.bottom),s.top));let w=Ld(t,v),x=Od(e,v);if(w==0&&x==0)return p.nodeType==3?Cl(p,t,e):Vr(p,t,e);if(!i||o>x||o==x&&r>w){i=p,s=v,r=w,o=x;let y=x?e<v.top?-1:1:w?t<v.left?-1:1:0;l=!y||(y>0?b<m.length-1:b>0)}w==0?e>v.bottom&&(!c||c.bottom<v.bottom)?(h=p,c=v):e<v.top&&(!u||u.top>v.top)&&(a=p,u=v):c&&Pn(c,v)?c=Sl(c,v.bottom):u&&Pn(u,v)&&(u=kl(u,v.top))}}if(c&&c.bottom>=e?(i=h,s=c):u&&u.top<=e&&(i=a,s=u),!i)return{node:n,offset:0};let f=Math.max(s.left,Math.min(s.right,t));if(i.nodeType==3)return Cl(i,f,e);if(l&&i.contentEditable!="false")return Vr(i,f,e);let g=Array.prototype.indexOf.call(n.childNodes,i)+(t>=(s.left+s.right)/2?1:0);return{node:n,offset:g}}function Cl(n,t,e){let i=n.nodeValue.length,s=-1,r=1e9,o=0;for(let l=0;l<i;l++){let h=Fe(n,l,l+1).getClientRects();for(let a=0;a<h.length;a++){let c=h[a];if(c.top==c.bottom)continue;o||(o=t-c.left);let u=(c.top>e?c.top-e:e-c.bottom)-1;if(c.left-1<=t&&c.right+1>=t&&u<r){let f=t>=(c.left+c.right)/2,g=f;if((T.chrome||T.gecko)&&Fe(n,l).getBoundingClientRect().left==c.right&&(g=!f),u<=0)return{node:n,offset:l+(g?1:0)};s=l+(g?1:0),r=u}}}return{node:n,offset:s>-1?s:o>0?n.nodeValue.length:0}}function Cc(n,t,e,i=-1){var s,r;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,h,{docHeight:a}=n.viewState,{x:c,y:u}=t,f=u-l;if(f<0)return 0;if(f>a)return n.state.doc.length;for(let y=n.viewState.heightOracle.textHeight/2,k=!1;h=n.elementAtHeight(f),h.type!=xt.Text;)for(;f=i>0?h.bottom+y:h.top-y,!(f>=0&&f<=a);){if(k)return e?null:0;k=!0,i=-i}u=l+f;let g=h.from;if(g<n.viewport.from)return n.viewport.from==0?0:e?null:Ml(n,o,h,c,u);if(g>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:e?null:Ml(n,o,h,c,u);let p=n.dom.ownerDocument,m=n.root.elementFromPoint?n.root:p,b=m.elementFromPoint(c,u);b&&!n.contentDOM.contains(b)&&(b=null),b||(c=Math.max(o.left+1,Math.min(o.right-1,c)),b=m.elementFromPoint(c,u),b&&!n.contentDOM.contains(b)&&(b=null));let v,w=-1;if(b&&((s=n.docView.nearest(b))===null||s===void 0?void 0:s.isEditable)!=!1){if(p.caretPositionFromPoint){let y=p.caretPositionFromPoint(c,u);y&&({offsetNode:v,offset:w}=y)}else if(p.caretRangeFromPoint){let y=p.caretRangeFromPoint(c,u);y&&({startContainer:v,startOffset:w}=y,(!n.contentDOM.contains(v)||T.safari&&Pd(v,w,c)||T.chrome&&Nd(v,w,c))&&(v=void 0))}v&&(w=Math.min(Qt(v),w))}if(!v||!n.docView.dom.contains(v)){let y=ht.find(n.docView,g);if(!y)return f>h.top+h.height/2?h.to:h.from;({node:v,offset:w}=Vr(y.dom,c,u))}let x=n.docView.nearest(v);if(!x)return null;if(x.isWidget&&((r=x.dom)===null||r===void 0?void 0:r.nodeType)==1){let y=x.dom.getBoundingClientRect();return t.y<y.top||t.y<=y.bottom&&t.x<=(y.left+y.right)/2?x.posAtStart:x.posAtEnd}else return x.localPosFromDOM(v,w)+x.posAtStart}function Ml(n,t,e,i,s){let r=Math.round((i-t.left)*n.defaultCharacterWidth);if(n.lineWrapping&&e.height>n.defaultLineHeight*1.5){let l=n.viewState.heightOracle.textHeight,h=Math.floor((s-e.top-(n.defaultLineHeight-l)*.5)/l);r+=h*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(e.from,e.to);return e.from+Cr(o,r,n.state.tabSize)}function Pd(n,t,e){let i;if(n.nodeType!=3||t!=(i=n.nodeValue.length))return!1;for(let s=n.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return Fe(n,i-1,i).getBoundingClientRect().left>e}function Nd(n,t,e){if(t!=0)return!1;for(let s=n;;){let r=s.parentNode;if(!r||r.nodeType!=1||r.firstChild!=s)return!1;if(r.classList.contains("cm-line"))break;s=r}let i=n.nodeType==1?n.getBoundingClientRect():Fe(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return e-i.left>5}function Ir(n,t){let e=n.lineBlockAt(t);if(Array.isArray(e.type)){for(let i of e.type)if(i.to>t||i.to==t&&(i.to==e.to||i.type==xt.Text))return i}return e}function zd(n,t,e,i){let s=Ir(n,t.head),r=!i||s.type!=xt.Text||!(n.lineWrapping||s.widgetLineBreaks)?null:n.coordsAtPos(t.assoc<0&&t.head>s.from?t.head-1:t.head);if(r){let o=n.dom.getBoundingClientRect(),l=n.textDirectionAt(s.from),h=n.posAtCoords({x:e==(l==it.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(h!=null)return D.cursor(h,e?-1:1)}return D.cursor(e?s.to:s.from,e?-1:1)}function Al(n,t,e,i){let s=n.state.doc.lineAt(t.head),r=n.bidiSpans(s),o=n.textDirectionAt(s.from);for(let l=t,h=null;;){let a=wd(s,r,o,l,e),c=hc;if(!a){if(s.number==(e?n.state.doc.lines:1))return l;c=`
`,s=n.state.doc.line(s.number+(e?1:-1)),r=n.bidiSpans(s),a=n.visualLineSide(s,!e)}if(h){if(!h(c))return l}else{if(!i)return a;h=i(c)}l=a}}function Bd(n,t,e){let i=n.state.charCategorizer(t),s=i(e);return r=>{let o=i(r);return s==se.Space&&(s=o),s==o}}function _d(n,t,e,i){let s=t.head,r=e?1:-1;if(s==(e?n.state.doc.length:0))return D.cursor(s,t.assoc);let o=t.goalColumn,l,h=n.contentDOM.getBoundingClientRect(),a=n.coordsAtPos(s,t.assoc||-1),c=n.documentTop;if(a)o==null&&(o=a.left-h.left),l=r<0?a.top:a.bottom;else{let g=n.viewState.lineBlockAt(s);o==null&&(o=Math.min(h.right-h.left,n.defaultCharacterWidth*(s-g.from))),l=(r<0?g.top:g.bottom)+c}let u=h.left+o,f=i??n.viewState.heightOracle.textHeight>>1;for(let g=0;;g+=10){let p=l+(f+g)*r,m=Cc(n,{x:u,y:p},!1,r);if(p<h.top||p>h.bottom||(r<0?m<s:m>s)){let b=n.docView.coordsForChar(m),v=!b||p<b.top?-1:1;return D.cursor(m,v,void 0,o)}}}function Ws(n,t,e){for(;;){let i=0;for(let s of n)s.between(t-1,t+1,(r,o,l)=>{if(t>r&&t<o){let h=i||e||(t-r<o-t?-1:1);t=h<0?r:o,i=h}});if(!i)return t}}function Nn(n,t,e){let i=Ws(n.state.facet(To).map(s=>s(n)),e.from,t.head>e.from?-1:1);return i==e.from?e:D.cursor(i,i<e.from?1:-1)}const Ei="";class Rd{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(K.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Ei}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let s=t;;){this.findPointBefore(i,s);let r=this.text.length;this.readNode(s);let o=s.nextSibling;if(o==e)break;let l=q.get(s),h=q.get(o);(l&&h?l.breakAfter:(l?l.breakAfter:Zs(s))||Zs(o)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>r)&&this.lineBreak(),s=o}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,l;if(this.lineSeparator?(r=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=s.exec(e))&&(r=l.index,o=l[0].length),this.append(e.slice(i,r<0?e.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let h of this.points)h.node==t&&h.pos>this.text.length&&(h.pos-=o-1);i=r+o}}readNode(t){if(t.cmIgnore)return;let e=q.get(t),i=e&&e.overrideDOMText;if(i!=null){this.findPointInside(t,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(t.nodeType==3?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(Fd(t,i.node,i.offset)?e:0))}}function Fd(n,t,e){for(;;){if(!t||e<Qt(t))return!1;if(t==n)return!0;e=Re(t)+1,t=t.parentNode}}class El{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Vd{constructor(t,e,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:r,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let l=r||o?[]:Hd(t),h=new Rd(l,t.state);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=jd(l,this.bounds.from)}else{let l=t.observer.selectionRange,h=r&&r.node==l.focusNode&&r.offset==l.focusOffset||!Er(t.contentDOM,l.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(l.focusNode,l.focusOffset),a=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!Er(t.contentDOM,l.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(l.anchorNode,l.anchorOffset),c=t.viewport;if((T.ios||T.chrome)&&t.state.selection.main.empty&&h!=a&&(c.from>0||c.to<t.state.doc.length)){let u=Math.min(h,a),f=Math.max(h,a),g=c.from-u,p=c.to-f;(g==0||g==1||u==0)&&(p==0||p==-1||f==t.state.doc.length)&&(h=0,a=t.state.doc.length)}this.newSel=D.single(a,h)}}}function Mc(n,t){let e,{newSel:i}=t,s=n.state.selection.main,r=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(t.bounds){let{from:o,to:l}=t.bounds,h=s.from,a=null;(r===8||T.android&&t.text.length<l-o)&&(h=s.to,a="end");let c=Wd(n.state.doc.sliceString(o,l,Ei),t.text,h-o,a);c&&(T.chrome&&r==13&&c.toB==c.from+2&&t.text.slice(c.from,c.toB)==Ei+Ei&&c.toB--,e={from:o+c.from,to:o+c.toA,insert:$.of(t.text.slice(c.from,c.toB).split(Ei))})}else i&&(!n.hasFocus&&n.state.facet(be)||i.main.eq(s))&&(i=null);if(!e&&!i)return!1;if(!e&&t.typeOver&&!s.empty&&i&&i.main.empty?e={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:e&&e.from>=s.from&&e.to<=s.to&&(e.from!=s.from||e.to!=s.to)&&s.to-s.from-(e.to-e.from)<=4?e={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,e.from).append(e.insert).append(n.state.doc.slice(e.to,s.to))}:(T.mac||T.android)&&e&&e.from==e.to&&e.from==s.head-1&&/^\. ?$/.test(e.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&e.insert.length==2&&(i=D.single(i.main.anchor-1,i.main.head-1)),e={from:s.from,to:s.to,insert:$.of([" "])}):T.chrome&&e&&e.from==e.to&&e.from==s.head&&e.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=D.single(i.main.anchor-1,i.main.head-1)),e={from:s.from,to:s.to,insert:$.of([" "])}),e)return Lo(n,e,i,r);if(i&&!i.main.eq(s)){let o=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),l=n.inputState.lastSelectionOrigin),n.dispatch({selection:i,scrollIntoView:o,userEvent:l}),!0}else return!1}function Lo(n,t,e,i=-1){if(T.ios&&n.inputState.flushIOSKey(t))return!0;let s=n.state.selection.main;if(T.android&&(t.to==s.to&&(t.from==s.from||t.from==s.from-1&&n.state.sliceDoc(t.from,s.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&ei(n.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||i==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&ei(n.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&ei(n.contentDOM,"Delete",46)))return!0;let r=t.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,l=()=>o||(o=Id(n,t,e));return n.state.facet(dc).some(h=>h(n,t.from,t.to,r,l))||n.dispatch(l()),!0}function Id(n,t,e){let i,s=n.state,r=s.selection.main;if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&n.inputState.composing<0){let l=r.from<t.from?s.sliceDoc(r.from,t.from):"",h=r.to>t.to?s.sliceDoc(t.to,r.to):"";i=s.replaceSelection(n.state.toText(l+t.insert.sliceString(0,void 0,n.state.lineBreak)+h))}else{let l=s.changes(t),h=e&&e.main.to<=l.newLength?e.main:void 0;if(s.selection.ranges.length>1&&n.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let a=n.state.sliceDoc(t.from,t.to),c,u=e&&Sc(n,e.main.head);if(u){let p=t.insert.length-(t.to-t.from);c={from:u.from,to:u.to-p}}else c=n.state.doc.lineAt(r.head);let f=r.to-t.to,g=r.to-r.from;i=s.changeByRange(p=>{if(p.from==r.from&&p.to==r.to)return{changes:l,range:h||p.map(l)};let m=p.to-f,b=m-a.length;if(p.to-p.from!=g||n.state.sliceDoc(b,m)!=a||p.to>=c.from&&p.from<=c.to)return{range:p};let v=s.changes({from:b,to:m,insert:t.insert}),w=p.to-r.to;return{changes:v,range:h?D.range(Math.max(0,h.anchor+w),Math.max(0,h.head+w)):p.map(v)}})}else i={changes:l,selection:h&&s.selection.replaceRange(h)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:o,scrollIntoView:!0})}function Wd(n,t,e,i){let s=Math.min(n.length,t.length),r=0;for(;r<s&&n.charCodeAt(r)==t.charCodeAt(r);)r++;if(r==s&&n.length==t.length)return null;let o=n.length,l=t.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==t.charCodeAt(l-1);)o--,l--;if(i=="end"){let h=Math.max(0,r-Math.min(o,l));e-=o+h-r}if(o<r&&n.length<t.length){let h=e<=r&&e>=o?r-e:0;r-=h,l=r+(l-o),o=r}else if(l<r){let h=e<=r&&e>=l?r-e:0;r-=h,o=r+(o-l),l=r}return{from:r,toA:o,toB:l}}function Hd(n){let t=[];if(n.root.activeElement!=n.contentDOM)return t;let{anchorNode:e,anchorOffset:i,focusNode:s,focusOffset:r}=n.observer.selectionRange;return e&&(t.push(new El(e,i)),(s!=e||r!=i)&&t.push(new El(s,r))),t}function jd(n,t){if(n.length==0)return null;let e=n[0].pos,i=n.length==2?n[1].pos:e;return e>-1&&i>-1?D.single(e+t,i+t):null}class Kd{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,T.safari&&t.contentDOM.addEventListener("input",()=>null),T.gecko&&og(t.contentDOM.ownerDocument)}handleEvent(t){!Zd(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||this.runHandlers(t.type,t)}runHandlers(t,e){let i=this.handlers[t];if(i){for(let s of i.observers)s(this.view,e);for(let s of i.handlers){if(e.defaultPrevented)break;if(s(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=$d(t),i=this.handlers,s=this.view.contentDOM;for(let r in e)if(r!="scroll"){let o=!e[r].handlers.length,l=i[r];l&&o!=!l.handlers.length&&(s.removeEventListener(r,this.handleEvent),l=null),l||s.addEventListener(r,this.handleEvent,{passive:o})}for(let r in i)r!="scroll"&&!e[r]&&s.removeEventListener(r,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&Ec.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),T.android&&T.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return T.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=Ac.find(i=>i.keyCode==t.keyCode))&&!t.ctrlKey||Ud.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,ei(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:T.safari&&!T.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Tl(n,t){return(e,i)=>{try{return t.call(n,i,e)}catch(s){Rt(e.state,s)}}}function $d(n){let t=Object.create(null);function e(i){return t[i]||(t[i]={observers:[],handlers:[]})}for(let i of n){let s=i.spec;if(s&&s.domEventHandlers)for(let r in s.domEventHandlers){let o=s.domEventHandlers[r];o&&e(r).handlers.push(Tl(i.value,o))}if(s&&s.domEventObservers)for(let r in s.domEventObservers){let o=s.domEventObservers[r];o&&e(r).observers.push(Tl(i.value,o))}}for(let i in It)e(i).handlers.push(It[i]);for(let i in _t)e(i).observers.push(_t[i]);return t}const Ac=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ud="dthko",Ec=[16,17,18,20,91,92,224,225],gs=6;function ps(n){return Math.max(0,n)*.7+8}function Xd(n,t){return Math.max(Math.abs(n.clientX-t.clientX),Math.abs(n.clientY-t.clientY))}class Gd{constructor(t,e,i,s){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=sd(t.contentDOM),this.atoms=t.state.facet(To).map(o=>o(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(K.allowMultipleSelections)&&qd(t,e),this.dragging=Yd(t,e)&&Lc(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Xd(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,i=0,s=0,r=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:l}=this.scrollParents.y.getBoundingClientRect());let h=Do(this.view);t.clientX-h.left<=s+gs?e=-ps(s-t.clientX):t.clientX+h.right>=o-gs&&(e=ps(t.clientX-o)),t.clientY-h.top<=r+gs?i=-ps(r-t.clientY):t.clientY+h.bottom>=l-gs&&(i=ps(t.clientY-l)),this.setScrollSpeed(e,i)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let s=t.ranges[i],r=null;if(s.empty){let o=Ws(this.atoms,s.from,0);o!=s.from&&(r=D.cursor(o,-1))}else{let o=Ws(this.atoms,s.from,-1),l=Ws(this.atoms,s.to,1);(o!=s.from||l!=s.to)&&(r=D.range(s.from==s.anchor?o:l,s.from==s.head?o:l))}r&&(e||(e=t.ranges.slice()),e[i]=r)}return e?D.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!i.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function qd(n,t){let e=n.state.facet(ac);return e.length?e[0](t):T.mac?t.metaKey:t.ctrlKey}function Jd(n,t){let e=n.state.facet(cc);return e.length?e[0](t):T.mac?!t.altKey:!t.ctrlKey}function Yd(n,t){let{main:e}=n.state.selection;if(e.empty)return!1;let i=Ki(n.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let r=0;r<s.length;r++){let o=s[r];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return!0}return!1}function Zd(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,i;e!=n.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(i=q.get(e))&&i.ignoreEvent(t))return!1;return!0}const It=Object.create(null),_t=Object.create(null),Tc=T.ie&&T.ie_version<15||T.ios&&T.webkit_version<604;function Qd(n){let t=n.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{n.focus(),e.remove(),Dc(n,e.value)},50)}function bn(n,t,e){for(let i of n.facet(t))e=i(e,n);return e}function Dc(n,t){t=bn(n.state,Mo,t);let{state:e}=n,i,s=1,r=e.toText(t),o=r.lines==e.selection.ranges.length;if(Wr!=null&&e.selection.ranges.every(h=>h.empty)&&Wr==r.toString()){let h=-1;i=e.changeByRange(a=>{let c=e.doc.lineAt(a.from);if(c.from==h)return{range:a};h=c.from;let u=e.toText((o?r.line(s++).text:t)+e.lineBreak);return{changes:{from:c.from,insert:u},range:D.cursor(a.from+u.length)}})}else o?i=e.changeByRange(h=>{let a=r.line(s++);return{changes:{from:h.from,to:h.to,insert:a.text},range:D.cursor(h.from+a.length)}}):i=e.replaceSelection(r);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}_t.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};It.keydown=(n,t)=>(n.inputState.setSelectionOrigin("select"),t.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);_t.touchstart=(n,t)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};_t.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};It.mousedown=(n,t)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let i of n.state.facet(uc))if(e=i(n,t),e)break;if(!e&&t.button==0&&(e=ig(n,t)),e){let i=!n.hasFocus;n.inputState.startMouseSelection(new Gd(n,t,e,i)),i&&n.observer.ignore(()=>{Ka(n.contentDOM);let r=n.root.activeElement;r&&!r.contains(n.contentDOM)&&r.blur()});let s=n.inputState.mouseSelection;if(s)return s.start(t),s.dragging===!1}return!1};function Dl(n,t,e,i){if(i==1)return D.cursor(t,e);if(i==2)return Dd(n.state,t,e);{let s=ht.find(n.docView,t),r=n.state.doc.lineAt(s?s.posAtEnd:t),o=s?s.posAtStart:r.from,l=s?s.posAtEnd:r.to;return l<n.state.doc.length&&l==r.to&&l++,D.range(o,l)}}let Ll=(n,t,e)=>t>=e.top&&t<=e.bottom&&n>=e.left&&n<=e.right;function tg(n,t,e,i){let s=ht.find(n.docView,t);if(!s)return 1;let r=t-s.posAtStart;if(r==0)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&Ll(e,i,o))return-1;let l=s.coordsAt(r,1);return l&&Ll(e,i,l)?1:o&&o.bottom>=i?-1:1}function Ol(n,t){let e=n.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:tg(n,e,t.clientX,t.clientY)}}const eg=T.ie&&T.ie_version<=11;let Pl=null,Nl=0,zl=0;function Lc(n){if(!eg)return n.detail;let t=Pl,e=zl;return Pl=n,zl=Date.now(),Nl=!t||e>Date.now()-400&&Math.abs(t.clientX-n.clientX)<2&&Math.abs(t.clientY-n.clientY)<2?(Nl+1)%3:1}function ig(n,t){let e=Ol(n,t),i=Lc(t),s=n.state.selection;return{update(r){r.docChanged&&(e.pos=r.changes.mapPos(e.pos),s=s.map(r.changes))},get(r,o,l){let h=Ol(n,r),a,c=Dl(n,h.pos,h.bias,i);if(e.pos!=h.pos&&!o){let u=Dl(n,e.pos,e.bias,i),f=Math.min(u.from,c.from),g=Math.max(u.to,c.to);c=f<c.from?D.range(f,g):D.range(g,f)}return o?s.replaceRange(s.main.extend(c.from,c.to)):l&&i==1&&s.ranges.length>1&&(a=sg(s,h.pos))?a:l?s.addRange(c):D.create([c])}}}function sg(n,t){for(let e=0;e<n.ranges.length;e++){let{from:i,to:s}=n.ranges[e];if(i<=t&&s>=t)return D.create(n.ranges.slice(0,e).concat(n.ranges.slice(e+1)),n.mainIndex==e?0:n.mainIndex-(n.mainIndex>e?1:0))}return null}It.dragstart=(n,t)=>{let{selection:{main:e}}=n.state;if(t.target.draggable){let s=n.docView.nearest(t.target);if(s&&s.isWidget){let r=s.posAtStart,o=r+s.length;(r>=e.to||o<=e.from)&&(e=D.range(r,o))}}let{inputState:i}=n;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",bn(n.state,Ao,n.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1};It.dragend=n=>(n.inputState.draggedContent=null,!1);function Bl(n,t,e,i){if(e=bn(n.state,Mo,e),!e)return;let s=n.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:r}=n.inputState,o=i&&r&&Jd(n,t)?{from:r.from,to:r.to}:null,l={from:s,insert:e},h=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:h,selection:{anchor:h.mapPos(s,-1),head:h.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}It.drop=(n,t)=>{if(!t.dataTransfer)return!1;if(n.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let i=Array(e.length),s=0,r=()=>{++s==e.length&&Bl(n,t,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<e.length;o++){let l=new FileReader;l.onerror=r,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[o]=l.result),r()},l.readAsText(e[o])}return!0}else{let i=t.dataTransfer.getData("Text");if(i)return Bl(n,t,i,!0),!0}return!1};It.paste=(n,t)=>{if(n.state.readOnly)return!0;n.observer.flush();let e=Tc?null:t.clipboardData;return e?(Dc(n,e.getData("text/plain")||e.getData("text/uri-list")),!0):(Qd(n),!1)};function ng(n,t){let e=n.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function rg(n){let t=[],e=[],i=!1;for(let s of n.selection.ranges)s.empty||(t.push(n.sliceDoc(s.from,s.to)),e.push(s));if(!t.length){let s=-1;for(let{from:r}of n.selection.ranges){let o=n.doc.lineAt(r);o.number>s&&(t.push(o.text),e.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),s=o.number}i=!0}return{text:bn(n,Ao,t.join(n.lineBreak)),ranges:e,linewise:i}}let Wr=null;It.copy=It.cut=(n,t)=>{let{text:e,ranges:i,linewise:s}=rg(n.state);if(!e&&!s)return!1;Wr=s?e:null,t.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let r=Tc?null:t.clipboardData;return r?(r.clearData(),r.setData("text/plain",e),!0):(ng(n,e),!1)};const Oc=mi.define();function Pc(n,t){let e=[];for(let i of n.facet(gc)){let s=i(n,t);s&&e.push(s)}return e?n.update({effects:e,annotations:Oc.of(!0)}):null}function Nc(n){setTimeout(()=>{let t=n.hasFocus;if(t!=n.inputState.notifiedFocused){let e=Pc(n.state,t);e?n.dispatch(e):n.update([])}},10)}_t.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),Nc(n)};_t.blur=n=>{n.observer.clearSelectionRange(),Nc(n)};_t.compositionstart=_t.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};_t.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,T.chrome&&T.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};_t.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};It.beforeinput=(n,t)=>{var e,i;if(t.inputType=="insertReplacementText"&&n.observer.editContext){let r=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),o=t.getTargetRanges();if(r&&o.length){let l=o[0],h=n.posAtDOM(l.startContainer,l.startOffset),a=n.posAtDOM(l.endContainer,l.endOffset);return Lo(n,{from:h,to:a,insert:n.state.toText(r)},null),!0}}let s;if(T.chrome&&T.android&&(s=Ac.find(r=>r.inputType==t.inputType))&&(n.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let r=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return T.ios&&t.inputType=="deleteContentForward"&&n.observer.flushSoon(),T.safari&&t.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>_t.compositionend(n,t),20),!1};const _l=new Set;function og(n){_l.has(n)||(_l.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const Rl=["pre-wrap","normal","pre-line","break-spaces"];let ui=!1;function Fl(){ui=!1}class lg{constructor(t){this.lineWrapping=t,this.doc=$.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Rl.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let s=t[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(e=!0,this.heightSamples[Math.floor(s*10)]=!0)}return e}refresh(t,e,i,s,r,o){let l=Rl.indexOf(t)>-1,h=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=e,this.charWidth=i,this.textHeight=s,this.lineLength=r,h){this.heightSamples={};for(let a=0;a<o.length;a++){let c=o[a];c<0?a++:this.heightSamples[Math.floor(c*10)]=!0}}return h}}class hg{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Jt{constructor(t,e,i,s,r){this.from=t,this.length=e,this.top=i,this.height=s,this._content=r}get type(){return typeof this._content=="number"?xt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ae?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new Jt(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Z=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(Z||(Z={}));const Hs=.001;class kt{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Hs&&(ui=!0),this.height=t)}replace(t,e,i){return kt.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,s){let r=this,o=i.doc;for(let l=s.length-1;l>=0;l--){let{fromA:h,toA:a,fromB:c,toB:u}=s[l],f=r.lineAt(h,Z.ByPosNoHeight,i.setDoc(e),0,0),g=f.to>=a?f:r.lineAt(a,Z.ByPosNoHeight,i,0,0);for(u+=g.to-a,a=g.to;l>0&&f.from<=s[l-1].toA;)h=s[l-1].fromA,c=s[l-1].fromB,l--,h<f.from&&(f=r.lineAt(h,Z.ByPosNoHeight,i,0,0));c+=f.from-h,h=f.from;let p=Oo.build(i.setDoc(o),t,c,u);r=en(r,r.replace(h,a,p))}return r.updateHeight(i,0)}static empty(){return new Lt(0,0)}static of(t){if(t.length==1)return t[0];let e=0,i=t.length,s=0,r=0;for(;;)if(e==i)if(s>r*2){let l=t[e-1];l.break?t.splice(--e,1,l.left,null,l.right):t.splice(--e,1,l.left,l.right),i+=1+l.break,s-=l.size}else if(r>s*2){let l=t[i];l.break?t.splice(i,1,l.left,null,l.right):t.splice(i,1,l.left,l.right),i+=2+l.break,r-=l.size}else break;else if(s<r){let l=t[e++];l&&(s+=l.size)}else{let l=t[--i];l&&(r+=l.size)}let o=0;return t[e-1]==null?(o=1,e--):t[e]==null&&(o=1,i++),new ag(kt.of(t.slice(0,e)),o,kt.of(t.slice(i)))}}function en(n,t){return n==t?n:(n.constructor!=t.constructor&&(ui=!0),t)}kt.prototype.size=1;class zc extends kt{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,s){return new Jt(s,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,s,r){return this.blockAt(0,i,s,r)}forEachLine(t,e,i,s,r,o){t<=r+this.length&&e>=r&&o(this.blockAt(0,i,s,r))}updateHeight(t,e=0,i=!1,s){return s&&s.from<=e&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Lt extends zc{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,s){return new Jt(s,this.length,i,this.height,this.breaks)}replace(t,e,i){let s=i[0];return i.length==1&&(s instanceof Lt||s instanceof mt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof mt?s=new Lt(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):kt.of(i)}updateHeight(t,e=0,i=!1,s){return s&&s.from<=e&&s.more?this.setHeight(s.heights[s.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class mt extends kt{constructor(t){super(t,0)}heightMetrics(t,e){let i=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,r=s-i+1,o,l=0;if(t.lineWrapping){let h=Math.min(this.height,t.lineHeight*r);o=h/r,this.length>r+1&&(l=(this.height-h)/(this.length-r-1))}else o=this.height/r;return{firstLine:i,lastLine:s,perLine:o,perChar:l}}blockAt(t,e,i,s){let{firstLine:r,lastLine:o,perLine:l,perChar:h}=this.heightMetrics(e,s);if(e.lineWrapping){let a=s+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),c=e.doc.lineAt(a),u=l+c.length*h,f=Math.max(i,t-u/2);return new Jt(c.from,c.length,f,u,0)}else{let a=Math.max(0,Math.min(o-r,Math.floor((t-i)/l))),{from:c,length:u}=e.doc.line(r+a);return new Jt(c,u,i+l*a,l,0)}}lineAt(t,e,i,s,r){if(e==Z.ByHeight)return this.blockAt(t,i,s,r);if(e==Z.ByPosNoHeight){let{from:g,to:p}=i.doc.lineAt(t);return new Jt(g,p-g,0,0,0)}let{firstLine:o,perLine:l,perChar:h}=this.heightMetrics(i,r),a=i.doc.lineAt(t),c=l+a.length*h,u=a.number-o,f=s+l*u+h*(a.from-r-u);return new Jt(a.from,a.length,Math.max(s,Math.min(f,s+this.height-c)),c,0)}forEachLine(t,e,i,s,r,o){t=Math.max(t,r),e=Math.min(e,r+this.length);let{firstLine:l,perLine:h,perChar:a}=this.heightMetrics(i,r);for(let c=t,u=s;c<=e;){let f=i.doc.lineAt(c);if(c==t){let p=f.number-l;u+=h*p+a*(t-r-p)}let g=h+a*f.length;o(new Jt(f.from,f.length,u,g,0)),u+=g,c=f.to+1}}replace(t,e,i){let s=this.length-e;if(s>0){let r=i[i.length-1];r instanceof mt?i[i.length-1]=new mt(r.length+s):i.push(null,new mt(s-1))}if(t>0){let r=i[0];r instanceof mt?i[0]=new mt(t+r.length):i.unshift(new mt(t-1),null)}return kt.of(i)}decomposeLeft(t,e){e.push(new mt(t-1),null)}decomposeRight(t,e){e.push(null,new mt(this.length-t-1))}updateHeight(t,e=0,i=!1,s){let r=e+this.length;if(s&&s.from<=e+this.length&&s.more){let o=[],l=Math.max(e,s.from),h=-1;for(s.from>e&&o.push(new mt(s.from-e-1).updateHeight(t,e));l<=r&&s.more;){let c=t.doc.lineAt(l).length;o.length&&o.push(null);let u=s.heights[s.index++];h==-1?h=u:Math.abs(u-h)>=Hs&&(h=-2);let f=new Lt(c,u);f.outdated=!1,o.push(f),l+=c+1}l<=r&&o.push(null,new mt(r-l).updateHeight(t,l));let a=kt.of(o);return(h<0||Math.abs(a.height-this.height)>=Hs||Math.abs(h-this.heightMetrics(t,e).perLine)>=Hs)&&(ui=!0),en(this,a)}else(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class ag extends kt{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return this.flags&1}blockAt(t,e,i,s){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,s):this.right.blockAt(t,e,r,s+this.left.length+this.break)}lineAt(t,e,i,s,r){let o=s+this.left.height,l=r+this.left.length+this.break,h=e==Z.ByHeight?t<o:t<l,a=h?this.left.lineAt(t,e,i,s,r):this.right.lineAt(t,e,i,o,l);if(this.break||(h?a.to<l:a.from>l))return a;let c=e==Z.ByPosNoHeight?Z.ByPosNoHeight:Z.ByPos;return h?a.join(this.right.lineAt(l,c,i,o,l)):this.left.lineAt(l,c,i,s,r).join(a)}forEachLine(t,e,i,s,r,o){let l=s+this.left.height,h=r+this.left.length+this.break;if(this.break)t<h&&this.left.forEachLine(t,e,i,s,r,o),e>=h&&this.right.forEachLine(t,e,i,l,h,o);else{let a=this.lineAt(h,Z.ByPos,i,s,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,s,r,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,l,h,o)}}replace(t,e,i){let s=this.left.length+this.break;if(e<s)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-s,e-s,i));let r=[];t>0&&this.decomposeLeft(t,r);let o=r.length;for(let l of i)r.push(l);if(t>0&&Vl(r,o-1),e<this.length){let l=r.length;this.decomposeRight(e,r),Vl(r,l)}return kt.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,s=i+this.break;if(t>=s)return this.right.decomposeRight(t-s,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<s&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?kt.of(this.break?[t,null,e]:[t,e]):(this.left=en(this.left,t),this.right=en(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,s){let{left:r,right:o}=this,l=e+r.length+this.break,h=null;return s&&s.from<=e+r.length&&s.more?h=r=r.updateHeight(t,e,i,s):r.updateHeight(t,e,i),s&&s.from<=l+o.length&&s.more?h=o=o.updateHeight(t,l,i,s):o.updateHeight(t,l,i),h?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Vl(n,t){let e,i;n[t]==null&&(e=n[t-1])instanceof mt&&(i=n[t+1])instanceof mt&&n.splice(t-1,3,new mt(e.length+1+i.length))}const cg=5;class Oo{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let i=Math.min(e,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Lt?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Lt(i-this.pos,-1)),this.writtenTo=i,e>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,r=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new zc(o,s,i)):(o||r||s>=cg)&&this.addLineDeco(s,r,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Lt(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new mt(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Lt)return t;let e=new Lt(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,t),s.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Lt)&&!this.isCovered?this.nodes.push(new Lt(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=t;for(let s of this.nodes)s instanceof Lt&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(t,e,i,s){let r=new Oo(i,t);return j.spans(e,i,s,r,0),r.finish(i)}}function ug(n,t,e){let i=new fg;return j.compare(n,t,e,i,0),i.changes}class fg{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,s){(t<e||i&&i.heightRelevant||s&&s.heightRelevant)&&Nr(t,e,this.changes,5)}}function dg(n,t){let e=n.getBoundingClientRect(),i=n.ownerDocument,s=i.defaultView||window,r=Math.max(0,e.left),o=Math.min(s.innerWidth,e.right),l=Math.max(0,e.top),h=Math.min(s.innerHeight,e.bottom);for(let a=n.parentNode;a&&a!=i.body;)if(a.nodeType==1){let c=a,u=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&u.overflow!="visible"){let f=c.getBoundingClientRect();r=Math.max(r,f.left),o=Math.min(o,f.right),l=Math.max(l,f.top),h=Math.min(a==n.parentNode?s.innerHeight:h,f.bottom)}a=u.position=="absolute"||u.position=="fixed"?c.offsetParent:c.parentNode}else if(a.nodeType==11)a=a.host;else break;return{left:r-e.left,right:Math.max(r,o)-e.left,top:l-(e.top+t),bottom:Math.max(l,h)-(e.top+t)}}function gg(n,t){let e=n.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class zn{constructor(t,e,i,s){this.from=t,this.to=e,this.size=i,this.displaySize=s}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let s=t[i],r=e[i];if(s.from!=r.from||s.to!=r.to||s.size!=r.size)return!1}return!0}draw(t,e){return I.replace({widget:new pg(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class pg extends Le{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Il{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Wl,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=it.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Eo).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new lg(e),this.stateDeco=t.facet($i).filter(i=>typeof i!="function"),this.heightMap=kt.empty().applyChanges(this.stateDeco,$.empty,this.heightOracle.setDoc(t.doc),[new Bt(0,0,0,t.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=I.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let s=i?e.head:e.anchor;if(!t.some(({from:r,to:o})=>s>=r&&s<=o)){let{from:r,to:o}=this.lineBlockAt(s);t.push(new ms(r,o))}}return this.viewports=t.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Wl:new Po(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(Ti(t,this.scaler))})}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet($i).filter(c=>typeof c!="function");let s=t.changedRanges,r=Bt.extendWithRanges(s,ug(i,this.stateDeco,t?t.changes:ft.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Fl(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||ui)&&(t.flags|=2),l?(this.scrollAnchorPos=t.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let h=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<h.from||e.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,e));let a=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,t.flags|=this.updateForViewport(),(a||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(mc)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),s=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?it.RTL:it.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),l=e.getBoundingClientRect(),h=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let a=0,c=0;if(l.width&&l.height){let{scaleX:y,scaleY:k}=ja(e,l);(y>.005&&Math.abs(this.scaleX-y)>.005||k>.005&&Math.abs(this.scaleY-k)>.005)&&(this.scaleX=y,this.scaleY=k,a|=8,o=h=!0)}let u=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=f)&&(this.paddingTop=u,this.paddingBottom=f,a|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(s.lineWrapping&&(h=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=8);let g=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=g&&(this.scrollAnchorHeight=-1,this.scrollTop=g),this.scrolledToBottom=Ua(t.scrollDOM);let p=(this.printing?gg:dg)(e,this.paddingTop),m=p.top-this.pixelViewport.top,b=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(v!=this.inView&&(this.inView=v,v&&(h=!0)),!this.inView&&!this.scrollTarget)return 0;let w=l.width;if((this.contentDOMWidth!=w||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=t.scrollDOM.clientHeight,a|=8),h){let y=t.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(y)&&(o=!0),o||s.lineWrapping&&Math.abs(w-this.contentDOMWidth)>s.charWidth){let{lineHeight:k,charWidth:S,textHeight:C}=t.docView.measureTextSize();o=k>0&&s.refresh(r,k,S,C,w/S,y),o&&(t.docView.minWidth=0,a|=8)}m>0&&b>0?c=Math.max(m,b):m<0&&b<0&&(c=Math.min(m,b)),Fl();for(let k of this.viewports){let S=k.from==this.viewport.from?y:t.docView.measureVisibleLineHeights(k);this.heightMap=(o?kt.empty().applyChanges(this.stateDeco,$.empty,this.heightOracle,[new Bt(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new hg(k.from,S))}ui&&(a|=2)}let x=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return x&&(a&2&&(a|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),a|=this.updateForViewport()),(a&2||x)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),s=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,h=new ms(s.lineAt(o-i*1e3,Z.ByHeight,r,0,0).from,s.lineAt(l+(1-i)*1e3,Z.ByHeight,r,0,0).to);if(e){let{head:a}=e.range;if(a<h.from||a>h.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=s.lineAt(a,Z.ByPos,r,0,0),f;e.y=="center"?f=(u.top+u.bottom)/2-c/2:e.y=="start"||e.y=="nearest"&&a<h.from?f=u.top:f=u.bottom-c,h=new ms(s.lineAt(f-1e3/2,Z.ByHeight,r,0,0).from,s.lineAt(f+c+1e3/2,Z.ByHeight,r,0,0).to)}}return h}mapViewport(t,e){let i=e.mapPos(t.from,-1),s=e.mapPos(t.to,1);return new ms(this.heightMap.lineAt(i,Z.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Z.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(t,Z.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(e,Z.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(t==0||s<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=l+Math.max(10,Math.min(i,250)))&&s>o-2*1e3&&r<l+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let s of t)e.touchesRange(s.from,s.to)||i.push(new zn(e.mapPos(s.from),e.mapPos(s.to),s.size,s.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,r=s>>1,o=s<<1;if(this.defaultTextDirection!=it.LTR&&!i)return[];let l=[],h=(c,u,f,g)=>{if(u-c<r)return;let p=this.state.selection.main,m=[p.from];p.empty||m.push(p.to);for(let v of m)if(v>c&&v<u){h(c,v-10,f,g),h(v+10,u,f,g);return}let b=bg(t,v=>v.from>=f.from&&v.to<=f.to&&Math.abs(v.from-c)<r&&Math.abs(v.to-u)<r&&!m.some(w=>v.from<w&&v.to>w));if(!b){if(u<f.to&&e&&i&&e.visibleRanges.some(x=>x.from<=u&&x.to>=u)){let x=e.moveToLineBoundary(D.cursor(u),!1,!0).head;x>c&&(u=x)}let v=this.gapSize(f,c,u,g),w=i||v<2e6?v:2e6;b=new zn(c,u,v,w)}l.push(b)},a=c=>{if(c.length<o||c.type!=xt.Text)return;let u=mg(c.from,c.to,this.stateDeco);if(u.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,g,p;if(i){let m=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,b,v;if(f!=null){let w=vs(u,f),x=((this.visibleBottom-this.visibleTop)/2+m)/c.height;b=w-x,v=w+x}else b=(this.visibleTop-c.top-m)/c.height,v=(this.visibleBottom-c.top+m)/c.height;g=bs(u,b),p=bs(u,v)}else{let m=u.total*this.heightOracle.charWidth,b=s*this.heightOracle.charWidth,v=0;if(m>2e6)for(let S of t)S.from>=c.from&&S.from<c.to&&S.size!=S.displaySize&&S.from*this.heightOracle.charWidth+v<this.pixelViewport.left&&(v=S.size-S.displaySize);let w=this.pixelViewport.left+v,x=this.pixelViewport.right+v,y,k;if(f!=null){let S=vs(u,f),C=((x-w)/2+b)/m;y=S-C,k=S+C}else y=(w-b)/m,k=(x+b)/m;g=bs(u,y),p=bs(u,k)}g>c.from&&h(c.from,g,c,u),p<c.to&&h(p,c.to,c,u)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(a):a(c);return l}gapSize(t,e,i,s){let r=vs(s,i)-vs(s,e);return this.heightOracle.lineWrapping?t.height*r:s.total*this.heightOracle.charWidth*r}updateLineGaps(t){zn.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=I.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];j.spans(t,this.viewport.from,this.viewport.to,{span(s,r){e.push({from:s,to:r})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some((s,r)=>s.from!=e[r].from||s.to!=e[r].to);return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||Ti(this.heightMap.lineAt(t,Z.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||Ti(this.heightMap.lineAt(this.scaler.fromDOM(t),Z.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Ti(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class ms{constructor(t,e){this.from=t,this.to=e}}function mg(n,t,e){let i=[],s=n,r=0;return j.spans(e,n,t,{span(){},point(o,l){o>s&&(i.push({from:s,to:o}),r+=o-s),s=l}},20),s<t&&(i.push({from:s,to:t}),r+=t-s),{total:r,ranges:i}}function bs({total:n,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let i=Math.floor(n*e);for(let s=0;;s++){let{from:r,to:o}=t[s],l=o-r;if(i<=l)return r+i;i-=l}}function vs(n,t){let e=0;for(let{from:i,to:s}of n.ranges){if(t<=s){e+=t-i;break}e+=s-i}return e/n.total}function bg(n,t){for(let e of n)if(t(e))return e}const Wl={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class Po{constructor(t,e,i){let s=0,r=0,o=0;this.viewports=i.map(({from:l,to:h})=>{let a=e.lineAt(l,Z.ByPos,t,0,0).top,c=e.lineAt(h,Z.ByPos,t,0,0).bottom;return s+=c-a,{from:l,to:h,top:a,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(e.height-s);for(let l of this.viewports)l.domTop=o+(l.top-r)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),r=l.bottom}toDOM(t){for(let e=0,i=0,s=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return s+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,s=r.domBottom}}fromDOM(t){for(let e=0,i=0,s=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-s)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,s=r.domBottom}}eq(t){return t instanceof Po?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to):!1}}function Ti(n,t){if(t.scale==1)return n;let e=t.toDOM(n.top),i=t.toDOM(n.bottom);return new Jt(n.from,n.length,e,i-e,Array.isArray(n._content)?n._content.map(s=>Ti(s,t)):n._content)}const ws=O.define({combine:n=>n.join(" ")}),Hr=O.define({combine:n=>n.indexOf(!0)>-1}),jr=Ce.newName(),Bc=Ce.newName(),_c=Ce.newName(),Rc={"&light":"."+Bc,"&dark":"."+_c};function Kr(n,t,e){return new Ce(t,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return n;if(!e||!e[s])throw new RangeError(`Unsupported selector: ${s}`);return e[s]}):n+" "+i}})}const vg=Kr("."+jr,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Rc),wg={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Bn=T.ie&&T.ie_version<=11;class yg{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new nd,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let i of e)this.queue.push(i);(T.ie&&T.ie_version<=11||T.ios&&t.composing)&&e.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&t.constructor.EDIT_CONTEXT!==!1&&!(T.chrome&&T.chrome_version<126)&&(this.editContext=new kg(t),t.state.facet(be)&&(t.contentDOM.editContext=this.editContext.editContext)),Bn&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(be)?i.root.activeElement!=this.dom:!Is(this.dom,s))return;let r=s.anchorNode&&i.docView.nearest(s.anchorNode);if(r&&r.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(T.ie&&T.ie_version<=11||T.android&&T.chrome)&&!i.state.selection.main.empty&&s.focusNode&&Ni(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Ki(t.root);if(!e)return!1;let i=T.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&xg(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let s=Is(this.dom,i);return s&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&od(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(i.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=e)i.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,wg),Bn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Bn&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let s=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&ei(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,s=!1;for(let r of t){let o=this.readMutation(r);o&&(o.typeOver&&(s=!0),e==-1?{from:e,to:i}=o:(e=Math.min(o.from,e),i=Math.max(o.to,i)))}return{from:e,to:i,typeOver:s}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),s=this.selectionChanged&&Is(this.dom,this.selectionRange);if(t<0&&!s)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new Vd(this.view,t,e,i);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,s=Mc(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let i=Hl(e,t.previousSibling||t.target.previousSibling,-1),s=Hl(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:s?e.posBefore(s):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(be)!=t.state.facet(be)&&(t.view.contentDOM.editContext=t.state.facet(be)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Hl(n,t,e){for(;t;){let i=q.get(t);if(i&&i.parent==n)return i;let s=t.parentNode;t=s!=n.dom?s:e>0?t.nextSibling:t.previousSibling}return null}function jl(n,t){let e=t.startContainer,i=t.startOffset,s=t.endContainer,r=t.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return Ni(o.node,o.offset,s,r)&&([e,i,s,r]=[s,r,e,i]),{anchorNode:e,anchorOffset:i,focusNode:s,focusOffset:r}}function xg(n,t){if(t.getComposedRanges){let s=t.getComposedRanges(n.root)[0];if(s)return jl(n,s)}let e=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),e=s.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",i,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",i,!0),e?jl(n,e):null}class kg{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=i=>{let{anchor:s}=t.state.selection.main,r=this.toEditorPos(i.updateRangeStart),o=this.toEditorPos(i.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:r,drifted:!1});let l={from:r,to:o,insert:$.of(i.text.split(`
`))};l.from==this.from&&s<this.from?l.from=s:l.to==this.to&&s>this.to&&(l.to=s),!(l.from==l.to&&!l.insert.length)&&(this.pendingContextChange=l,t.state.readOnly||Lo(t,l,D.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd))),this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state)))},this.handlers.characterboundsupdate=i=>{let s=[],r=null;for(let o=this.toEditorPos(i.rangeStart),l=this.toEditorPos(i.rangeEnd);o<l;o++){let h=t.coordsForChar(o);r=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||r||new DOMRect,s.push(r)}e.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let r of i.getTextFormats()){let o=r.underlineStyle,l=r.underlineThickness;if(o!="None"&&l!="None"){let h=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;s.push(I.mark({attributes:{style:h}}).range(this.toEditorPos(r.rangeStart),this.toEditorPos(r.rangeEnd)))}}t.dispatch({effects:vc.of(I.set(s))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(t.state)}};for(let i in this.handlers)e.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=Ki(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,s=this.pendingContextChange;return t.changes.iterChanges((r,o,l,h,a)=>{if(i)return;let c=a.length-(o-r);if(s&&o>=s.to)if(s.from==r&&s.to==o&&s.insert.eq(a)){s=this.pendingContextChange=null,e+=c,this.to+=c;return}else s=null,this.revertPending(t.state);if(r+=e,o+=e,o<=this.from)this.from+=c,this.to+=c;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+a.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),a.toString()),this.to+=c}e+=c}),s&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange;this.composing&&(this.composing.drifted||t.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),s=this.toContextPos(e.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t){let e=this.composing;return e&&e.drifted?e.editorBase+(t-e.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class B{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(s=>s.forEach(r=>i(r,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=t.root||rd(t.parent)||document,this.viewState=new Il(t.state||K.create(t)),t.scrollTo&&t.scrollTo.is(ds)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Mi).map(s=>new On(s));for(let s of this.plugins)s.update(this);this.observer=new yg(this),this.inputState=new Kd(this),this.inputState.ensureHandlers(this.plugins),this.docView=new xl(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof yt?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,s,r=this.state;for(let f of t){if(f.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=f.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,l=0,h=null;t.some(f=>f.annotation(Oc))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,h=Pc(r,o),h||(l=1));let a=this.observer.delayedAndroidKey,c=null;if(a?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(c=null)):this.observer.clear(),r.facet(K.phrases)!=this.state.facet(K.phrases))return this.setState(r);s=tn.create(this,r,t),s.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let f of t){if(u&&(u=u.map(f.changes)),f.scrollIntoView){let{main:g}=f.state.selection;u=new ii(g.empty?g:D.cursor(g.head,g.head>g.anchor?-1:1))}for(let g of f.effects)g.is(ds)&&(u=g.value.clip(this.state))}this.viewState.update(s,u),this.bidiCache=sn.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),e=this.docView.update(s),this.state.facet(Ai)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(ws)!=s.state.facet(ws)&&(this.viewState.mustMeasureContent=!0),(e||i||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!s.empty)for(let f of this.state.facet(Fr))try{f(s)}catch(g){Rt(this.state,g,"update listener")}(h||c)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),c&&!Mc(this,c)&&a.force&&ei(this.contentDOM,a.key,a.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Il(t),this.plugins=t.facet(Mi).map(i=>new On(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new xl(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Mi),i=t.state.facet(Mi);if(e!=i){let s=[];for(let r of i){let o=e.indexOf(r);if(o<0)s.push(new On(r));else{let l=this.plugins[o];l.mustUpdate=t,s.push(l)}}for(let r of this.plugins)r.mustUpdate!=t&&r.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=t;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(i){Rt(this.state,i,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(Ua(i))r=-1,o=this.viewState.heightMap.height;else{let g=this.viewState.scrollAnchorAt(s);r=g.from,o=g.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];h&4||([this.measureRequests,a]=[a,this.measureRequests]);let c=a.map(g=>{try{return g.read(this)}catch(p){return Rt(this.state,p),Kl}}),u=tn.create(this,this.state,[]),f=!1;u.flags|=h,e?e.flags|=h:e=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),f=this.docView.update(u),f&&this.docViewUpdate());for(let g=0;g<a.length;g++)if(c[g]!=Kl)try{let p=a[g];p.write&&p.write(c[g],this)}catch(p){Rt(this.state,p)}if(f&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(p>1||p<-1){s=s+p,i.scrollTop=s/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let l of this.state.facet(Fr))l(e)}get themeClasses(){return jr+" "+(this.state.facet(Hr)?_c:Bc)+" "+this.state.facet(ws)}updateAttrs(){let t=$l(this,wc,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(be)?"true":"false",class:"cm-content",style:`${T.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),$l(this,Eo,e);let i=this.observer.ignore(()=>{let s=Pr(this.contentDOM,this.contentAttrs,e),r=Pr(this.dom,this.editorAttrs,t);return s||r});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let s of i.effects)if(s.is(B.announce)){e&&(this.announceDOM.textContent=""),e=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Ai);let t=this.state.facet(B.cspNonce);Ce.mount(this.root,this.styleModules.concat(vg).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(i=>i.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Nn(this,t,Al(this,t,e,i))}moveByGroup(t,e){return Nn(this,t,Al(this,t,e,i=>Bd(this,t.head,i)))}visualLineSide(t,e){let i=this.bidiSpans(t),s=this.textDirectionAt(t.from),r=i[e?i.length-1:0];return D.cursor(r.side(e,s)+t.from,r.forward(!e,s)?1:-1)}moveToLineBoundary(t,e,i=!0){return zd(this,t,e,i)}moveVertically(t,e,i){return Nn(this,t,_d(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Cc(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(t),r=this.bidiSpans(s),o=r[xe.find(r,t-s.from,-1,e)];return is(i,o.dir==it.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(pc)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Sg)return lc(t.length);let e=this.textDirectionAt(t.from),i;for(let r of this.bidiCache)if(r.from==t.from&&r.dir==e&&(r.fresh||oc(r.isolates,i=yl(this,t))))return r.order;i||(i=yl(this,t));let s=vd(t.text,e,i);return this.bidiCache.push(new sn(t.from,t.to,e,i,!0,s)),s}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||T.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Ka(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return ds.of(new ii(typeof t=="number"?D.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return ds.of(new ii(D.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return dt.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return dt.define(()=>({}),{eventObservers:t})}static theme(t,e){let i=Ce.newName(),s=[ws.of(i),Ai.of(Kr(`.${i}`,t))];return e&&e.dark&&s.push(Hr.of(!0)),s}static baseTheme(t){return gn.lowest(Ai.of(Kr("."+jr,t,Rc)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),s=i&&q.get(i)||q.get(t);return((e=s?.rootView)===null||e===void 0?void 0:e.view)||null}}B.styleModule=Ai;B.inputHandler=dc;B.clipboardInputFilter=Mo;B.clipboardOutputFilter=Ao;B.scrollHandler=bc;B.focusChangeEffect=gc;B.perLineTextDirection=pc;B.exceptionSink=fc;B.updateListener=Fr;B.editable=be;B.mouseSelectionStyle=uc;B.dragMovesSelection=cc;B.clickAddsSelectionRange=ac;B.decorations=$i;B.outerDecorations=yc;B.atomicRanges=To;B.bidiIsolatedRanges=xc;B.scrollMargins=kc;B.darkTheme=Hr;B.cspNonce=O.define({combine:n=>n.length?n[0]:""});B.contentAttributes=Eo;B.editorAttributes=wc;B.lineWrapping=B.contentAttributes.of({class:"cm-lineWrapping"});B.announce=tt.define();const Sg=4096,Kl={};class sn{constructor(t,e,i,s,r,o){this.from=t,this.to=e,this.dir=i,this.isolates=s,this.fresh=r,this.order=o}static update(t,e){if(e.empty&&!t.some(r=>r.fresh))return t;let i=[],s=t.length?t[t.length-1].dir:it.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let o=t[r];o.dir==s&&!e.touchesRange(o.from,o.to)&&i.push(new sn(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function $l(n,t,e){for(let i=n.state.facet(t),s=i.length-1;s>=0;s--){let r=i[s],o=typeof r=="function"?r(n):r;o&&Or(o,e)}return e}const Cg=T.mac?"mac":T.windows?"win":T.linux?"linux":"key";function Mg(n,t){const e=n.split(/-(?!$)/);let i=e[e.length-1];i=="Space"&&(i=" ");let s,r,o,l;for(let h=0;h<e.length-1;++h){const a=e[h];if(/^(cmd|meta|m)$/i.test(a))l=!0;else if(/^a(lt)?$/i.test(a))s=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))t=="mac"?l=!0:r=!0;else throw new Error("Unrecognized modifier name: "+a)}return s&&(i="Alt-"+i),r&&(i="Ctrl-"+i),l&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function ys(n,t,e){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e!==!1&&t.shiftKey&&(n="Shift-"+n),n}const Ag=gn.default(B.domEventHandlers({keydown(n,t){return Vc(Fc(t.state),n,t,"editor")}})),Eg=O.define({enables:Ag}),Ul=new WeakMap;function Fc(n){let t=n.facet(Eg),e=Ul.get(t);return e||Ul.set(t,e=Dg(t.reduce((i,s)=>i.concat(s),[]))),e}function xv(n,t,e){return Vc(Fc(n.state),t,n,e)}let ve=null;const Tg=4e3;function Dg(n,t=Cg){let e=Object.create(null),i=Object.create(null),s=(o,l)=>{let h=i[o];if(h==null)i[o]=l;else if(h!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,l,h,a,c)=>{var u,f;let g=e[o]||(e[o]=Object.create(null)),p=l.split(/ (?!$)/).map(v=>Mg(v,t));for(let v=1;v<p.length;v++){let w=p.slice(0,v).join(" ");s(w,!0),g[w]||(g[w]={preventDefault:!0,stopPropagation:!1,run:[x=>{let y=ve={view:x,prefix:w,scope:o};return setTimeout(()=>{ve==y&&(ve=null)},Tg),!0}]})}let m=p.join(" ");s(m,!1);let b=g[m]||(g[m]={preventDefault:!1,stopPropagation:!1,run:((f=(u=g._any)===null||u===void 0?void 0:u.run)===null||f===void 0?void 0:f.slice())||[]});h&&b.run.push(h),a&&(b.preventDefault=!0),c&&(b.stopPropagation=!0)};for(let o of n){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let a of l){let c=e[a]||(e[a]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=o;for(let f in c)c[f].run.push(g=>u(g,$r))}let h=o[t]||o.key;if(h)for(let a of l)r(a,h,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(a,"Shift-"+h,o.shift,o.preventDefault,o.stopPropagation)}return e}let $r=null;function Vc(n,t,e,i){$r=t;let s=td(t),r=Oi(s,0),o=fr(r)==s.length&&s!=" ",l="",h=!1,a=!1,c=!1;ve&&ve.view==e&&ve.scope==i&&(l=ve.prefix+" ",Ec.indexOf(t.keyCode)<0&&(a=!0,ve=null));let u=new Set,f=b=>{if(b){for(let v of b.run)if(!u.has(v)&&(u.add(v),v(e)))return b.stopPropagation&&(c=!0),!0;b.preventDefault&&(b.stopPropagation&&(c=!0),a=!0)}return!1},g=n[i],p,m;return g&&(f(g[l+ys(s,t,!o)])?h=!0:o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(T.windows&&t.ctrlKey&&t.altKey)&&(p=Me[t.keyCode])&&p!=s?(f(g[l+ys(p,t,!0)])||t.shiftKey&&(m=ji[t.keyCode])!=s&&m!=p&&f(g[l+ys(m,t,!1)]))&&(h=!0):o&&t.shiftKey&&f(g[l+ys(s,t,!0)])&&(h=!0),!h&&f(g._any)&&(h=!0)),a&&(h=!0),h&&c&&t.stopPropagation(),$r=null,h}class rs{constructor(t,e,i,s,r){this.className=t,this.left=e,this.top=i,this.width=s,this.height=r}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,i){if(i.empty){let s=t.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let r=Ic(t);return[new rs(e,s.left-r.left,s.top-r.top,null,s.bottom-s.top)]}else return Lg(t,e,i)}}function Ic(n){let t=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==it.LTR?t.left:t.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:t.top-n.scrollDOM.scrollTop*n.scaleY}}function Xl(n,t,e,i){let s=n.coordsAtPos(t,e*2);if(!s)return i;let r=n.dom.getBoundingClientRect(),o=(s.top+s.bottom)/2,l=n.posAtCoords({x:r.left+1,y:o}),h=n.posAtCoords({x:r.right-1,y:o});return l==null||h==null?i:{from:Math.max(i.from,Math.min(l,h)),to:Math.min(i.to,Math.max(l,h))}}function Lg(n,t,e){if(e.to<=n.viewport.from||e.from>=n.viewport.to)return[];let i=Math.max(e.from,n.viewport.from),s=Math.min(e.to,n.viewport.to),r=n.textDirection==it.LTR,o=n.contentDOM,l=o.getBoundingClientRect(),h=Ic(n),a=o.querySelector(".cm-line"),c=a&&window.getComputedStyle(a),u=l.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),f=l.right-(c?parseInt(c.paddingRight):0),g=Ir(n,i),p=Ir(n,s),m=g.type==xt.Text?g:null,b=p.type==xt.Text?p:null;if(m&&(n.lineWrapping||g.widgetLineBreaks)&&(m=Xl(n,i,1,m)),b&&(n.lineWrapping||p.widgetLineBreaks)&&(b=Xl(n,s,-1,b)),m&&b&&m.from==b.from&&m.to==b.to)return w(x(e.from,e.to,m));{let k=m?x(e.from,null,m):y(g,!1),S=b?x(null,e.to,b):y(p,!0),C=[];return(m||g).to<(b||p).from-(m&&b?1:0)||g.widgetLineBreaks>1&&k.bottom+n.defaultLineHeight/2<S.top?C.push(v(u,k.bottom,f,S.top)):k.bottom<S.top&&n.elementAtHeight((k.bottom+S.top)/2).type==xt.Text&&(k.bottom=S.top=(k.bottom+S.top)/2),w(k).concat(C).concat(w(S))}function v(k,S,C,L){return new rs(t,k-h.left,S-h.top-.01,C-k,L-S+.01)}function w({top:k,bottom:S,horizontal:C}){let L=[];for(let N=0;N<C.length;N+=2)L.push(v(C[N],k,C[N+1],S));return L}function x(k,S,C){let L=1e9,N=-1e9,F=[];function z(_,W,X,nt,st){let U=n.coordsAtPos(_,_==C.to?-2:2),rt=n.coordsAtPos(X,X==C.from?2:-2);!U||!rt||(L=Math.min(U.top,rt.top,L),N=Math.max(U.bottom,rt.bottom,N),st==it.LTR?F.push(r&&W?u:U.left,r&&nt?f:rt.right):F.push(!r&&nt?u:rt.left,!r&&W?f:U.right))}let A=k??C.from,V=S??C.to;for(let _ of n.visibleRanges)if(_.to>A&&_.from<V)for(let W=Math.max(_.from,A),X=Math.min(_.to,V);;){let nt=n.state.doc.lineAt(W);for(let st of n.bidiSpans(nt)){let U=st.from+nt.from,rt=st.to+nt.from;if(U>=X)break;rt>W&&z(Math.max(U,W),k==null&&U<=A,Math.min(rt,X),S==null&&rt>=V,st.dir)}if(W=nt.to+1,W>=X)break}return F.length==0&&z(A,k==null,V,S==null,n.textDirection),{top:L,bottom:N,horizontal:F}}function y(k,S){let C=l.top+(S?k.top:k.bottom);return{top:C,bottom:C,horizontal:[]}}}function Og(n,t){return n.constructor==t.constructor&&n.eq(t)}class Pg{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(js)!=t.state.facet(js)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,i=t.facet(js);for(;e<i.length&&i[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;(t!=this.scaleX||e!=this.scaleY)&&(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some((e,i)=>!Og(e,this.drawn[i]))){let e=this.dom.firstChild,i=0;for(let s of t)s.update&&e&&s.constructor&&this.drawn[i].constructor&&s.update(e,this.drawn[i])?(e=e.nextSibling,i++):this.dom.insertBefore(s.draw(),e);for(;e;){let s=e.nextSibling;e.remove(),e=s}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const js=O.define();function Wc(n){return[dt.define(t=>new Pg(t,n)),js.of(n)]}const Hc=!T.ios,Ui=O.define({combine(n){return es(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function kv(n={}){return[Ui.of(n),Ng,zg,Bg,mc.of(!0)]}function jc(n){return n.startState.facet(Ui)!=n.state.facet(Ui)}const Ng=Wc({above:!0,markers(n){let{state:t}=n,e=t.facet(Ui),i=[];for(let s of t.selection.ranges){let r=s==t.selection.main;if(s.empty?!r||Hc:e.drawRangeCursor){let o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=s.empty?s:D.cursor(s.head,s.head>s.anchor?-1:1);for(let h of rs.forRange(n,o,l))i.push(h)}}return i},update(n,t){n.transactions.some(i=>i.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let e=jc(n);return e&&Gl(n.state,t),n.docChanged||n.selectionSet||e},mount(n,t){Gl(t.state,n)},class:"cm-cursorLayer"});function Gl(n,t){t.style.animationDuration=n.facet(Ui).cursorBlinkRate+"ms"}const zg=Wc({above:!1,markers(n){return n.state.selection.ranges.map(t=>t.empty?[]:rs.forRange(n,"cm-selectionBackground",t)).reduce((t,e)=>t.concat(e))},update(n,t){return n.docChanged||n.selectionSet||n.viewportChanged||jc(n)},class:"cm-selectionLayer"}),Ur={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};Hc&&(Ur[".cm-line"].caretColor=Ur[".cm-content"].caretColor="transparent !important");const Bg=gn.highest(B.theme(Ur)),Kc=tt.define({map(n,t){return n==null?null:t.mapPos(n)}}),Di=Ht.define({create(){return null},update(n,t){return n!=null&&(n=t.changes.mapPos(n)),t.effects.reduce((e,i)=>i.is(Kc)?i.value:e,n)}}),_g=dt.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var t;let e=n.state.field(Di);e==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Di)!=e||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,t=n.state.field(Di),e=t!=null&&n.coordsAtPos(t);if(!e)return null;let i=n.scrollDOM.getBoundingClientRect();return{left:e.left-i.left+n.scrollDOM.scrollLeft*n.scaleX,top:e.top-i.top+n.scrollDOM.scrollTop*n.scaleY,height:e.bottom-e.top}}drawCursor(n){if(this.cursor){let{scaleX:t,scaleY:e}=this.view;n?(this.cursor.style.left=n.left/t+"px",this.cursor.style.top=n.top/e+"px",this.cursor.style.height=n.height/e+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Di)!=n&&this.view.dispatch({effects:Kc.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Sv(){return[Di,_g]}function ql(n,t,e,i,s){t.lastIndex=0;for(let r=n.iterRange(e,i),o=e,l;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;l=t.exec(r.value);)s(o+l.index,l)}function Rg(n,t){let e=n.visibleRanges;if(e.length==1&&e[0].from==n.viewport.from&&e[0].to==n.viewport.to)return e;let i=[];for(let{from:s,to:r}of e)s=Math.max(n.state.doc.lineAt(s).from,s-t),r=Math.min(n.state.doc.lineAt(r).to,r+t),i.length&&i[i.length-1].to>=s?i[i.length-1].to=r:i.push({from:s,to:r});return i}class Fg{constructor(t){const{regexp:e,decoration:i,decorate:s,boundary:r,maxLength:o=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,s)this.addMatch=(l,h,a,c)=>s(c,a,a+l[0].length,l,h);else if(typeof i=="function")this.addMatch=(l,h,a,c)=>{let u=i(l,h,a);u&&c(a,a+l[0].length,u)};else if(i)this.addMatch=(l,h,a,c)=>c(a,a+l[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=r,this.maxLength=o}createDeco(t){let e=new _e,i=e.add.bind(e);for(let{from:s,to:r}of Rg(t,this.maxLength))ql(t.state.doc,this.regexp,s,r,(o,l)=>this.addMatch(l,t,o,i));return e.finish()}updateDeco(t,e){let i=1e9,s=-1;return t.docChanged&&t.changes.iterChanges((r,o,l,h)=>{h>t.view.viewport.from&&l<t.view.viewport.to&&(i=Math.min(l,i),s=Math.max(h,s))}),t.viewportChanged||s-i>1e3?this.createDeco(t.view):s>-1?this.updateRange(t.view,e.map(t.changes),i,s):e}updateRange(t,e,i,s){for(let r of t.visibleRanges){let o=Math.max(r.from,i),l=Math.min(r.to,s);if(l>o){let h=t.state.doc.lineAt(o),a=h.to<l?t.state.doc.lineAt(l):h,c=Math.max(r.from,h.from),u=Math.min(r.to,a.to);if(this.boundary){for(;o>h.from;o--)if(this.boundary.test(h.text[o-1-h.from])){c=o;break}for(;l<a.to;l++)if(this.boundary.test(a.text[l-a.from])){u=l;break}}let f=[],g,p=(m,b,v)=>f.push(v.range(m,b));if(h==a)for(this.regexp.lastIndex=c-h.from;(g=this.regexp.exec(h.text))&&g.index<u-h.from;)this.addMatch(g,t,g.index+h.from,p);else ql(t.state.doc,this.regexp,c,u,(m,b)=>this.addMatch(b,t,m,p));e=e.update({filterFrom:c,filterTo:u,filter:(m,b)=>m<c||b>u,add:f})}}return e}}const Xr=/x/.unicode!=null?"gu":"g",Vg=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Xr),Ig={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _n=null;function Wg(){var n;if(_n==null&&typeof document<"u"&&document.body){let t=document.body.style;_n=((n=t.tabSize)!==null&&n!==void 0?n:t.MozTabSize)!=null}return _n||!1}const Ks=O.define({combine(n){let t=es(n,{render:null,specialChars:Vg,addSpecialChars:null});return(t.replaceTabs=!Wg())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,Xr)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Xr)),t}});function Cv(n={}){return[Ks.of(n),Hg()]}let Jl=null;function Hg(){return Jl||(Jl=dt.fromClass(class{constructor(n){this.view=n,this.decorations=I.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(Ks)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new Fg({regexp:n.specialChars,decoration:(t,e,i)=>{let{doc:s}=e.state,r=Oi(t[0],0);if(r==9){let o=s.lineAt(i),l=e.state.tabSize,h=ko(o.text,l,i-o.from);return I.replace({widget:new Ug((l-h%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=I.replace({widget:new $g(n,r)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let t=n.state.facet(Ks);n.startState.facet(Ks)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const jg="";function Kg(n){return n>=32?jg:n==10?"":String.fromCharCode(9216+n)}class $g extends Le{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=Kg(this.code),i=t.state.phrase("Control character")+" "+(Ig[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,e);if(s)return s;let r=document.createElement("span");return r.textContent=e,r.title=i,r.setAttribute("aria-label",i),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class Ug extends Le{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function Mv(){return Gg}const Xg=I.line({class:"cm-activeLine"}),Gg=dt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let t=-1,e=[];for(let i of n.state.selection.ranges){let s=n.lineBlockAt(i.head);s.from>t&&(e.push(Xg.range(s.from)),t=s.from)}return I.set(e)}},{decorations:n=>n.decorations});class qg extends Le{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?hi(t.firstChild):[];if(!e.length)return null;let i=window.getComputedStyle(t.parentNode),s=is(e[0],i.direction!="rtl"),r=parseInt(i.lineHeight);return s.bottom-s.top>r*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+r}:s}ignoreEvent(){return!1}}function Av(n){return dt.fromClass(class{constructor(t){this.view=t,this.placeholder=n?I.set([I.widget({widget:new qg(n),side:1}).range(0)]):I.none}get decorations(){return this.view.state.doc.length?I.none:this.placeholder}},{decorations:t=>t.decorations})}const Gr=2e3;function Jg(n,t,e){let i=Math.min(t.line,e.line),s=Math.max(t.line,e.line),r=[];if(t.off>Gr||e.off>Gr||t.col<0||e.col<0){let o=Math.min(t.off,e.off),l=Math.max(t.off,e.off);for(let h=i;h<=s;h++){let a=n.doc.line(h);a.length<=l&&r.push(D.range(a.from+o,a.to+l))}}else{let o=Math.min(t.col,e.col),l=Math.max(t.col,e.col);for(let h=i;h<=s;h++){let a=n.doc.line(h),c=Cr(a.text,o,n.tabSize,!0);if(c<0)r.push(D.cursor(a.to));else{let u=Cr(a.text,l,n.tabSize);r.push(D.range(a.from+c,a.from+u))}}}return r}function Yg(n,t){let e=n.coordsAtPos(n.viewport.from);return e?Math.round(Math.abs((e.left-t)/n.defaultCharacterWidth)):-1}function Yl(n,t){let e=n.posAtCoords({x:t.clientX,y:t.clientY},!1),i=n.state.doc.lineAt(e),s=e-i.from,r=s>Gr?-1:s==i.length?Yg(n,t.clientX):ko(i.text,n.state.tabSize,e-i.from);return{line:i.number,col:r,off:s}}function Zg(n,t){let e=Yl(n,t),i=n.state.selection;return e?{update(s){if(s.docChanged){let r=s.changes.mapPos(s.startState.doc.line(e.line).from),o=s.state.doc.lineAt(r);e={line:o.number,col:e.col,off:Math.min(e.off,o.length)},i=i.map(s.changes)}},get(s,r,o){let l=Yl(n,s);if(!l)return i;let h=Jg(n.state,e,l);return h.length?o?D.create(h.concat(i.ranges)):D.create(h):i}}:null}function Ev(n){let t=e=>e.altKey&&e.button==0;return B.mouseSelectionStyle.of((e,i)=>t(i)?Zg(e,i):null)}const Qg={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},tp={style:"cursor: crosshair"};function Tv(n={}){let[t,e]=Qg[n.key||"Alt"],i=dt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==t||e(s))},keyup(s){(s.keyCode==t||!e(s))&&this.set(!1)},mousemove(s){this.set(e(s))}}});return[i,B.contentAttributes.of(s=>{var r;return!((r=s.plugin(i))===null||r===void 0)&&r.isDown?tp:null})]}const xi="-10000px";class $c{constructor(t,e,i,s){this.facet=e,this.createTooltipView=i,this.removeTooltipView=s,this.input=t.state.facet(e),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=i(o,r))}update(t,e){var i;let s=t.state.facet(this.facet),r=s.filter(h=>h);if(s===this.input){for(let h of this.tooltipViews)h.update&&h.update(t);return!1}let o=[],l=e?[]:null;for(let h=0;h<r.length;h++){let a=r[h],c=-1;if(a){for(let u=0;u<this.tooltips.length;u++){let f=this.tooltips[u];f&&f.create==a.create&&(c=u)}if(c<0)o[h]=this.createTooltipView(a,h?o[h-1]:null),l&&(l[h]=!!a.above);else{let u=o[h]=this.tooltipViews[c];l&&(l[h]=e[c]),u.update&&u.update(t)}}}for(let h of this.tooltipViews)o.indexOf(h)<0&&(this.removeTooltipView(h),(i=h.destroy)===null||i===void 0||i.call(h));return e&&(l.forEach((h,a)=>e[a]=h),e.length=l.length),this.input=s,this.tooltips=r,this.tooltipViews=o,!0}}function ep(n){let{win:t}=n;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const Rn=O.define({combine:n=>{var t,e,i;return{position:T.ios?"absolute":((t=n.find(s=>s.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=n.find(s=>s.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((i=n.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||ep}}}),Zl=new WeakMap,No=dt.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=n.state.facet(Rn);this.position=t.position,this.parent=t.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new $c(n,Uc,(e,i)=>this.createTooltip(e,i),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(n,this.above);t&&this.observeIntersection();let e=t||n.geometryChanged,i=n.state.facet(Rn);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;e=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(n,t){let e=n.create(this.view),i=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",e.dom.appendChild(s)}return e.dom.style.position=this.position,e.dom.style.top=xi,e.dom.style.left="0px",this.container.insertBefore(e.dom,i),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var n,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(n=i.destroy)===null||n===void 0||n.call(i);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,t=1,e=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(T.gecko)e=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==xi&&r.style.left=="0px"){let o=r.getBoundingClientRect();e=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(e||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(n=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:t}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),s=Do(this.view);return{visible:{left:i.left+s.left,top:i.top+s.top,right:i.right-s.right,bottom:i.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(Rn).tooltipSpace(this.view),scaleX:n,scaleY:t,makeAbsolute:e}}writeMeasure(n){var t;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:e,space:i,scaleX:s,scaleY:r}=n,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let h=this.manager.tooltips[l],a=this.manager.tooltipViews[l],{dom:c}=a,u=n.pos[l],f=n.size[l];if(!u||u.bottom<=Math.max(e.top,i.top)||u.top>=Math.min(e.bottom,i.bottom)||u.right<Math.max(e.left,i.left)-.1||u.left>Math.min(e.right,i.right)+.1){c.style.top=xi;continue}let g=h.arrow?a.dom.querySelector(".cm-tooltip-arrow"):null,p=g?7:0,m=f.right-f.left,b=(t=Zl.get(a))!==null&&t!==void 0?t:f.bottom-f.top,v=a.offset||sp,w=this.view.textDirection==it.LTR,x=f.width>i.right-i.left?w?i.left:i.right-f.width:w?Math.max(i.left,Math.min(u.left-(g?14:0)+v.x,i.right-m)):Math.min(Math.max(i.left,u.left-m+(g?14:0)-v.x),i.right-m),y=this.above[l];!h.strictSide&&(y?u.top-b-p-v.y<i.top:u.bottom+b+p+v.y>i.bottom)&&y==i.bottom-u.bottom>u.top-i.top&&(y=this.above[l]=!y);let k=(y?u.top-i.top:i.bottom-u.bottom)-p;if(k<b&&a.resize!==!1){if(k<this.view.defaultLineHeight){c.style.top=xi;continue}Zl.set(a,b),c.style.height=(b=k)/r+"px"}else c.style.height&&(c.style.height="");let S=y?u.top-b-p-v.y:u.bottom+p+v.y,C=x+m;if(a.overlap!==!0)for(let L of o)L.left<C&&L.right>x&&L.top<S+b&&L.bottom>S&&(S=y?L.top-b-2-p:L.bottom+p+2);if(this.position=="absolute"?(c.style.top=(S-n.parent.top)/r+"px",c.style.left=(x-n.parent.left)/s+"px"):(c.style.top=S/r+"px",c.style.left=x/s+"px"),g){let L=u.left+(w?v.x:-v.x)-(x+14-7);g.style.left=L/s+"px"}a.overlap!==!0&&o.push({left:x,top:S,right:C,bottom:S+b}),c.classList.toggle("cm-tooltip-above",y),c.classList.toggle("cm-tooltip-below",!y),a.positioned&&a.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=xi}},{eventObservers:{scroll(){this.maybeMeasure()}}}),ip=B.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),sp={x:0,y:0},Uc=O.define({enables:[No,ip]}),nn=O.define({combine:n=>n.reduce((t,e)=>t.concat(e),[])});class vn{static create(t){return new vn(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new $c(t,nn,(e,i)=>this.createHostedView(e,i),e=>e.dom.remove())}createHostedView(t,e){let i=t.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}passProp(t){let e;for(let i of this.manager.tooltipViews){let s=i[t];if(s!==void 0){if(e===void 0)e=s;else if(e!==s)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const np=Uc.compute([nn],n=>{let t=n.facet(nn);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var i;return(i=e.end)!==null&&i!==void 0?i:e.pos})),create:vn.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class rp{constructor(t,e,i,s,r){this.view=t,this.source=e,this.field=i,this.setHover=s,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,i=t.docView.nearest(e.target);if(!i)return;let s,r=1;if(i instanceof ye)s=i.posAtStart;else{if(s=t.posAtCoords(e),s==null)return;let l=t.coordsAtPos(s);if(!l||e.y<l.top||e.y>l.bottom||e.x<l.left-t.defaultCharacterWidth||e.x>l.right+t.defaultCharacterWidth)return;let h=t.bidiSpans(t.state.doc.lineAt(s)).find(c=>c.from<=s&&c.to>=s),a=h&&h.dir==it.RTL?-1:1;r=e.x<l.left?-a:a}let o=this.source(t,s,r);if(o?.then){let l=this.pending={pos:s};o.then(h=>{this.pending==l&&(this.pending=null,h&&!(Array.isArray(h)&&!h.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(h)?h:[h])}))},h=>Rt(t.state,h,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let t=this.view.plugin(No),e=t?t.manager.tooltips.findIndex(i=>i.create==vn.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,i;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:r}=this;if(s.length&&r&&!op(r.dom,t)||this.pending){let{pos:o}=s[0]||this.pending,l=(i=(e=s[0])===null||e===void 0?void 0:e.end)!==null&&i!==void 0?i:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!lp(this.view,o,l,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:i}=this;i&&i.dom.contains(t.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=i=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const xs=4;function op(n,t){let{left:e,right:i,top:s,bottom:r}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();s=Math.min(l.top,s),r=Math.max(l.bottom,r)}return t.clientX>=e-xs&&t.clientX<=i+xs&&t.clientY>=s-xs&&t.clientY<=r+xs}function lp(n,t,e,i,s,r){let o=n.scrollDOM.getBoundingClientRect(),l=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>i||o.right<i||o.top>s||Math.min(o.bottom,l)<s)return!1;let h=n.posAtCoords({x:i,y:s},!1);return h>=t&&h<=e}function Dv(n,t={}){let e=tt.define(),i=Ht.define({create(){return[]},update(s,r){if(s.length&&(t.hideOnChange&&(r.docChanged||r.selection)?s=[]:t.hideOn&&(s=s.filter(o=>!t.hideOn(r,o))),r.docChanged)){let o=[];for(let l of s){let h=r.changes.mapPos(l.pos,-1,At.TrackDel);if(h!=null){let a=Object.assign(Object.create(null),l);a.pos=h,a.end!=null&&(a.end=r.changes.mapPos(a.end)),o.push(a)}}s=o}for(let o of r.effects)o.is(e)&&(s=o.value),o.is(hp)&&(s=[]);return s},provide:s=>nn.from(s)});return{active:i,extension:[i,dt.define(s=>new rp(s,n,i,e,t.hoverTime||300)),np]}}function Lv(n,t){let e=n.plugin(No);if(!e)return null;let i=e.manager.tooltips.indexOf(t);return i<0?null:e.manager.tooltipViews[i]}const hp=tt.define(),Ql=O.define({combine(n){let t,e;for(let i of n)t=t||i.topContainer,e=e||i.bottomContainer;return{topContainer:t,bottomContainer:e}}});function Ov(n,t){let e=n.plugin(Xc),i=e?e.specs.indexOf(t):-1;return i>-1?e.panels[i]:null}const Xc=dt.fromClass(class{constructor(n){this.input=n.state.facet(eh),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(n));let t=n.state.facet(Ql);this.top=new ks(n,!0,t.topContainer),this.bottom=new ks(n,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(n){let t=n.state.facet(Ql);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new ks(n.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new ks(n.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=n.state.facet(eh);if(e!=this.input){let i=e.filter(h=>h),s=[],r=[],o=[],l=[];for(let h of i){let a=this.specs.indexOf(h),c;a<0?(c=h(n.view),l.push(c)):(c=this.panels[a],c.update&&c.update(n)),s.push(c),(c.top?r:o).push(c)}this.specs=i,this.panels=s,this.top.sync(r),this.bottom.sync(o);for(let h of l)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>B.scrollMargins.of(t=>{let e=t.plugin(n);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class ks{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=th(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=th(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function th(n){let t=n.nextSibling;return n.remove(),t}const eh=O.define({enables:Xc});class ce extends li{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}ce.prototype.elementClass="";ce.prototype.toDOM=void 0;ce.prototype.mapMode=At.TrackBefore;ce.prototype.startSide=ce.prototype.endSide=-1;ce.prototype.point=!0;const $s=O.define(),ap=O.define(),cp={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>j.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Bi=O.define();function up(n){return[Gc(),Bi.of(Object.assign(Object.assign({},cp),n))]}const ih=O.define({combine:n=>n.some(t=>t)});function Gc(n){return[fp]}const fp=dt.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(Bi).map(t=>new nh(n,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!n.state.facet(ih),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let t=this.prevViewport,e=n.view.viewport,i=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(i<(e.to-e.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(ih)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let t=this.dom.nextSibling;n&&this.dom.remove();let e=j.iter(this.view.state.facet($s),this.view.viewport.from),i=[],s=this.gutters.map(r=>new dp(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(r.type)){let o=!0;for(let l of r.type)if(l.type==xt.Text&&o){qr(e,i,l.from);for(let h of s)h.line(this.view,l,i);o=!1}else if(l.widget)for(let h of s)h.widget(this.view,l)}else if(r.type==xt.Text){qr(e,i,r.from);for(let o of s)o.line(this.view,r,i)}else if(r.widget)for(let o of s)o.widget(this.view,r);for(let r of s)r.finish();n&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(n){let t=n.startState.facet(Bi),e=n.state.facet(Bi),i=n.docChanged||n.heightChanged||n.viewportChanged||!j.eq(n.startState.facet($s),n.state.facet($s),n.view.viewport.from,n.view.viewport.to);if(t==e)for(let s of this.gutters)s.update(n)&&(i=!0);else{i=!0;let s=[];for(let r of e){let o=t.indexOf(r);o<0?s.push(new nh(this.view,r)):(this.gutters[o].update(n),s.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),s.indexOf(r)<0&&r.destroy();for(let r of s)this.dom.appendChild(r.dom);this.gutters=s}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>B.scrollMargins.of(t=>{let e=t.plugin(n);return!e||e.gutters.length==0||!e.fixed?null:t.textDirection==it.LTR?{left:e.dom.offsetWidth*t.scaleX}:{right:e.dom.offsetWidth*t.scaleX}})});function sh(n){return Array.isArray(n)?n:[n]}function qr(n,t,e){for(;n.value&&n.from<=e;)n.from==e&&t.push(n.value),n.next()}class dp{constructor(t,e,i){this.gutter=t,this.height=i,this.i=0,this.cursor=j.iter(t.markers,e.from)}addElement(t,e,i){let{gutter:s}=this,r=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==s.elements.length){let l=new qc(t,o,r,i);s.elements.push(l),s.dom.appendChild(l.dom)}else s.elements[this.i].update(t,o,r,i);this.height=e.bottom,this.i++}line(t,e,i){let s=[];qr(this.cursor,s,e.from),i.length&&(s=s.concat(i));let r=this.gutter.config.lineMarker(t,e,s);r&&s.unshift(r);let o=this.gutter;s.length==0&&!o.config.renderEmptyElements||this.addElement(t,e,s)}widget(t,e){let i=this.gutter.config.widgetMarker(t,e.widget,e),s=i?[i]:null;for(let r of t.state.facet(ap)){let o=r(t,e.widget,e);o&&(s||(s=[])).push(o)}s&&this.addElement(t,e,s)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class nh{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,s=>{let r=s.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let h=r.getBoundingClientRect();o=(h.top+h.bottom)/2}else o=s.clientY;let l=t.lineBlockAtHeight(o-t.documentTop);e.domEventHandlers[i](t,l,s)&&s.preventDefault()});this.markers=sh(e.markers(t)),e.initialSpacer&&(this.spacer=new qc(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=sh(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],t);s!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[s])}let i=t.view.viewport;return!j.eq(this.markers,e,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class qc{constructor(t,e,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,s)}update(t,e,i,s){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),gp(this.markers,s)||this.setMarkers(t,s)}setMarkers(t,e){let i="cm-gutterElement",s=this.dom.firstChild;for(let r=0,o=0;;){let l=o,h=r<e.length?e[r++]:null,a=!1;if(h){let c=h.elementClass;c&&(i+=" "+c);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(h)){l=u,a=!0;break}}else l=this.markers.length;for(;o<l;){let c=this.markers[o++];if(c.toDOM){c.destroy(s);let u=s.nextSibling;s.remove(),s=u}}if(!h)break;h.toDOM&&(a?s=s.nextSibling:this.dom.insertBefore(h.toDOM(t),s)),a&&o++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}function gp(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].compare(t[e]))return!1;return!0}const pp=O.define(),mp=O.define(),Ge=O.define({combine(n){return es(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let s in e){let r=i[s],o=e[s];i[s]=r?(l,h,a)=>r(l,h,a)||o(l,h,a):o}return i}})}});class Fn extends ce{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Vn(n,t){return n.state.facet(Ge).formatNumber(t,n.state)}const bp=Bi.compute([Ge],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(pp)},lineMarker(t,e,i){return i.some(s=>s.toDOM)?null:new Fn(Vn(t,t.state.doc.lineAt(e.from).number))},widgetMarker:(t,e,i)=>{for(let s of t.state.facet(mp)){let r=s(t,e,i);if(r)return r}return null},lineMarkerChange:t=>t.startState.facet(Ge)!=t.state.facet(Ge),initialSpacer(t){return new Fn(Vn(t,rh(t.state.doc.lines)))},updateSpacer(t,e){let i=Vn(e.view,rh(e.view.state.doc.lines));return i==t.number?t:new Fn(i)},domEventHandlers:n.facet(Ge).domEventHandlers}));function Pv(n={}){return[Ge.of(n),Gc(),bp]}function rh(n){let t=9;for(;t<n;)t=t*10+9;return t}const vp=new class extends ce{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},wp=$s.compute(["selection"],n=>{let t=[],e=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.head).from;s>e&&(e=s,t.push(vp.range(s)))}return j.of(t)});function Nv(){return wp}const yp=1024;let xp=0;class zt{constructor(t,e){this.from=t,this.to=e}}class H{constructor(t={}){this.id=xp++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Dt.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}}H.closedBy=new H({deserialize:n=>n.split(" ")});H.openedBy=new H({deserialize:n=>n.split(" ")});H.group=new H({deserialize:n=>n.split(" ")});H.isolate=new H({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});H.contextHash=new H({perNode:!0});H.lookAhead=new H({perNode:!0});H.mounted=new H({perNode:!0});class Xi{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}static get(t){return t&&t.props&&t.props[H.mounted.id]}}const kp=Object.create(null);class Dt{constructor(t,e,i,s=0){this.name=t,this.props=e,this.id=i,this.flags=s}static define(t){let e=t.props&&t.props.length?Object.create(null):kp,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),s=new Dt(t.name||"",e,t.id,i);if(t.props){for(let r of t.props)if(Array.isArray(r)||(r=r(s)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[r[0].id]=r[1]}}return s}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(H.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let s of i.split(" "))e[s]=t[i];return i=>{for(let s=i.prop(H.group),r=-1;r<(s?s.length:0);r++){let o=e[r<0?i.name:s[r]];if(o)return o}}}}Dt.none=new Dt("",Object.create(null),0,8);class Jc{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let s=null;for(let r of t){let o=r(i);o&&(s||(s=Object.assign({},i.props)),s[o[0].id]=o[1])}e.push(s?new Dt(i.name,s,i.id,i.flags):i)}return new Jc(e)}}const Ss=new WeakMap,oh=new WeakMap;var et;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(et||(et={}));class at{constructor(t,e,i,s,r){if(this.type=t,this.children=e,this.positions=i,this.length=s,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,l]of r)this.props[typeof o=="number"?o:o.id]=l}}toString(){let t=Xi.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let s=i.toString();s&&(e&&(e+=","),e+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new rn(this.topNode,t)}cursorAt(t,e=0,i=0){let s=Ss.get(this)||this.topNode,r=new rn(s);return r.moveTo(t,e),Ss.set(this,r._tree),r}get topNode(){return new Et(this,0,0,null)}resolve(t,e=0){let i=Gi(Ss.get(this)||this.topNode,t,e,!1);return Ss.set(this,i),i}resolveInner(t,e=0){let i=Gi(oh.get(this)||this.topNode,t,e,!0);return oh.set(this,i),i}resolveStack(t,e=0){return Mp(this,t,e)}iterate(t){let{enter:e,leave:i,from:s=0,to:r=this.length}=t,o=t.mode||0,l=(o&et.IncludeAnonymous)>0;for(let h=this.cursor(o|et.IncludeAnonymous);;){let a=!1;if(h.from<=r&&h.to>=s&&(!l&&h.type.isAnonymous||e(h)!==!1)){if(h.firstChild())continue;a=!0}for(;a&&i&&(l||!h.type.isAnonymous)&&i(h),!h.nextSibling();){if(!h.parent())return;a=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:_o(Dt.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,s)=>new at(this.type,e,i,s,this.propValues),t.makeTree||((e,i,s)=>new at(Dt.none,e,i,s)))}static build(t){return Ap(t)}}at.empty=new at(Dt.none,[],[],0);class zo{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new zo(this.buffer,this.index)}}class Ee{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return Dt.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],s=this.set.types[e],r=s.name;if(/\W/.test(r)&&!s.isError&&(r=JSON.stringify(r)),t+=4,i==t)return r;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,i,s,r){let{buffer:o}=this,l=-1;for(let h=t;h!=e&&!(Yc(r,s,o[h+1],o[h+2])&&(l=h,i>0));h=o[h+3]);return l}slice(t,e,i){let s=this.buffer,r=new Uint16Array(e-t),o=0;for(let l=t,h=0;l<e;){r[h++]=s[l++],r[h++]=s[l++]-i;let a=r[h++]=s[l++]-i;r[h++]=s[l++]-t,o=Math.max(o,a)}return new Ee(r,o,this.set)}}function Yc(n,t,e,i){switch(n){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function Gi(n,t,e,i){for(var s;n.from==n.to||(e<1?n.from>=t:n.from>t)||(e>-1?n.to<=t:n.to<t);){let o=!i&&n instanceof Et&&n.index<0?null:n.parent;if(!o)return n;n=o}let r=i?0:et.IgnoreOverlays;if(i)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof Et&&o.index<0&&((s=l.enter(t,e,r))===null||s===void 0?void 0:s.from)!=o.from&&(n=l);for(;;){let o=n.enter(t,e,r);if(!o)return n;n=o}}class Zc{cursor(t=0){return new rn(this,t)}getChild(t,e=null,i=null){let s=lh(this,t,e,i);return s.length?s[0]:null}getChildren(t,e=null,i=null){return lh(this,t,e,i)}resolve(t,e=0){return Gi(this,t,e,!1)}resolveInner(t,e=0){return Gi(this,t,e,!0)}matchContext(t){return Jr(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),i=this;for(;e;){let s=e.lastChild;if(!s||s.to!=e.to)break;s.type.isError&&s.from==s.to?(i=e,e=s.prevSibling):e=s}return i}get node(){return this}get next(){return this.parent}}class Et extends Zc{constructor(t,e,i,s){super(),this._tree=t,this.from=e,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,s,r=0){for(let o=this;;){for(let{children:l,positions:h}=o._tree,a=e>0?l.length:-1;t!=a;t+=e){let c=l[t],u=h[t]+o.from;if(Yc(s,i,u,u+c.length)){if(c instanceof Ee){if(r&et.ExcludeBuffers)continue;let f=c.findChild(0,c.buffer.length,e,i-u,s);if(f>-1)return new ke(new Sp(o,c,t,u),null,f)}else if(r&et.IncludeAnonymous||!c.type.isAnonymous||Bo(c)){let f;if(!(r&et.IgnoreMounts)&&(f=Xi.get(c))&&!f.overlay)return new Et(f.tree,u,t,o);let g=new Et(c,u,t,o);return r&et.IncludeAnonymous||!g.type.isAnonymous?g:g.nextChild(e<0?c.children.length-1:0,e,i,s)}}}if(r&et.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let s;if(!(i&et.IgnoreOverlays)&&(s=Xi.get(this._tree))&&s.overlay){let r=t-this.from;for(let{from:o,to:l}of s.overlay)if((e>0?o<=r:o<r)&&(e<0?l>=r:l>r))return new Et(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function lh(n,t,e,i){let s=n.cursor(),r=[];if(!s.firstChild())return r;if(e!=null){for(let o=!1;!o;)if(o=s.type.is(e),!s.nextSibling())return r}for(;;){if(i!=null&&s.type.is(i))return r;if(s.type.is(t)&&r.push(s.node),!s.nextSibling())return i==null?r:[]}}function Jr(n,t,e=t.length-1){for(let i=n;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}class Sp{constructor(t,e,i,s){this.parent=t,this.buffer=e,this.index=i,this.start=s}}class ke extends Zc{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){super(),this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new ke(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&et.ExcludeBuffers)return null;let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new ke(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new ke(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new ke(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,s=this.index+4,r=i.buffer[this.index+3];if(r>s){let o=i.buffer[this.index+1];t.push(i.slice(s,r,o)),e.push(0)}return new at(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Qc(n){if(!n.length)return null;let t=0,e=n[0];for(let r=1;r<n.length;r++){let o=n[r];(o.from>e.from||o.to<e.to)&&(e=o,t=r)}let i=e instanceof Et&&e.index<0?null:e.parent,s=n.slice();return i?s[t]=i:s.splice(t,1),new Cp(s,e)}class Cp{constructor(t,e){this.heads=t,this.node=e}get next(){return Qc(this.heads)}}function Mp(n,t,e){let i=n.resolveInner(t,e),s=null;for(let r=i instanceof Et?i:i.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(s||(s=[i])).push(o.resolve(t,e)),r=o}else{let o=Xi.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=t&&o.overlay[o.overlay.length-1].to>=t){let l=new Et(o.tree,o.overlay[0].from+r.from,-1,r);(s||(s=[i])).push(Gi(l,t,e,!1))}}return s?Qc(s):i}class rn{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Et)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:s}=this.buffer;return this.type=e||s.set.types[s.buffer[t]],this.from=i+s.buffer[t+1],this.to=i+s.buffer[t+2],!0}yield(t){return t?t instanceof Et?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:s}=this.buffer,r=s.findChild(this.index+4,s.buffer[this.index+3],t,e-this.buffer.start,i);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&et.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&et.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&et.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(e.findChild(s,this.index,-1,0,4))}else{let s=e.buffer[this.index+3];if(s<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:s}=this;if(s){if(t>0){if(this.index<s.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(s.buffer.buffer[r+3]<this.index)return!1;({index:e,parent:i}=s)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let r=e+t,o=t<0?-1:i._tree.children.length;r!=o;r+=t){let l=i._tree.children[r];if(this.mode&et.IncludeAnonymous||l instanceof Ee||!l.type.isAnonymous||Bo(l))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let s=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==s){if(s==this.index)return o;e=o,i=r+1;break t}s=this.stack[--r]}for(let s=i;s<this.stack.length;s++)e=new ke(this.buffer,e,this.stack[s]);return this.bufferNode=new ke(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let s=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&e&&e(this),s=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,s=!0}}}matchContext(t){if(!this.buffer)return Jr(this.node.parent,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let s=t.length-1,r=this.stack.length-1;s>=0;r--){if(r<0)return Jr(this._tree,t,s);let o=i[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[s]&&t[s]!=o.name)return!1;s--}}return!0}}function Bo(n){return n.children.some(t=>t instanceof Ee||!t.type.isAnonymous||Bo(t))}function Ap(n){var t;let{buffer:e,nodeSet:i,maxBufferLength:s=yp,reused:r=[],minRepeatType:o=i.types.length}=n,l=Array.isArray(e)?new zo(e,e.length):e,h=i.types,a=0,c=0;function u(k,S,C,L,N,F){let{id:z,start:A,end:V,size:_}=l,W=c,X=a;for(;_<0;)if(l.next(),_==-1){let J=r[z];C.push(J),L.push(A-k);return}else if(_==-3){a=z;return}else if(_==-4){c=z;return}else throw new RangeError(`Unrecognized record size: ${_}`);let nt=h[z],st,U,rt=A-k;if(V-A<=s&&(U=b(l.pos-S,N))){let J=new Uint16Array(U.size-U.skip),Ct=l.pos-U.size,Ot=J.length;for(;l.pos>Ct;)Ot=v(U.start,J,Ot);st=new Ee(J,V-U.start,i),rt=U.start-k}else{let J=l.pos-_;l.next();let Ct=[],Ot=[],ee=z>=o?z:-1,ue=0,$e=V;for(;l.pos>J;)ee>=0&&l.id==ee&&l.size>=0?(l.end<=$e-s&&(p(Ct,Ot,A,ue,l.end,$e,ee,W,X),ue=Ct.length,$e=l.end),l.next()):F>2500?f(A,J,Ct,Ot):u(A,J,Ct,Ot,ee,F+1);if(ee>=0&&ue>0&&ue<Ct.length&&p(Ct,Ot,A,ue,A,$e,ee,W,X),Ct.reverse(),Ot.reverse(),ee>-1&&ue>0){let P=g(nt,X);st=_o(nt,Ct,Ot,0,Ct.length,0,V-A,P,P)}else st=m(nt,Ct,Ot,V-A,W-V,X)}C.push(st),L.push(rt)}function f(k,S,C,L){let N=[],F=0,z=-1;for(;l.pos>S;){let{id:A,start:V,end:_,size:W}=l;if(W>4)l.next();else{if(z>-1&&V<z)break;z<0&&(z=_-s),N.push(A,V,_),F++,l.next()}}if(F){let A=new Uint16Array(F*4),V=N[N.length-2];for(let _=N.length-3,W=0;_>=0;_-=3)A[W++]=N[_],A[W++]=N[_+1]-V,A[W++]=N[_+2]-V,A[W++]=W;C.push(new Ee(A,N[2]-V,i)),L.push(V-k)}}function g(k,S){return(C,L,N)=>{let F=0,z=C.length-1,A,V;if(z>=0&&(A=C[z])instanceof at){if(!z&&A.type==k&&A.length==N)return A;(V=A.prop(H.lookAhead))&&(F=L[z]+A.length+V)}return m(k,C,L,N,F,S)}}function p(k,S,C,L,N,F,z,A,V){let _=[],W=[];for(;k.length>L;)_.push(k.pop()),W.push(S.pop()+C-N);k.push(m(i.types[z],_,W,F-N,A-F,V)),S.push(N-C)}function m(k,S,C,L,N,F,z){if(F){let A=[H.contextHash,F];z=z?[A].concat(z):[A]}if(N>25){let A=[H.lookAhead,N];z=z?[A].concat(z):[A]}return new at(k,S,C,L,z)}function b(k,S){let C=l.fork(),L=0,N=0,F=0,z=C.end-s,A={size:0,start:0,skip:0};t:for(let V=C.pos-k;C.pos>V;){let _=C.size;if(C.id==S&&_>=0){A.size=L,A.start=N,A.skip=F,F+=4,L+=4,C.next();continue}let W=C.pos-_;if(_<0||W<V||C.start<z)break;let X=C.id>=o?4:0,nt=C.start;for(C.next();C.pos>W;){if(C.size<0)if(C.size==-3)X+=4;else break t;else C.id>=o&&(X+=4);C.next()}N=nt,L+=_,F+=X}return(S<0||L==k)&&(A.size=L,A.start=N,A.skip=F),A.size>4?A:void 0}function v(k,S,C){let{id:L,start:N,end:F,size:z}=l;if(l.next(),z>=0&&L<o){let A=C;if(z>4){let V=l.pos-(z-4);for(;l.pos>V;)C=v(k,S,C)}S[--C]=A,S[--C]=F-k,S[--C]=N-k,S[--C]=L}else z==-3?a=L:z==-4&&(c=L);return C}let w=[],x=[];for(;l.pos>0;)u(n.start||0,n.bufferStart||0,w,x,-1,0);let y=(t=n.length)!==null&&t!==void 0?t:w.length?x[0]+w[0].length:0;return new at(h[n.topID],w.reverse(),x.reverse(),y)}const hh=new WeakMap;function Us(n,t){if(!n.isAnonymous||t instanceof Ee||t.type!=n)return 1;let e=hh.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=n||!(i instanceof at)){e=1;break}e+=Us(n,i)}hh.set(t,e)}return e}function _o(n,t,e,i,s,r,o,l,h){let a=0;for(let p=i;p<s;p++)a+=Us(n,t[p]);let c=Math.ceil(a*1.5/8),u=[],f=[];function g(p,m,b,v,w){for(let x=b;x<v;){let y=x,k=m[x],S=Us(n,p[x]);for(x++;x<v;x++){let C=Us(n,p[x]);if(S+C>=c)break;S+=C}if(x==y+1){if(S>c){let C=p[y];g(C.children,C.positions,0,C.children.length,m[y]+w);continue}u.push(p[y])}else{let C=m[x-1]+p[x-1].length-k;u.push(_o(n,p,m,y,x,k,C,null,h))}f.push(k+w-r)}}return g(t,e,i,s,0),(l||h)(u,f,o)}class he{constructor(t,e,i,s,r=!1,o=!1){this.from=t,this.to=e,this.tree=i,this.offset=s,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let s=[new he(0,t.length,t,0,!1,i)];for(let r of e)r.to>t.length&&s.push(r);return s}static applyChanges(t,e,i=128){if(!e.length)return t;let s=[],r=1,o=t.length?t[0]:null;for(let l=0,h=0,a=0;;l++){let c=l<e.length?e[l]:null,u=c?c.fromA:1e9;if(u-h>=i)for(;o&&o.from<u;){let f=o;if(h>=f.from||u<=f.to||a){let g=Math.max(f.from,h)-a,p=Math.min(f.to,u)-a;f=g>=p?null:new he(g,p,f.tree,f.offset+a,l>0,!!c)}if(f&&s.push(f),o.to>u)break;o=r<t.length?t[r++]:null}if(!c)break;h=c.toA,a=c.toA-c.toB}return s}}class Ep{startParse(t,e,i){return typeof t=="string"&&(t=new Tp(t)),i=i?i.length?i.map(s=>new zt(s.from,s.to)):[new zt(0,0)]:[new zt(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let s=this.startParse(t,e,i);for(;;){let r=s.advance();if(r)return r}}}class Tp{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}function zv(n){return(t,e,i,s)=>new Lp(t,n,e,i,s)}class ah{constructor(t,e,i,s,r){this.parser=t,this.parse=e,this.overlay=i,this.target=s,this.from=r}}function ch(n){if(!n.length||n.some(t=>t.from>=t.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(n))}class Dp{constructor(t,e,i,s,r,o,l){this.parser=t,this.predicate=e,this.mounts=i,this.index=s,this.start=r,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}}const Yr=new H({perNode:!0});class Lp{constructor(t,e,i,s,r){this.nest=e,this.input=i,this.fragments=s,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let s of this.inner)s.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new at(i.type,i.children,i.positions,i.length,i.propValues.concat([[Yr,this.stoppedAt]]))),i}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[H.mounted.id]=new Xi(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new Np(this.fragments),e=null,i=null,s=new rn(new Et(this.baseTree,this.ranges[0].from,0,null),et.IncludeAnonymous|et.IgnoreMounts);t:for(let r,o;;){let l=!0,h;if(this.stoppedAt!=null&&s.from>=this.stoppedAt)l=!1;else if(t.hasNode(s)){if(e){let a=e.mounts.find(c=>c.frag.from<=s.from&&c.frag.to>=s.to&&c.mount.overlay);if(a)for(let c of a.mount.overlay){let u=c.from+a.pos,f=c.to+a.pos;u>=s.from&&f<=s.to&&!e.ranges.some(g=>g.from<f&&g.to>u)&&e.ranges.push({from:u,to:f})}}l=!1}else if(i&&(o=Op(i.ranges,s.from,s.to)))l=o!=2;else if(!s.type.isAnonymous&&(r=this.nest(s,this.input))&&(s.from<s.to||!r.overlay)){s.tree||Pp(s);let a=t.findMounts(s.from,r.parser);if(typeof r.overlay=="function")e=new Dp(r.parser,r.overlay,a,this.inner.length,s.from,s.tree,e);else{let c=dh(this.ranges,r.overlay||(s.from<s.to?[new zt(s.from,s.to)]:[]));c.length&&ch(c),(c.length||!r.overlay)&&this.inner.push(new ah(r.parser,c.length?r.parser.startParse(this.input,gh(a,c),c):r.parser.startParse(""),r.overlay?r.overlay.map(u=>new zt(u.from-s.from,u.to-s.from)):null,s.tree,c.length?c[0].from:s.from)),r.overlay?c.length&&(i={ranges:c,depth:0,prev:i}):l=!1}}else if(e&&(h=e.predicate(s))&&(h===!0&&(h=new zt(s.from,s.to)),h.from<h.to)){let a=e.ranges.length-1;a>=0&&e.ranges[a].to==h.from?e.ranges[a]={from:e.ranges[a].from,to:h.to}:e.ranges.push(h)}if(l&&s.firstChild())e&&e.depth++,i&&i.depth++;else for(;!s.nextSibling();){if(!s.parent())break t;if(e&&!--e.depth){let a=dh(this.ranges,e.ranges);a.length&&(ch(a),this.inner.splice(e.index,0,new ah(e.parser,e.parser.startParse(this.input,gh(e.mounts,a),a),e.ranges.map(c=>new zt(c.from-e.start,c.to-e.start)),e.target,a[0].from))),e=e.prev}i&&!--i.depth&&(i=i.prev)}}}}function Op(n,t,e){for(let i of n){if(i.from>=e)break;if(i.to>t)return i.from<=t&&i.to>=e?2:1}return 0}function uh(n,t,e,i,s,r){if(t<e){let o=n.buffer[t+1];i.push(n.slice(t,e,o)),s.push(o-r)}}function Pp(n){let{node:t}=n,e=[],i=t.context.buffer;do e.push(n.index),n.parent();while(!n.tree);let s=n.tree,r=s.children.indexOf(i),o=s.children[r],l=o.buffer,h=[r];function a(c,u,f,g,p,m){let b=e[m],v=[],w=[];uh(o,c,b,v,w,g);let x=l[b+1],y=l[b+2];h.push(v.length);let k=m?a(b+4,l[b+3],o.set.types[l[b]],x,y-x,m-1):t.toTree();return v.push(k),w.push(x-g),uh(o,l[b+3],u,v,w,g),new at(f,v,w,p)}s.children[r]=a(0,l.length,Dt.none,0,o.length,e.length-1);for(let c of h){let u=n.tree.children[c],f=n.tree.positions[c];n.yield(new Et(u,f+n.from,c,n._tree))}}class fh{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(et.IncludeAnonymous|et.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,et.IgnoreOverlays|et.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(e.children.length&&e.positions[0]==0&&e.children[0]instanceof at)e=e.children[0];else break}return!1}}class Np{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=(e=i.tree.prop(Yr))!==null&&e!==void 0?e:i.to,this.inner=new fh(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=(t=e.tree.prop(Yr))!==null&&t!==void 0?t:e.to,this.inner=new fh(e.tree,-e.offset)}}findMounts(t,e){var i;let s=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let r=this.inner.cursor.node;r;r=r.parent){let o=(i=r.tree)===null||i===void 0?void 0:i.prop(H.mounted);if(o&&o.parser==e)for(let l=this.fragI;l<this.fragments.length;l++){let h=this.fragments[l];if(h.from>=r.to)break;h.tree==this.curFrag.tree&&s.push({frag:h,pos:r.from-h.offset,mount:o})}}}return s}}function dh(n,t){let e=null,i=t;for(let s=1,r=0;s<n.length;s++){let o=n[s-1].to,l=n[s].from;for(;r<i.length;r++){let h=i[r];if(h.from>=l)break;h.to<=o||(e||(i=e=t.slice()),h.from<o?(e[r]=new zt(h.from,o),h.to>l&&e.splice(r+1,0,new zt(l,h.to))):h.to>l?e[r--]=new zt(l,h.to):e.splice(r--,1))}}return i}function zp(n,t,e,i){let s=0,r=0,o=!1,l=!1,h=-1e9,a=[];for(;;){let c=s==n.length?1e9:o?n[s].to:n[s].from,u=r==t.length?1e9:l?t[r].to:t[r].from;if(o!=l){let f=Math.max(h,e),g=Math.min(c,u,i);f<g&&a.push(new zt(f,g))}if(h=Math.min(c,u),h==1e9)break;c==h&&(o?(o=!1,s++):o=!0),u==h&&(l?(l=!1,r++):l=!0)}return a}function gh(n,t){let e=[];for(let{pos:i,mount:s,frag:r}of n){let o=i+(s.overlay?s.overlay[0].from:0),l=o+s.tree.length,h=Math.max(r.from,o),a=Math.min(r.to,l);if(s.overlay){let c=s.overlay.map(f=>new zt(f.from+i,f.to+i)),u=zp(t,c,h,a);for(let f=0,g=h;;f++){let p=f==u.length,m=p?a:u[f].from;if(m>g&&e.push(new he(g,m,s.tree,-o,r.from>=g||r.openStart,r.to<=m||r.openEnd)),p)break;g=u[f].to}}else e.push(new he(h,a,s.tree,-o,r.from>=o||r.openStart,r.to<=l||r.openEnd))}return e}let Bp=0;class Nt{constructor(t,e,i,s){this.name=t,this.set=e,this.base=i,this.modified=s,this.id=Bp++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let i=typeof t=="string"?t:"?";if(t instanceof Nt&&(e=t),e?.base)throw new Error("Can not derive from a modified tag");let s=new Nt(i,[],null,[]);if(s.set.push(s),e)for(let r of e.set)s.set.push(r);return s}static defineModifier(t){let e=new on(t);return i=>i.modified.indexOf(e)>-1?i:on.get(i.base||i,i.modified.concat(e).sort((s,r)=>s.id-r.id))}}let _p=0;class on{constructor(t){this.name=t,this.instances=[],this.id=_p++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(l=>l.base==t&&Rp(e,l.modified));if(i)return i;let s=[],r=new Nt(t.name,s,t,e);for(let l of e)l.instances.push(r);let o=Fp(e);for(let l of t.set)if(!l.modified.length)for(let h of o)s.push(on.get(l,h));return r}}function Rp(n,t){return n.length==t.length&&n.every((e,i)=>e==t[i])}function Fp(n){let t=[[]];for(let e=0;e<n.length;e++)for(let i=0,s=t.length;i<s;i++)t.push(t[i].concat(n[e]));return t.sort((e,i)=>i.length-e.length)}function Vp(n){let t=Object.create(null);for(let e in n){let i=n[e];Array.isArray(i)||(i=[i]);for(let s of e.split(" "))if(s){let r=[],o=2,l=s;for(let u=0;;){if(l=="..."&&u>0&&u+3==s.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!f)throw new RangeError("Invalid path: "+s);if(r.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==s.length)break;let g=s[u++];if(u==s.length&&g=="!"){o=0;break}if(g!="/")throw new RangeError("Invalid path: "+s);l=s.slice(u)}let h=r.length-1,a=r[h];if(!a)throw new RangeError("Invalid path: "+s);let c=new ln(i,o,h>0?r.slice(0,h):null);t[a]=c.sort(t[a])}}return tu.add(t)}const tu=new H;class ln{constructor(t,e,i,s){this.tags=t,this.mode=e,this.context=i,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}ln.empty=new ln([],2,null);function eu(n,t){let e=Object.create(null);for(let r of n)if(!Array.isArray(r.tag))e[r.tag.id]=r.class;else for(let o of r.tag)e[o.id]=r.class;let{scope:i,all:s=null}=t||{};return{style:r=>{let o=s;for(let l of r)for(let h of l.set){let a=e[h.id];if(a){o=o?o+" "+a:a;break}}return o},scope:i}}function Ip(n,t){let e=null;for(let i of n){let s=i.style(t);s&&(e=e?e+" "+s:s)}return e}function Wp(n,t,e,i=0,s=n.length){let r=new Hp(i,Array.isArray(t)?t:[t],e);r.highlightRange(n.cursor(),i,s,"",r.highlighters),r.flush(s)}class Hp{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,s,r){let{type:o,from:l,to:h}=t;if(l>=i||h<=e)return;o.isTop&&(r=this.highlighters.filter(g=>!g.scope||g.scope(o)));let a=s,c=jp(t)||ln.empty,u=Ip(r,c.tags);if(u&&(a&&(a+=" "),a+=u,c.mode==1&&(s+=(s?" ":"")+u)),this.startSpan(Math.max(e,l),a),c.opaque)return;let f=t.tree&&t.tree.prop(H.mounted);if(f&&f.overlay){let g=t.node.enter(f.overlay[0].from+l,1),p=this.highlighters.filter(b=>!b.scope||b.scope(f.tree.type)),m=t.firstChild();for(let b=0,v=l;;b++){let w=b<f.overlay.length?f.overlay[b]:null,x=w?w.from+l:h,y=Math.max(e,v),k=Math.min(i,x);if(y<k&&m)for(;t.from<k&&(this.highlightRange(t,y,k,s,r),this.startSpan(Math.min(k,t.to),a),!(t.to>=x||!t.nextSibling())););if(!w||x>i)break;v=w.to+l,v>e&&(this.highlightRange(g.cursor(),Math.max(e,w.from+l),Math.min(i,v),"",p),this.startSpan(Math.min(i,v),a))}m&&t.parent()}else if(t.firstChild()){f&&(s="");do if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,s,r),this.startSpan(Math.min(i,t.to),a)}while(t.nextSibling());t.parent()}}}function jp(n){let t=n.type.prop(tu);for(;t&&t.context&&!n.matchContext(t.context);)t=t.next;return t||null}const E=Nt.define,Cs=E(),pe=E(),ph=E(pe),mh=E(pe),me=E(),Ms=E(me),In=E(me),Gt=E(),Oe=E(Gt),$t=E(),Ut=E(),Zr=E(),ki=E(Zr),As=E(),d={comment:Cs,lineComment:E(Cs),blockComment:E(Cs),docComment:E(Cs),name:pe,variableName:E(pe),typeName:ph,tagName:E(ph),propertyName:mh,attributeName:E(mh),className:E(pe),labelName:E(pe),namespace:E(pe),macroName:E(pe),literal:me,string:Ms,docString:E(Ms),character:E(Ms),attributeValue:E(Ms),number:In,integer:E(In),float:E(In),bool:E(me),regexp:E(me),escape:E(me),color:E(me),url:E(me),keyword:$t,self:E($t),null:E($t),atom:E($t),unit:E($t),modifier:E($t),operatorKeyword:E($t),controlKeyword:E($t),definitionKeyword:E($t),moduleKeyword:E($t),operator:Ut,derefOperator:E(Ut),arithmeticOperator:E(Ut),logicOperator:E(Ut),bitwiseOperator:E(Ut),compareOperator:E(Ut),updateOperator:E(Ut),definitionOperator:E(Ut),typeOperator:E(Ut),controlOperator:E(Ut),punctuation:Zr,separator:E(Zr),bracket:ki,angleBracket:E(ki),squareBracket:E(ki),paren:E(ki),brace:E(ki),content:Gt,heading:Oe,heading1:E(Oe),heading2:E(Oe),heading3:E(Oe),heading4:E(Oe),heading5:E(Oe),heading6:E(Oe),contentSeparator:E(Gt),list:E(Gt),quote:E(Gt),emphasis:E(Gt),strong:E(Gt),link:E(Gt),monospace:E(Gt),strikethrough:E(Gt),inserted:E(),deleted:E(),changed:E(),invalid:E(),meta:As,documentMeta:E(As),annotation:E(As),processingInstruction:E(As),definition:Nt.defineModifier("definition"),constant:Nt.defineModifier("constant"),function:Nt.defineModifier("function"),standard:Nt.defineModifier("standard"),local:Nt.defineModifier("local"),special:Nt.defineModifier("special")};for(let n in d){let t=d[n];t instanceof Nt&&(t.name=n)}eu([{tag:d.link,class:"tok-link"},{tag:d.heading,class:"tok-heading"},{tag:d.emphasis,class:"tok-emphasis"},{tag:d.strong,class:"tok-strong"},{tag:d.keyword,class:"tok-keyword"},{tag:d.atom,class:"tok-atom"},{tag:d.bool,class:"tok-bool"},{tag:d.url,class:"tok-url"},{tag:d.labelName,class:"tok-labelName"},{tag:d.inserted,class:"tok-inserted"},{tag:d.deleted,class:"tok-deleted"},{tag:d.literal,class:"tok-literal"},{tag:d.string,class:"tok-string"},{tag:d.number,class:"tok-number"},{tag:[d.regexp,d.escape,d.special(d.string)],class:"tok-string2"},{tag:d.variableName,class:"tok-variableName"},{tag:d.local(d.variableName),class:"tok-variableName tok-local"},{tag:d.definition(d.variableName),class:"tok-variableName tok-definition"},{tag:d.special(d.variableName),class:"tok-variableName2"},{tag:d.definition(d.propertyName),class:"tok-propertyName tok-definition"},{tag:d.typeName,class:"tok-typeName"},{tag:d.namespace,class:"tok-namespace"},{tag:d.className,class:"tok-className"},{tag:d.macroName,class:"tok-macroName"},{tag:d.propertyName,class:"tok-propertyName"},{tag:d.operator,class:"tok-operator"},{tag:d.comment,class:"tok-comment"},{tag:d.meta,class:"tok-meta"},{tag:d.invalid,class:"tok-invalid"},{tag:d.punctuation,class:"tok-punctuation"}]);var Wn;const qe=new H;function Kp(n){return O.define({combine:n?t=>t.concat(n):void 0})}const $p=new H;class Ft{constructor(t,e,i=[],s=""){this.data=t,this.name=s,K.prototype.hasOwnProperty("tree")||Object.defineProperty(K.prototype,"tree",{get(){return te(this)}}),this.parser=e,this.extension=[Te.of(this),K.languageData.of((r,o,l)=>{let h=bh(r,o,l),a=h.type.prop(qe);if(!a)return[];let c=r.facet(a),u=h.type.prop($p);if(u){let f=h.resolve(o-h.from,l);for(let g of u)if(g.test(f,r)){let p=r.facet(g.facet);return g.type=="replace"?p:p.concat(c)}}return c})].concat(i)}isActiveAt(t,e,i=-1){return bh(t,e,i).type.prop(qe)==this.data}findRegions(t){let e=t.facet(Te);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],s=(r,o)=>{if(r.prop(qe)==this.data){i.push({from:o,to:o+r.length});return}let l=r.prop(H.mounted);if(l){if(l.tree.prop(qe)==this.data){if(l.overlay)for(let h of l.overlay)i.push({from:h.from+o,to:h.to+o});else i.push({from:o,to:o+r.length});return}else if(l.overlay){let h=i.length;if(s(l.tree,l.overlay[0].from+o),i.length>h)return}}for(let h=0;h<r.children.length;h++){let a=r.children[h];a instanceof at&&s(a,r.positions[h]+o)}};return s(te(t),0),i}get allowsNesting(){return!0}}Ft.setState=tt.define();function bh(n,t,e){let i=n.facet(Te),s=te(n).topNode;if(!i||i.allowsNesting)for(let r=s;r;r=r.enter(t,e,et.ExcludeBuffers))r.type.isTop&&(s=r);return s}class Qr extends Ft{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=Kp(t.languageData);return new Qr(e,t.parser.configure({props:[qe.add(i=>i.isTop?e:void 0)]}),t.name)}configure(t,e){return new Qr(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function te(n){let t=n.field(Ft.state,!1);return t?t.tree:at.empty}class Up{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let Si=null;class hn{constructor(t,e,i=[],s,r,o,l,h){this.parser=t,this.state=e,this.fragments=i,this.tree=s,this.treeLen=r,this.viewport=o,this.skipped=l,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new hn(t,e,[],at.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Up(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=at.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof t=="number"){let s=Date.now()+t;t=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(he.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(he.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Si;Si=this;try{return t()}finally{Si=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=vh(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:s,treeLen:r,viewport:o,skipped:l}=this;if(this.takeTree(),!t.empty){let h=[];if(t.iterChangedRanges((a,c,u,f)=>h.push({fromA:a,toA:c,fromB:u,toB:f})),i=he.applyChanges(i,h),s=at.empty,r=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){l=[];for(let a of this.skipped){let c=t.mapPos(a.from,1),u=t.mapPos(a.to,-1);c<u&&l.push({from:c,to:u})}}}return new hn(this.parser,e,i,s,r,o,l,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:r}=this.skipped[i];s<t.to&&r>t.from&&(this.fragments=vh(this.fragments,s,r),this.skipped.splice(i--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Ep{createParse(e,i,s){let r=s[0].from,o=s[s.length-1].to;return{parsedPos:r,advance(){let h=Si;if(h){for(let a of s)h.tempSkipped.push(a);t&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,t]):t)}return this.parsedPos=o,new at(Dt.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return Si}}function vh(n,t,e){return he.applyChanges(n,[{fromA:t,toA:e,fromB:t,toB:e}])}class fi{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new fi(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=hn.create(t.facet(Te).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new fi(i)}}Ft.state=Ht.define({create:fi.init,update(n,t){for(let e of t.effects)if(e.is(Ft.setState))return e.value;return t.startState.facet(Te)!=t.state.facet(Te)?fi.init(t.state):n.apply(t)}});let iu=n=>{let t=setTimeout(()=>n(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(iu=n=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(n,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const Hn=typeof navigator<"u"&&(!((Wn=navigator.scheduling)===null||Wn===void 0)&&Wn.isInputPending)?()=>navigator.scheduling.isInputPending():null,Xp=dt.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Ft.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Ft.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=iu(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,r=i.field(Ft.state);if(r.tree==r.context.tree&&r.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!Hn?Math.max(25,t.timeRemaining()-5):1e9),l=r.context.treeLen<s&&i.doc.length>s+1e3,h=r.context.work(()=>Hn&&Hn()||Date.now()>o,s+(l?0:1e5));this.chunkBudget-=Date.now()-e,(h||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Ft.setState.of(new fi(r.context))})),this.chunkBudget>0&&!(h&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Rt(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Te=O.define({combine(n){return n.length?n[0]:null},enables:n=>[Ft.state,Xp,B.contentAttributes.compute([n],t=>{let e=t.facet(n);return e&&e.name?{"data-language":e.name}:{}})]});class _v{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}class su{constructor(t,e,i,s,r,o=void 0){this.name=t,this.alias=e,this.extensions=i,this.filename=s,this.loadFunc=r,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(t=>this.support=t,t=>{throw this.loading=null,t}))}static of(t){let{load:e,support:i}=t;if(!e){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(i)}return new su(t.name,(t.alias||[]).concat(t.name).map(s=>s.toLowerCase()),t.extensions||[],t.filename,e,i)}static matchFilename(t,e){for(let s of t)if(s.filename&&s.filename.test(e))return s;let i=/\.([^.]+)$/.exec(e);if(i){for(let s of t)if(s.extensions.indexOf(i[1])>-1)return s}return null}static matchLanguageName(t,e,i=!0){e=e.toLowerCase();for(let s of t)if(s.alias.some(r=>r==e))return s;if(i)for(let s of t)for(let r of s.alias){let o=e.indexOf(r);if(o>-1&&(r.length>2||!/\w/.test(e[o-1])&&!/\w/.test(e[o+r.length])))return s}return null}}const Gp=O.define(),nu=O.define({combine:n=>{if(!n.length)return"  ";let t=n[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return t}});function qp(n){let t=n.facet(nu);return t.charCodeAt(0)==9?n.tabSize*t.length:t.length}function Jp(n,t){let e="",i=n.tabSize,s=n.facet(nu)[0];if(s=="	"){for(;t>=i;)e+="	",t-=i;s=" "}for(let r=0;r<t;r++)e+=s;return e}function Yp(n,t){n instanceof K&&(n=new ru(n));for(let i of n.state.facet(Gp)){let s=i(n,t);if(s!==void 0)return s}let e=te(n.state);return e.length>=t?Qp(n,e,t):null}class ru{constructor(t,e={}){this.state=t,this.options=e,this.unit=qp(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:s,simulateDoubleBreak:r}=this.options;return s!=null&&s>=i.from&&s<=i.to?r&&s==t?{text:"",from:t}:(e<0?s<t:s<=t)?{text:i.text.slice(s-i.from),from:s}:{text:i.text.slice(0,s-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:s}=this.lineAt(t,e);return i.slice(t-s,Math.min(i.length,t+100-s))}column(t,e=1){let{text:i,from:s}=this.lineAt(t,e),r=this.countColumn(i,t-s),o=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return o>-1&&(r+=o-this.countColumn(i,i.search(/\S|$/))),r}countColumn(t,e=t.length){return ko(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:s}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let o=r(s);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Zp=new H;function Qp(n,t,e){let i=t.resolveStack(e),s=i.node.enterUnfinishedNodesBefore(e);if(s!=i.node){let r=[];for(let o=s;o!=i.node;o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)i={node:r[o],next:i}}return ou(i,n,e)}function ou(n,t,e){for(let i=n;i;i=i.next){let s=em(i.node);if(s)return s(Ro.create(t,e,i))}return 0}function tm(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function em(n){let t=n.type.prop(Zp);if(t)return t;let e=n.firstChild,i;if(e&&(i=e.type.prop(H.closedBy))){let s=n.lastChild,r=s&&i.indexOf(s.name)>-1;return o=>lu(o,!0,1,void 0,r&&!tm(o)?s.from:void 0)}return n.parent==null?im:null}function im(){return 0}class Ro extends ru{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.context=i}get node(){return this.context.node}static create(t,e,i){return new Ro(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let i=t.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(sm(i,t))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){return ou(this.context.next,this.base,this.pos)}}function sm(n,t){for(let e=t;e;e=e.parent)if(n==e)return!0;return!1}function nm(n){let t=n.node,e=t.childAfter(t.from),i=t.lastChild;if(!e)return null;let s=n.options.simulateBreak,r=n.state.doc.lineAt(e.from),o=s==null||s<=r.from?r.to:Math.min(r.to,s);for(let l=e.to;;){let h=t.childAfter(l);if(!h||h==i)return null;if(!h.type.isSkipped){if(h.from>=o)return null;let a=/^ */.exec(r.text.slice(e.to-r.from))[0].length;return{from:e.from,to:e.to+a}}l=h.to}}function Rv({closing:n,align:t=!0,units:e=1}){return i=>lu(i,t,e,n)}function lu(n,t,e,i,s){let r=n.textAfter,o=r.match(/^\s*/)[0].length,l=i&&r.slice(o,o+i.length)==i||s==n.pos+o,h=t?nm(n):null;return h?l?n.column(h.from):n.column(h.to):n.baseIndent+(l?0:n.unit*e)}const rm=200;function Fv(){return K.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let t=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!t.length)return n;let e=n.newDoc,{head:i}=n.newSelection.main,s=e.lineAt(i);if(i>s.from+rm)return n;let r=e.sliceString(s.from,i);if(!t.some(a=>a.test(r)))return n;let{state:o}=n,l=-1,h=[];for(let{head:a}of o.selection.ranges){let c=o.doc.lineAt(a);if(c.from==l)continue;l=c.from;let u=Yp(o,c.from);if(u==null)continue;let f=/^\s*/.exec(c.text)[0],g=Jp(o,u);f!=g&&h.push({from:c.from,to:c.from+f.length,insert:g})}return h.length?[n,{changes:h,sequential:!0}]:n})}const om=O.define(),lm=new H;function Vv(n){let t=n.firstChild,e=n.lastChild;return t&&t.to<e.from?{from:t.to,to:e.type.isError?n.to:e.from}:null}function hm(n,t,e){let i=te(n);if(i.length<e)return null;let s=i.resolveStack(e,1),r=null;for(let o=s;o;o=o.next){let l=o.node;if(l.to<=e||l.from>e)continue;if(r&&l.from<t)break;let h=l.type.prop(lm);if(h&&(l.to<i.length-50||i.length==n.doc.length||!am(l))){let a=h(l,n);a&&a.from<=e&&a.from>=t&&a.to>e&&(r=a)}}return r}function am(n){let t=n.lastChild;return t&&t.to==n.to&&t.type.isError}function an(n,t,e){for(let i of n.facet(om)){let s=i(n,t,e);if(s)return s}return hm(n,t,e)}function hu(n,t){let e=t.mapPos(n.from,1),i=t.mapPos(n.to,-1);return e>=i?void 0:{from:e,to:i}}const wn=tt.define({map:hu}),os=tt.define({map:hu});function au(n){let t=[];for(let{head:e}of n.state.selection.ranges)t.some(i=>i.from<=e&&i.to>=e)||t.push(n.lineBlockAt(e));return t}const Ie=Ht.define({create(){return I.none},update(n,t){n=n.map(t.changes);for(let e of t.effects)if(e.is(wn)&&!cm(n,e.value.from,e.value.to)){let{preparePlaceholder:i}=t.state.facet(fu),s=i?I.replace({widget:new mm(i(t.state,e.value))}):wh;n=n.update({add:[s.range(e.value.from,e.value.to)]})}else e.is(os)&&(n=n.update({filter:(i,s)=>e.value.from!=i||e.value.to!=s,filterFrom:e.value.from,filterTo:e.value.to}));if(t.selection){let e=!1,{head:i}=t.selection.main;n.between(i,i,(s,r)=>{s<i&&r>i&&(e=!0)}),e&&(n=n.update({filterFrom:i,filterTo:i,filter:(s,r)=>r<=i||s>=i}))}return n},provide:n=>B.decorations.from(n),toJSON(n,t){let e=[];return n.between(0,t.doc.length,(i,s)=>{e.push(i,s)}),e},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<n.length;){let i=n[e++],s=n[e++];if(typeof i!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");t.push(wh.range(i,s))}return I.set(t,!0)}});function cn(n,t,e){var i;let s=null;return(i=n.field(Ie,!1))===null||i===void 0||i.between(t,e,(r,o)=>{(!s||s.from>r)&&(s={from:r,to:o})}),s}function cm(n,t,e){let i=!1;return n.between(t,t,(s,r)=>{s==t&&r==e&&(i=!0)}),i}function cu(n,t){return n.field(Ie,!1)?t:t.concat(tt.appendConfig.of(du()))}const um=n=>{for(let t of au(n)){let e=an(n.state,t.from,t.to);if(e)return n.dispatch({effects:cu(n.state,[wn.of(e),uu(n,e)])}),!0}return!1},fm=n=>{if(!n.state.field(Ie,!1))return!1;let t=[];for(let e of au(n)){let i=cn(n.state,e.from,e.to);i&&t.push(os.of(i),uu(n,i,!1))}return t.length&&n.dispatch({effects:t}),t.length>0};function uu(n,t,e=!0){let i=n.state.doc.lineAt(t.from).number,s=n.state.doc.lineAt(t.to).number;return B.announce.of(`${n.state.phrase(e?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${s}.`)}const dm=n=>{let{state:t}=n,e=[];for(let i=0;i<t.doc.length;){let s=n.lineBlockAt(i),r=an(t,s.from,s.to);r&&e.push(wn.of(r)),i=(r?n.lineBlockAt(r.to):s).to+1}return e.length&&n.dispatch({effects:cu(n.state,e)}),!!e.length},gm=n=>{let t=n.state.field(Ie,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,n.state.doc.length,(i,s)=>{e.push(os.of({from:i,to:s}))}),n.dispatch({effects:e}),!0},Iv=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:um},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:fm},{key:"Ctrl-Alt-[",run:dm},{key:"Ctrl-Alt-]",run:gm}],pm={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},fu=O.define({combine(n){return es(n,pm)}});function du(n){return[Ie,vm]}function gu(n,t){let{state:e}=n,i=e.facet(fu),s=o=>{let l=n.lineBlockAt(n.posAtDOM(o.target)),h=cn(n.state,l.from,l.to);h&&n.dispatch({effects:os.of(h)}),o.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(n,s,t);let r=document.createElement("span");return r.textContent=i.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=s,r}const wh=I.replace({widget:new class extends Le{toDOM(n){return gu(n,null)}}});class mm extends Le{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return gu(t,this.value)}}const bm={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class jn extends ce{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function Wv(n={}){let t=Object.assign(Object.assign({},bm),n),e=new jn(t,!0),i=new jn(t,!1),s=dt.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Te)!=o.state.facet(Te)||o.startState.field(Ie,!1)!=o.state.field(Ie,!1)||te(o.startState)!=te(o.state)||t.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new _e;for(let h of o.viewportLineBlocks){let a=cn(o.state,h.from,h.to)?i:an(o.state,h.from,h.to)?e:null;a&&l.add(h.from,h.from,a)}return l.finish()}}),{domEventHandlers:r}=t;return[s,up({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(s))===null||l===void 0?void 0:l.markers)||j.empty},initialSpacer(){return new jn(t,!1)},domEventHandlers:Object.assign(Object.assign({},r),{click:(o,l,h)=>{if(r.click&&r.click(o,l,h))return!0;let a=cn(o.state,l.from,l.to);if(a)return o.dispatch({effects:os.of(a)}),!0;let c=an(o.state,l.from,l.to);return c?(o.dispatch({effects:wn.of(c)}),!0):!1}})}),du()]}const vm=B.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ls{constructor(t,e){this.specs=t;let i;function s(l){let h=Ce.newName();return(i||(i=Object.create(null)))["."+h]=l,h}const r=typeof e.all=="string"?e.all:e.all?s(e.all):void 0,o=e.scope;this.scope=o instanceof Ft?l=>l.prop(qe)==o.data:o?l=>l==o:void 0,this.style=eu(t.map(l=>({tag:l.tag,class:l.class||s(Object.assign({},l,{tag:null}))})),{all:r}).style,this.module=i?new Ce(i):null,this.themeType=e.themeType}static define(t,e){return new ls(t,e||{})}}const to=O.define(),pu=O.define({combine(n){return n.length?[n[0]]:null}});function Kn(n){let t=n.facet(to);return t.length?t:n.facet(pu)}function wm(n,t){let e=[xm],i;return n instanceof ls&&(n.module&&e.push(B.styleModule.of(n.module)),i=n.themeType),t?.fallback?e.push(pu.of(n)):i?e.push(to.computeN([B.darkTheme],s=>s.facet(B.darkTheme)==(i=="dark")?[n]:[])):e.push(to.of(n)),e}class ym{constructor(t){this.markCache=Object.create(null),this.tree=te(t.state),this.decorations=this.buildDeco(t,Kn(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=te(t.state),i=Kn(t.state),s=i!=Kn(t.startState),{viewport:r}=t.view,o=t.changes.mapPos(this.decoratedTo,1);e.length<r.to&&!s&&e.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=o):(e!=this.tree||t.viewportChanged||s)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i),this.decoratedTo=r.to)}buildDeco(t,e){if(!e||!this.tree.length)return I.none;let i=new _e;for(let{from:s,to:r}of t.visibleRanges)Wp(this.tree,e,(o,l,h)=>{i.add(o,l,this.markCache[h]||(this.markCache[h]=I.mark({class:h})))},s,r);return i.finish()}}const xm=gn.high(dt.fromClass(ym,{decorations:n=>n.decorations})),Hv=ls.define([{tag:d.meta,color:"#404740"},{tag:d.link,textDecoration:"underline"},{tag:d.heading,textDecoration:"underline",fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strong,fontWeight:"bold"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:d.keyword,color:"#708"},{tag:[d.atom,d.bool,d.url,d.contentSeparator,d.labelName],color:"#219"},{tag:[d.literal,d.inserted],color:"#164"},{tag:[d.string,d.deleted],color:"#a11"},{tag:[d.regexp,d.escape,d.special(d.string)],color:"#e40"},{tag:d.definition(d.variableName),color:"#00f"},{tag:d.local(d.variableName),color:"#30a"},{tag:[d.typeName,d.namespace],color:"#085"},{tag:d.className,color:"#167"},{tag:[d.special(d.variableName),d.macroName],color:"#256"},{tag:d.definition(d.propertyName),color:"#00c"},{tag:d.comment,color:"#940"},{tag:d.invalid,color:"#f00"}]),km=B.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),mu=1e4,bu="()[]{}",vu=O.define({combine(n){return es(n,{afterCursor:!0,brackets:bu,maxScanDistance:mu,renderMatch:Mm})}}),Sm=I.mark({class:"cm-matchingBracket"}),Cm=I.mark({class:"cm-nonmatchingBracket"});function Mm(n){let t=[],e=n.matched?Sm:Cm;return t.push(e.range(n.start.from,n.start.to)),n.end&&t.push(e.range(n.end.from,n.end.to)),t}const Am=Ht.define({create(){return I.none},update(n,t){if(!t.docChanged&&!t.selection)return n;let e=[],i=t.state.facet(vu);for(let s of t.state.selection.ranges){if(!s.empty)continue;let r=Es(t.state,s.head,-1,i)||s.head>0&&Es(t.state,s.head-1,1,i)||i.afterCursor&&(Es(t.state,s.head,1,i)||s.head<t.state.doc.length&&Es(t.state,s.head+1,-1,i));r&&(e=e.concat(i.renderMatch(r,t.state)))}return I.set(e,!0)},provide:n=>B.decorations.from(n)}),Em=[Am,km];function jv(n={}){return[vu.of(n),Em]}const Tm=new H;function eo(n,t,e){let i=n.prop(t<0?H.openedBy:H.closedBy);if(i)return i;if(n.name.length==1){let s=e.indexOf(n.name);if(s>-1&&s%2==(t<0?1:0))return[e[s+t]]}return null}function io(n){let t=n.type.prop(Tm);return t?t(n.node):n}function Es(n,t,e,i={}){let s=i.maxScanDistance||mu,r=i.brackets||bu,o=te(n),l=o.resolveInner(t,e);for(let h=l;h;h=h.parent){let a=eo(h.type,e,r);if(a&&h.from<h.to){let c=io(h);if(c&&(e>0?t>=c.from&&t<c.to:t>c.from&&t<=c.to))return Dm(n,t,e,h,c,a,r)}}return Lm(n,t,e,o,l.type,s,r)}function Dm(n,t,e,i,s,r,o){let l=i.parent,h={from:s.from,to:s.to},a=0,c=l?.cursor();if(c&&(e<0?c.childBefore(i.from):c.childAfter(i.to)))do if(e<0?c.to<=i.from:c.from>=i.to){if(a==0&&r.indexOf(c.type.name)>-1&&c.from<c.to){let u=io(c);return{start:h,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(eo(c.type,e,o))a++;else if(eo(c.type,-e,o)){if(a==0){let u=io(c);return{start:h,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}a--}}while(e<0?c.prevSibling():c.nextSibling());return{start:h,matched:!1}}function Lm(n,t,e,i,s,r,o){let l=e<0?n.sliceDoc(t-1,t):n.sliceDoc(t,t+1),h=o.indexOf(l);if(h<0||h%2==0!=e>0)return null;let a={from:e<0?t-1:t,to:e>0?t+1:t},c=n.doc.iterRange(t,e>0?n.doc.length:0),u=0;for(let f=0;!c.next().done&&f<=r;){let g=c.value;e<0&&(f+=g.length);let p=t+f*e;for(let m=e>0?0:g.length-1,b=e>0?g.length:-1;m!=b;m+=e){let v=o.indexOf(g[m]);if(!(v<0||i.resolveInner(p+m,1).type!=s))if(v%2==0==e>0)u++;else{if(u==1)return{start:a,end:{from:p+m,to:p+m+1},matched:v>>1==h>>1};u--}}e>0&&(f+=g.length)}return c.done?{start:a,matched:!1}:null}const Om=Object.create(null),yh=[Dt.none],xh=[],kh=Object.create(null),Pm=Object.create(null);for(let[n,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Pm[n]=Nm(Om,t);function $n(n,t){xh.indexOf(n)>-1||(xh.push(n),console.warn(t))}function Nm(n,t){let e=[];for(let l of t.split(" ")){let h=[];for(let a of l.split(".")){let c=n[a]||d[a];c?typeof c=="function"?h.length?h=h.map(c):$n(a,`Modifier ${a} used at start of tag`):h.length?$n(a,`Tag ${a} used as modifier`):h=Array.isArray(c)?c:[c]:$n(a,`Unknown highlighting tag ${a}`)}for(let a of h)e.push(a)}if(!e.length)return 0;let i=t.replace(/ /g,"_"),s=i+" "+e.map(l=>l.id),r=kh[s];if(r)return r.id;let o=kh[s]=Dt.define({id:yh.length,name:i,props:[Vp({[i]:e})]});return yh.push(o),o.id}it.RTL,it.LTR;function Q(n){var t=n.width,e=n.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function Be(n,t){return n.width===t.width&&n.height===t.height}var zm=function(){function n(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return n.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(n.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),n.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(s){return s!==i})}}},n.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},n.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},n.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},n.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},n}();function Bm(n){return new zm(n)}var _m=function(){function n(t,e,i){var s;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=Q({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(r){return r},this._allowResizeObserver=(s=i?.allowResizeObserver)!==null&&s!==void 0?s:!0,this._chooseAndInitObserver()}return n.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(n.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bitmapSize",{get:function(){return Q({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),n.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=Q(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},n.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},n.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(n.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),n.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},n.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},n.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},n.prototype._resizeBitmap=function(t){var e=this.bitmapSize;Be(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},n.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},n.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=Q(this._transformBitmapSize(t,this._canvasElementClientSize)),s=Be(this.bitmapSize,i)?null:i;e===null&&s===null||e!==null&&s!==null&&Be(e,s)||(this._suggestedBitmapSize=s,this._emitSuggestedBitmapSizeChanged(e,s))},n.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(s){return s.call(i,t,e)})},n.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}Fm().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},n.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=Sh(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=Bm(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},n.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=Sh(this._canvasElement);if(i!==null){var s=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,r=this._canvasElement.getClientRects(),o=r[0]!==void 0?Vm(r[0],s):Q({width:this._canvasElementClientSize.width*s,height:this._canvasElementClientSize.height*s});this._suggestNewBitmapSize(o)}}},n.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(o){return o.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var s=i.devicePixelContentBoxSize[0],r=Q({width:s.inlineSize,height:s.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},n}();function Rm(n,t){if(t.type==="device-pixel-content-box")return new _m(n,t.transform,t.options);throw new Error("Unsupported binding target")}function Sh(n){return n.ownerDocument.defaultView}function Fm(){return new Promise(function(n){var t=new ResizeObserver(function(e){n(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function Vm(n,t){return Q({width:Math.round(n.left*t+n.width*t)-Math.round(n.left*t),height:Math.round(n.top*t+n.height*t)-Math.round(n.top*t)})}var Im=function(){function n(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return n.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},n.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(n.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),n}();function We(n,t){var e=n.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=n.bitmapSize;if(i.width===0||i.height===0)return null;var s=n.canvasElement.getContext("2d",t);return s===null?null:new Im(s,e,i)}/*!
 * @license
 * TradingView Lightweight Charts v4.2.1
 * Copyright (c) 2024 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const Wm={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Hm={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},jm={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Km={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},$m={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Um={color:"#26a69a",base:0},wu={color:"#2196f3"},yu={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var Ch,Mh;function He(n,t){const e={0:[],1:[n.lineWidth,n.lineWidth],2:[2*n.lineWidth,2*n.lineWidth],3:[6*n.lineWidth,6*n.lineWidth],4:[n.lineWidth,4*n.lineWidth]}[t];n.setLineDash(e)}function xu(n,t,e,i){n.beginPath();const s=n.lineWidth%2?.5:0;n.moveTo(e,t+s),n.lineTo(i,t+s),n.stroke()}function De(n,t){if(!n)throw new Error("Assertion failed"+(t?": "+t:""))}function St(n){if(n===void 0)throw new Error("Value is undefined");return n}function M(n){if(n===null)throw new Error("Value is null");return n}function Je(n){return M(St(n))}(function(n){n[n.Simple=0]="Simple",n[n.WithSteps=1]="WithSteps",n[n.Curved=2]="Curved"})(Ch||(Ch={})),function(n){n[n.Solid=0]="Solid",n[n.Dotted=1]="Dotted",n[n.Dashed=2]="Dashed",n[n.LargeDashed=3]="LargeDashed",n[n.SparseDotted=4]="SparseDotted"}(Mh||(Mh={}));const Ah={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function Pt(n){return n<0?0:n>255?255:Math.round(n)||0}function ku(n){return n<=0||n>1?Math.min(Math.max(n,0),1):Math.round(1e4*n)/1e4}const Xm=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,Gm=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,qm=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,Jm=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;function qi(n){(n=n.toLowerCase())in Ah&&(n=Ah[n]);{const t=Jm.exec(n)||qm.exec(n);if(t)return[Pt(parseInt(t[1],10)),Pt(parseInt(t[2],10)),Pt(parseInt(t[3],10)),ku(t.length<5?1:parseFloat(t[4]))]}{const t=Gm.exec(n);if(t)return[Pt(parseInt(t[1],16)),Pt(parseInt(t[2],16)),Pt(parseInt(t[3],16)),1]}{const t=Xm.exec(n);if(t)return[Pt(17*parseInt(t[1],16)),Pt(17*parseInt(t[2],16)),Pt(17*parseInt(t[3],16)),1]}throw new Error(`Cannot parse color: ${n}`)}function Su(n){return .199*n[0]+.687*n[1]+.114*n[2]}function yn(n){const t=qi(n);return{t:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,i:Su(t)>160?"black":"white"}}class lt{constructor(){this.h=[]}l(t,e,i){const s={o:t,_:e,u:i===!0};this.h.push(s)}v(t){const e=this.h.findIndex(i=>t===i.o);e>-1&&this.h.splice(e,1)}p(t){this.h=this.h.filter(e=>e._!==t)}m(t,e,i){const s=[...this.h];this.h=this.h.filter(r=>!r.u),s.forEach(r=>r.o(t,e,i))}M(){return this.h.length>0}S(){this.h=[]}}function Wt(n,...t){for(const e of t)for(const i in e)e[i]!==void 0&&(typeof e[i]!="object"||n[i]===void 0||Array.isArray(e[i])?n[i]=e[i]:Wt(n[i],e[i]));return n}function Zt(n){return typeof n=="number"&&isFinite(n)}function Ji(n){return typeof n=="number"&&n%1==0}function hs(n){return typeof n=="string"}function Ts(n){return typeof n=="boolean"}function ne(n){const t=n;if(!t||typeof t!="object")return t;let e,i,s;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(s=t[i],e[i]=s&&typeof s=="object"?ne(s):s);return e}function Ym(n){return n!==null}function Yi(n){return n===null?void 0:n}const Fo="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function di(n,t,e){return t===void 0&&(t=Fo),`${e=e!==void 0?`${e} `:""}${n}px ${t}`}class Zm{constructor(t){this.k={C:1,T:5,P:NaN,R:"",D:"",V:"",O:"",B:0,A:0,I:0,L:0,N:0},this.F=t}W(){const t=this.k,e=this.j(),i=this.H();return t.P===e&&t.D===i||(t.P=e,t.D=i,t.R=di(e,i),t.L=2.5/12*e,t.B=t.L,t.A=e/12*t.T,t.I=e/12*t.T,t.N=0),t.V=this.$(),t.O=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class Vo{constructor(){this.Y=[]}Z(t){this.Y=t}X(t,e,i){this.Y.forEach(s=>{s.X(t,e,i)})}}class jt{X(t,e,i){t.useBitmapCoordinateSpace(s=>this.K(s,e,i))}}class Qm extends jt{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.G===null||this.G.tt===null)return;const s=this.G.tt,r=this.G,o=Math.max(1,Math.floor(e))%2/2,l=h=>{t.beginPath();for(let a=s.to-1;a>=s.from;--a){const c=r.it[a],u=Math.round(c.nt*e)+o,f=c.st*i,g=h*i+o;t.moveTo(u,f),t.arc(u,f,g,0,2*Math.PI)}t.fill()};r.et>0&&(t.fillStyle=r.rt,l(r.ht+r.et)),t.fillStyle=r.lt,l(r.ht)}}function t0(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}const e0={from:0,to:1};class i0{constructor(t,e){this.ut=new Vo,this.ct=[],this.dt=[],this.ft=!0,this.F=t,this.vt=e,this.ut.Z(this.ct)}bt(t){const e=this.F.wt();e.length!==this.ct.length&&(this.dt=e.map(t0),this.ct=this.dt.map(i=>{const s=new Qm;return s.J(i),s}),this.ut.Z(this.ct)),this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){const t=this.vt.W().mode===2,e=this.F.wt(),i=this.vt.xt(),s=this.F.St();e.forEach((r,o)=>{var l;const h=this.dt[o],a=r.kt(i);if(t||a===null||!r.yt())return void(h.tt=null);const c=M(r.Ct());h.lt=a.Tt,h.ht=a.ht,h.et=a.Pt,h.it[0]._t=a._t,h.it[0].st=r.Dt().Rt(a._t,c.Vt),h.rt=(l=a.Ot)!==null&&l!==void 0?l:this.F.Bt(h.it[0].st/r.Dt().At()),h.it[0].ot=i,h.it[0].nt=s.It(i),h.tt=e0})}}class s0 extends jt{constructor(t){super(),this.zt=t}K({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.zt===null)return;const r=this.zt.Lt.yt,o=this.zt.Et.yt;if(!r&&!o)return;const l=Math.round(this.zt.nt*i),h=Math.round(this.zt.st*s);t.lineCap="butt",r&&l>=0&&(t.lineWidth=Math.floor(this.zt.Lt.et*i),t.strokeStyle=this.zt.Lt.V,t.fillStyle=this.zt.Lt.V,He(t,this.zt.Lt.Nt),function(a,c,u,f){a.beginPath();const g=a.lineWidth%2?.5:0;a.moveTo(c+g,u),a.lineTo(c+g,f),a.stroke()}(t,l,0,e.height)),o&&h>=0&&(t.lineWidth=Math.floor(this.zt.Et.et*s),t.strokeStyle=this.zt.Et.V,t.fillStyle=this.zt.Et.V,He(t,this.zt.Et.Nt),xu(t,h,0,e.width))}}class n0{constructor(t){this.ft=!0,this.Ft={Lt:{et:1,Nt:0,V:"",yt:!1},Et:{et:1,Nt:0,V:"",yt:!1},nt:0,st:0},this.Wt=new s0(this.Ft),this.jt=t}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const t=this.jt.yt(),e=M(this.jt.Ht()),i=e.$t().W().crosshair,s=this.Ft;if(i.mode===2)return s.Et.yt=!1,void(s.Lt.yt=!1);s.Et.yt=t&&this.jt.Ut(e),s.Lt.yt=t&&this.jt.qt(),s.Et.et=i.horzLine.width,s.Et.Nt=i.horzLine.style,s.Et.V=i.horzLine.color,s.Lt.et=i.vertLine.width,s.Lt.Nt=i.vertLine.style,s.Lt.V=i.vertLine.color,s.nt=this.jt.Yt(),s.st=this.jt.Zt()}}function r0(n,t,e,i,s,r){n.fillRect(t+r,e,i-2*r,r),n.fillRect(t+r,e+s-r,i-2*r,r),n.fillRect(t,e,r,s),n.fillRect(t+i-r,e,r,s)}function xn(n,t,e,i,s,r){n.save(),n.globalCompositeOperation="copy",n.fillStyle=r,n.fillRect(t,e,i,s),n.restore()}function Eh(n,t,e,i,s,r){n.beginPath(),n.roundRect?n.roundRect(t,e,i,s,r):(n.lineTo(t+i-r[1],e),r[1]!==0&&n.arcTo(t+i,e,t+i,e+r[1],r[1]),n.lineTo(t+i,e+s-r[2]),r[2]!==0&&n.arcTo(t+i,e+s,t+i-r[2],e+s,r[2]),n.lineTo(t+r[3],e+s),r[3]!==0&&n.arcTo(t,e+s,t,e+s-r[3],r[3]),n.lineTo(t,e+r[0]),r[0]!==0&&n.arcTo(t,e,t+r[0],e,r[0]))}function Th(n,t,e,i,s,r,o=0,l=[0,0,0,0],h=""){if(n.save(),!o||!h||h===r)return Eh(n,t,e,i,s,l),n.fillStyle=r,n.fill(),void n.restore();const a=o/2;var c;Eh(n,t+a,e+a,i-o,s-o,(c=-a,l.map(u=>u===0?u:u+c))),r!=="transparent"&&(n.fillStyle=r,n.fill()),h!=="transparent"&&(n.lineWidth=o,n.strokeStyle=h,n.closePath(),n.stroke()),n.restore()}function Cu(n,t,e,i,s,r,o){n.save(),n.globalCompositeOperation="copy";const l=n.createLinearGradient(0,0,0,s);l.addColorStop(0,r),l.addColorStop(1,o),n.fillStyle=l,n.fillRect(t,e,i,s),n.restore()}class Dh{constructor(t,e){this.J(t,e)}J(t,e){this.zt=t,this.Xt=e}At(t,e){return this.zt.yt?t.P+t.L+t.B:0}X(t,e,i,s){if(!this.zt.yt||this.zt.Kt.length===0)return;const r=this.zt.V,o=this.Xt.t,l=t.useBitmapCoordinateSpace(h=>{const a=h.context;a.font=e.R;const c=this.Gt(h,e,i,s),u=c.Jt;return c.Qt?Th(a,u.ti,u.ii,u.ni,u.si,o,u.ei,[u.ht,0,0,u.ht],o):Th(a,u.ri,u.ii,u.ni,u.si,o,u.ei,[0,u.ht,u.ht,0],o),this.zt.hi&&(a.fillStyle=r,a.fillRect(u.ri,u.li,u.ai-u.ri,u.oi)),this.zt._i&&(a.fillStyle=e.O,a.fillRect(c.Qt?u.ui-u.ei:0,u.ii,u.ei,u.ci-u.ii)),c});t.useMediaCoordinateSpace(({context:h})=>{const a=l.di;h.font=e.R,h.textAlign=l.Qt?"right":"left",h.textBaseline="middle",h.fillStyle=r,h.fillText(this.zt.Kt,a.fi,(a.ii+a.ci)/2+a.pi)})}Gt(t,e,i,s){var r;const{context:o,bitmapSize:l,mediaSize:h,horizontalPixelRatio:a,verticalPixelRatio:c}=t,u=this.zt.hi||!this.zt.mi?e.T:0,f=this.zt.bi?e.C:0,g=e.L+this.Xt.wi,p=e.B+this.Xt.gi,m=e.A,b=e.I,v=this.zt.Kt,w=e.P,x=i.Mi(o,v),y=Math.ceil(i.xi(o,v)),k=w+g+p,S=e.C+m+b+y+u,C=Math.max(1,Math.floor(c));let L=Math.round(k*c);L%2!=C%2&&(L+=1);const N=f>0?Math.max(1,Math.floor(f*a)):0,F=Math.round(S*a),z=Math.round(u*a),A=(r=this.Xt.Si)!==null&&r!==void 0?r:this.Xt.ki,V=Math.round(A*c)-Math.floor(.5*c),_=Math.floor(V+C/2-L/2),W=_+L,X=s==="right",nt=X?h.width-f:f,st=X?l.width-N:N;let U,rt,J;return X?(U=st-F,rt=st-z,J=nt-u-m-f):(U=st+F,rt=st+z,J=nt+u+m),{Qt:X,Jt:{ii:_,li:V,ci:W,ni:F,si:L,ht:2*a,ei:N,ti:U,ri:st,ai:rt,oi:C,ui:l.width},di:{ii:_/c,ci:W/c,fi:J,pi:x}}}}class kn{constructor(t){this.yi={ki:0,t:"#000",gi:0,wi:0},this.Ci={Kt:"",yt:!1,hi:!0,mi:!1,Ot:"",V:"#FFF",_i:!1,bi:!1},this.Ti={Kt:"",yt:!1,hi:!1,mi:!0,Ot:"",V:"#FFF",_i:!0,bi:!0},this.ft=!0,this.Pi=new(t||Dh)(this.Ci,this.yi),this.Ri=new(t||Dh)(this.Ti,this.yi)}Kt(){return this.Di(),this.Ci.Kt}ki(){return this.Di(),this.yi.ki}bt(){this.ft=!0}At(t,e=!1){return Math.max(this.Pi.At(t,e),this.Ri.At(t,e))}Vi(){return this.yi.Si||0}Oi(t){this.yi.Si=t}Bi(){return this.Di(),this.Ci.yt||this.Ti.yt}Ai(){return this.Di(),this.Ci.yt}gt(t){return this.Di(),this.Ci.hi=this.Ci.hi&&t.W().ticksVisible,this.Ti.hi=this.Ti.hi&&t.W().ticksVisible,this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Pi}Ii(){return this.Di(),this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Ri}Di(){this.ft&&(this.Ci.hi=!0,this.Ti.hi=!1,this.zi(this.Ci,this.Ti,this.yi))}}class o0 extends kn{constructor(t,e,i){super(),this.jt=t,this.Li=e,this.Ei=i}zi(t,e,i){if(t.yt=!1,this.jt.W().mode===2)return;const s=this.jt.W().horzLine;if(!s.labelVisible)return;const r=this.Li.Ct();if(!this.jt.yt()||this.Li.Ni()||r===null)return;const o=yn(s.labelBackgroundColor);i.t=o.t,t.V=o.i;const l=2/12*this.Li.P();i.wi=l,i.gi=l;const h=this.Ei(this.Li);i.ki=h.ki,t.Kt=this.Li.Fi(h._t,r),t.yt=!0}}const l0=/[1-9]/g;class Mu{constructor(){this.zt=null}J(t){this.zt=t}X(t,e){if(this.zt===null||this.zt.yt===!1||this.zt.Kt.length===0)return;const i=t.useMediaCoordinateSpace(({context:f})=>(f.font=e.R,Math.round(e.Wi.xi(f,M(this.zt).Kt,l0))));if(i<=0)return;const s=e.ji,r=i+2*s,o=r/2,l=this.zt.Hi;let h=this.zt.ki,a=Math.floor(h-o)+.5;a<0?(h+=Math.abs(0-a),a=Math.floor(h-o)+.5):a+r>l&&(h-=Math.abs(l-(a+r)),a=Math.floor(h-o)+.5);const c=a+r,u=Math.ceil(0+e.C+e.T+e.L+e.P+e.B);t.useBitmapCoordinateSpace(({context:f,horizontalPixelRatio:g,verticalPixelRatio:p})=>{const m=M(this.zt);f.fillStyle=m.t;const b=Math.round(a*g),v=Math.round(0*p),w=Math.round(c*g),x=Math.round(u*p),y=Math.round(2*g);if(f.beginPath(),f.moveTo(b,v),f.lineTo(b,x-y),f.arcTo(b,x,b+y,x,y),f.lineTo(w-y,x),f.arcTo(w,x,w,x-y,y),f.lineTo(w,v),f.fill(),m.hi){const k=Math.round(m.ki*g),S=v,C=Math.round((S+e.T)*p);f.fillStyle=m.V;const L=Math.max(1,Math.floor(g)),N=Math.floor(.5*g);f.fillRect(k-N,S,L,C-S)}}),t.useMediaCoordinateSpace(({context:f})=>{const g=M(this.zt),p=0+e.C+e.T+e.L+e.P/2;f.font=e.R,f.textAlign="left",f.textBaseline="middle",f.fillStyle=g.V;const m=e.Wi.Mi(f,"Apr0");f.translate(a+s,p+m),f.fillText(g.Kt,0,0)})}}class h0{constructor(t,e,i){this.ft=!0,this.Wt=new Mu,this.Ft={yt:!1,t:"#4c525e",V:"white",Kt:"",Hi:0,ki:NaN,hi:!0},this.vt=t,this.$i=e,this.Ei=i}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){const t=this.Ft;if(t.yt=!1,this.vt.W().mode===2)return;const e=this.vt.W().vertLine;if(!e.labelVisible)return;const i=this.$i.St();if(i.Ni())return;t.Hi=i.Hi();const s=this.Ei();if(s===null)return;t.ki=s.ki;const r=i.Ui(this.vt.xt());t.Kt=i.qi(M(r)),t.yt=!0;const o=yn(e.labelBackgroundColor);t.t=o.t,t.V=o.i,t.hi=i.W().ticksVisible}}class Io{constructor(){this.Yi=null,this.Zi=0}Xi(){return this.Zi}Ki(t){this.Zi=t}Dt(){return this.Yi}Gi(t){this.Yi=t}Ji(t){return[]}Qi(){return[]}yt(){return!0}}var Lh;(function(n){n[n.Normal=0]="Normal",n[n.Magnet=1]="Magnet",n[n.Hidden=2]="Hidden"})(Lh||(Lh={}));class a0 extends Io{constructor(t,e){super(),this.tn=null,this.nn=NaN,this.sn=0,this.en=!0,this.rn=new Map,this.hn=!1,this.ln=NaN,this.an=NaN,this._n=NaN,this.un=NaN,this.$i=t,this.cn=e,this.dn=new i0(t,this),this.fn=((s,r)=>o=>{const l=r(),h=s();if(o===M(this.tn).vn())return{_t:h,ki:l};{const a=M(o.Ct());return{_t:o.pn(l,a),ki:l}}})(()=>this.nn,()=>this.an);const i=((s,r)=>()=>{const o=this.$i.St().mn(s()),l=r();return o&&Number.isFinite(l)?{ot:o,ki:l}:null})(()=>this.sn,()=>this.Yt());this.bn=new h0(this,t,i),this.wn=new n0(this)}W(){return this.cn}gn(t,e){this._n=t,this.un=e}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(t,e,i){this.hn||(this.hn=!0),this.en=!0,this.yn(t,e,i)}xt(){return this.sn}Yt(){return this.ln}Zt(){return this.an}yt(){return this.en}Cn(){this.en=!1,this.Tn(),this.nn=NaN,this.ln=NaN,this.an=NaN,this.tn=null,this.Mn()}Pn(t){return this.tn!==null?[this.wn,this.dn]:[]}Ut(t){return t===this.tn&&this.cn.horzLine.visible}qt(){return this.cn.vertLine.visible}Rn(t,e){this.en&&this.tn===t||this.rn.clear();const i=[];return this.tn===t&&i.push(this.Dn(this.rn,e,this.fn)),i}Qi(){return this.en?[this.bn]:[]}Ht(){return this.tn}Vn(){this.wn.bt(),this.rn.forEach(t=>t.bt()),this.bn.bt(),this.dn.bt()}On(t){return t&&!t.vn().Ni()?t.vn():null}yn(t,e,i){this.Bn(t,e,i)&&this.Vn()}Bn(t,e,i){const s=this.ln,r=this.an,o=this.nn,l=this.sn,h=this.tn,a=this.On(i);this.sn=t,this.ln=isNaN(t)?NaN:this.$i.St().It(t),this.tn=i;const c=a!==null?a.Ct():null;return a!==null&&c!==null?(this.nn=e,this.an=a.Rt(e,c)):(this.nn=NaN,this.an=NaN),s!==this.ln||r!==this.an||l!==this.sn||o!==this.nn||h!==this.tn}Tn(){const t=this.$i.wt().map(i=>i.In().An()).filter(Ym),e=t.length===0?null:Math.max(...t);this.sn=e!==null?e:NaN}Dn(t,e,i){let s=t.get(e);return s===void 0&&(s=new o0(this,e,i),t.set(e,s)),s}}function Sn(n){return n==="left"||n==="right"}class pt{constructor(t){this.zn=new Map,this.Ln=[],this.En=t}Nn(t,e){const i=function(s,r){return s===void 0?r:{Fn:Math.max(s.Fn,r.Fn),Wn:s.Wn||r.Wn}}(this.zn.get(t),e);this.zn.set(t,i)}jn(){return this.En}Hn(t){const e=this.zn.get(t);return e===void 0?{Fn:this.En}:{Fn:Math.max(this.En,e.Fn),Wn:e.Wn}}$n(){this.Un(),this.Ln=[{qn:0}]}Yn(t){this.Un(),this.Ln=[{qn:1,Vt:t}]}Zn(t){this.Xn(),this.Ln.push({qn:5,Vt:t})}Un(){this.Xn(),this.Ln.push({qn:6})}Kn(){this.Un(),this.Ln=[{qn:4}]}Gn(t){this.Un(),this.Ln.push({qn:2,Vt:t})}Jn(t){this.Un(),this.Ln.push({qn:3,Vt:t})}Qn(){return this.Ln}ts(t){for(const e of t.Ln)this.ns(e);this.En=Math.max(this.En,t.En),t.zn.forEach((e,i)=>{this.Nn(i,e)})}static ss(){return new pt(2)}static es(){return new pt(3)}ns(t){switch(t.qn){case 0:this.$n();break;case 1:this.Yn(t.Vt);break;case 2:this.Gn(t.Vt);break;case 3:this.Jn(t.Vt);break;case 4:this.Kn();break;case 5:this.Zn(t.Vt);break;case 6:this.Xn()}}Xn(){const t=this.Ln.findIndex(e=>e.qn===5);t!==-1&&this.Ln.splice(t,1)}}const Oh=".";function re(n,t){if(!Zt(n))return"n/a";if(!Ji(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?n.toString():("0000000000000000"+n.toString()).slice(-t)}class Cn{constructor(t,e){if(e||(e=1),Zt(t)&&Ji(t)||(t=100),t<0)throw new TypeError("invalid base");this.Li=t,this.rs=e,this.hs()}format(t){const e=t<0?"":"";return t=Math.abs(t),e+this.ls(t)}hs(){if(this.os=0,this.Li>0&&this.rs>0){let t=this.Li;for(;t>1;)t/=10,this.os++}}ls(t){const e=this.Li/this.rs;let i=Math.floor(t),s="";const r=this.os!==void 0?this.os:NaN;if(e>1){let o=+(Math.round(t*e)-i*e).toFixed(this.os);o>=e&&(o-=e,i+=1),s=Oh+re(+o.toFixed(this.os)*this.rs,r)}else i=Math.round(i*e)/e,r>0&&(s=Oh+re(0,r));return i.toFixed(0)+s}}class Au extends Cn{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class c0{constructor(t){this._s=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.us(t):t<999995?e+this.us(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.us(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.us(t/1e9)+"B")}us(t){let e;const i=Math.pow(10,this._s);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this._s).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(s,r)=>r)}}function Eu(n,t,e,i,s,r,o){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:l,horizontalPixelRatio:h,verticalPixelRatio:a}=n,c=t[i.from];let u=r(n,c),f=c;if(i.to-i.from<2){const g=s/2;l.beginPath();const p={nt:c.nt-g,st:c.st},m={nt:c.nt+g,st:c.st};l.moveTo(p.nt*h,p.st*a),l.lineTo(m.nt*h,m.st*a),o(n,u,p,m)}else{const g=(m,b)=>{o(n,u,f,b),l.beginPath(),u=m,f=b};let p=f;l.beginPath(),l.moveTo(c.nt*h,c.st*a);for(let m=i.from+1;m<i.to;++m){p=t[m];const b=r(n,p);switch(e){case 0:l.lineTo(p.nt*h,p.st*a);break;case 1:l.lineTo(p.nt*h,t[m-1].st*a),b!==u&&(g(b,p),l.lineTo(p.nt*h,t[m-1].st*a)),l.lineTo(p.nt*h,p.st*a);break;case 2:{const[v,w]=u0(t,m-1,m);l.bezierCurveTo(v.nt*h,v.st*a,w.nt*h,w.st*a,p.nt*h,p.st*a);break}}e!==1&&b!==u&&(g(b,p),l.moveTo(p.nt*h,p.st*a))}(f!==p||f===p&&e===1)&&o(n,u,f,p)}}const Ph=6;function Un(n,t){return{nt:n.nt-t.nt,st:n.st-t.st}}function Nh(n,t){return{nt:n.nt/t,st:n.st/t}}function u0(n,t,e){const i=Math.max(0,t-1),s=Math.min(n.length-1,e+1);var r,o;return[(r=n[t],o=Nh(Un(n[e],n[i]),Ph),{nt:r.nt+o.nt,st:r.st+o.st}),Un(n[e],Nh(Un(n[s],n[t]),Ph))]}function f0(n,t,e,i,s){const{context:r,horizontalPixelRatio:o,verticalPixelRatio:l}=t;r.lineTo(s.nt*o,n*l),r.lineTo(i.nt*o,n*l),r.closePath(),r.fillStyle=e,r.fill()}class Tu extends jt{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K(t){var e;if(this.G===null)return;const{it:i,tt:s,cs:r,et:o,Nt:l,ds:h}=this.G,a=(e=this.G.fs)!==null&&e!==void 0?e:this.G.vs?0:t.mediaSize.height;if(s===null)return;const c=t.context;c.lineCap="butt",c.lineJoin="round",c.lineWidth=o,He(c,l),c.lineWidth=1,Eu(t,i,h,s,r,this.ps.bind(this),f0.bind(null,a))}}function so(n,t,e){return Math.min(Math.max(n,t),e)}function Ds(n,t,e){return t-n<=e}function Du(n){const t=Math.ceil(n);return t%2==0?t-1:t}class Wo{bs(t,e){const i=this.ws,{gs:s,Ms:r,xs:o,Ss:l,ks:h,fs:a}=e;if(this.ys===void 0||i===void 0||i.gs!==s||i.Ms!==r||i.xs!==o||i.Ss!==l||i.fs!==a||i.ks!==h){const c=t.context.createLinearGradient(0,0,0,h);if(c.addColorStop(0,s),a!=null){const u=so(a*t.verticalPixelRatio/h,0,1);c.addColorStop(u,r),c.addColorStop(u,o)}c.addColorStop(1,l),this.ys=c,this.ws=e}return this.ys}}class d0 extends Tu{constructor(){super(...arguments),this.Cs=new Wo}ps(t,e){return this.Cs.bs(t,{gs:e.Ts,Ms:"",xs:"",Ss:e.Ps,ks:t.bitmapSize.height})}}function g0(n,t){const e=n.context;e.strokeStyle=t,e.stroke()}class Lu extends jt{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K(t){if(this.G===null)return;const{it:e,tt:i,cs:s,ds:r,et:o,Nt:l,Rs:h}=this.G;if(i===null)return;const a=t.context;a.lineCap="butt",a.lineWidth=o*t.verticalPixelRatio,He(a,l),a.lineJoin="round";const c=this.Ds.bind(this);r!==void 0&&Eu(t,e,r,i,s,c,g0),h&&function(u,f,g,p,m){const{horizontalPixelRatio:b,verticalPixelRatio:v,context:w}=u;let x=null;const y=Math.max(1,Math.floor(b))%2/2,k=g*v+y;for(let S=p.to-1;S>=p.from;--S){const C=f[S];if(C){const L=m(u,C);L!==x&&(w.beginPath(),x!==null&&w.fill(),w.fillStyle=L,x=L);const N=Math.round(C.nt*b)+y,F=C.st*v;w.moveTo(N,F),w.arc(N,F,k,0,2*Math.PI)}}w.fill()}(t,e,h,i,c)}}class Ou extends Lu{Ds(t,e){return e.lt}}function Pu(n,t,e,i,s=0,r=t.length){let o=r-s;for(;0<o;){const l=o>>1,h=s+l;i(t[h],e)===n?(s=h+1,o-=l+1):o=l}return s}const as=Pu.bind(null,!0),Nu=Pu.bind(null,!1);function p0(n,t){return n.ot<t}function m0(n,t){return t<n.ot}function zu(n,t,e){const i=t.Vs(),s=t.ui(),r=as(n,i,p0),o=Nu(n,s,m0);if(!e)return{from:r,to:o};let l=r,h=o;return r>0&&r<n.length&&n[r].ot>=i&&(l=r-1),o>0&&o<n.length&&n[o-1].ot<=s&&(h=o+1),{from:l,to:h}}class Ho{constructor(t,e,i){this.Os=!0,this.Bs=!0,this.As=!0,this.Is=[],this.zs=null,this.Ls=t,this.Es=e,this.Ns=i}bt(t){this.Os=!0,t==="data"&&(this.Bs=!0),t==="options"&&(this.As=!0)}gt(){return this.Ls.yt()?(this.Fs(),this.zs===null?null:this.Ws):null}js(){this.Is=this.Is.map(t=>Object.assign(Object.assign({},t),this.Ls.$s().Hs(t.ot)))}Us(){this.zs=null}Fs(){this.Bs&&(this.qs(),this.Bs=!1),this.As&&(this.js(),this.As=!1),this.Os&&(this.Ys(),this.Os=!1)}Ys(){const t=this.Ls.Dt(),e=this.Es.St();if(this.Us(),e.Ni()||t.Ni())return;const i=e.Zs();if(i===null||this.Ls.In().Xs()===0)return;const s=this.Ls.Ct();s!==null&&(this.zs=zu(this.Is,i,this.Ns),this.Ks(t,e,s.Vt),this.Gs())}}class Mn extends Ho{constructor(t,e){super(t,e,!0)}Ks(t,e,i){e.Js(this.Is,Yi(this.zs)),t.Qs(this.Is,i,Yi(this.zs))}te(t,e){return{ot:t,_t:e,nt:NaN,st:NaN}}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(e=>{const i=e.Vt[3];return this.ne(e.se,i,t)})}}class b0 extends Mn{constructor(t,e){super(t,e),this.Ws=new Vo,this.ee=new d0,this.re=new Ou,this.Ws.Z([this.ee,this.re])}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t=this.Ls.W();this.ee.J({ds:t.lineType,it:this.Is,Nt:t.lineStyle,et:t.lineWidth,fs:null,vs:t.invertFilledArea,tt:this.zs,cs:this.Es.St().he()}),this.re.J({ds:t.lineVisible?t.lineType:void 0,it:this.Is,Nt:t.lineStyle,et:t.lineWidth,tt:this.zs,cs:this.Es.St().he(),Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}class v0 extends jt{constructor(){super(...arguments),this.zt=null,this.le=0,this.ae=0}J(t){this.zt=t}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;this.le=this.oe(e),this.le>=2&&Math.max(1,Math.floor(e))%2!=this.le%2&&this.le--,this.ae=this.zt._e?Math.min(this.le,Math.floor(e)):this.le;let s=null;const r=this.ae<=this.le&&this.zt.he>=Math.floor(1.5*e);for(let o=this.zt.tt.from;o<this.zt.tt.to;++o){const l=this.zt.In[o];s!==l.ue&&(t.fillStyle=l.ue,s=l.ue);const h=Math.floor(.5*this.ae),a=Math.round(l.nt*e),c=a-h,u=this.ae,f=c+u-1,g=Math.min(l.ce,l.de),p=Math.max(l.ce,l.de),m=Math.round(g*i)-h,b=Math.round(p*i)+h,v=Math.max(b-m,this.ae);t.fillRect(c,m,u,v);const w=Math.ceil(1.5*this.le);if(r){if(this.zt.fe){const S=a-w;let C=Math.max(m,Math.round(l.ve*i)-h),L=C+u-1;L>m+v-1&&(L=m+v-1,C=L-u+1),t.fillRect(S,C,c-S,L-C+1)}const x=a+w;let y=Math.max(m,Math.round(l.pe*i)-h),k=y+u-1;k>m+v-1&&(k=m+v-1,y=k-u+1),t.fillRect(f+1,y,x-f,k-y+1)}}}oe(t){const e=Math.floor(t);return Math.max(e,Math.floor(function(i,s){return Math.floor(.3*i*s)}(M(this.zt).he,t)))}}class Bu extends Ho{constructor(t,e){super(t,e,!1)}Ks(t,e,i){e.Js(this.Is,Yi(this.zs)),t.me(this.Is,i,Yi(this.zs))}be(t,e,i){return{ot:t,we:e.Vt[0],ge:e.Vt[1],Me:e.Vt[2],xe:e.Vt[3],nt:NaN,ve:NaN,ce:NaN,de:NaN,pe:NaN}}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(e=>this.ne(e.se,e,t))}}class w0 extends Bu{constructor(){super(...arguments),this.Ws=new v0}ne(t,e,i){return Object.assign(Object.assign({},this.be(t,e,i)),i.Hs(t))}Gs(){const t=this.Ls.W();this.Ws.J({In:this.Is,he:this.Es.St().he(),fe:t.openVisible,_e:t.thinBars,tt:this.zs})}}class y0 extends Tu{constructor(){super(...arguments),this.Cs=new Wo}ps(t,e){const i=this.G;return this.Cs.bs(t,{gs:e.Se,Ms:e.ke,xs:e.ye,Ss:e.Ce,ks:t.bitmapSize.height,fs:i.fs})}}class x0 extends Lu{constructor(){super(...arguments),this.Te=new Wo}Ds(t,e){const i=this.G;return this.Te.bs(t,{gs:e.Pe,Ms:e.Pe,xs:e.Re,Ss:e.Re,ks:t.bitmapSize.height,fs:i.fs})}}class k0 extends Mn{constructor(t,e){super(t,e),this.Ws=new Vo,this.De=new y0,this.Ve=new x0,this.Ws.Z([this.De,this.Ve])}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t=this.Ls.Ct();if(t===null)return;const e=this.Ls.W(),i=this.Ls.Dt().Rt(e.baseValue.price,t.Vt),s=this.Es.St().he();this.De.J({it:this.Is,et:e.lineWidth,Nt:e.lineStyle,ds:e.lineType,fs:i,vs:!1,tt:this.zs,cs:s}),this.Ve.J({it:this.Is,et:e.lineWidth,Nt:e.lineStyle,ds:e.lineVisible?e.lineType:void 0,Rs:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,fs:i,tt:this.zs,cs:s})}}class S0 extends jt{constructor(){super(...arguments),this.zt=null,this.le=0}J(t){this.zt=t}K(t){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;const{horizontalPixelRatio:e}=t;this.le=function(r,o){if(r>=2.5&&r<=4)return Math.floor(3*o);const l=1-.2*Math.atan(Math.max(4,r)-4)/(.5*Math.PI),h=Math.floor(r*l*o),a=Math.floor(r*o),c=Math.min(h,a);return Math.max(Math.floor(o),c)}(this.zt.he,e),this.le>=2&&Math.floor(e)%2!=this.le%2&&this.le--;const i=this.zt.In;this.zt.Oe&&this.Be(t,i,this.zt.tt),this.zt._i&&this.Ae(t,i,this.zt.tt);const s=this.Ie(e);(!this.zt._i||this.le>2*s)&&this.ze(t,i,this.zt.tt)}Be(t,e,i){if(this.zt===null)return;const{context:s,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="",h=Math.min(Math.floor(r),Math.floor(this.zt.he*r));h=Math.max(Math.floor(r),Math.min(h,this.le));const a=Math.floor(.5*h);let c=null;for(let u=i.from;u<i.to;u++){const f=e[u];f.Le!==l&&(s.fillStyle=f.Le,l=f.Le);const g=Math.round(Math.min(f.ve,f.pe)*o),p=Math.round(Math.max(f.ve,f.pe)*o),m=Math.round(f.ce*o),b=Math.round(f.de*o);let v=Math.round(r*f.nt)-a;const w=v+h-1;c!==null&&(v=Math.max(c+1,v),v=Math.min(v,w));const x=w-v+1;s.fillRect(v,m,x,g-m),s.fillRect(v,p+1,x,b-p),c=w}}Ie(t){let e=Math.floor(1*t);this.le<=2*e&&(e=Math.floor(.5*(this.le-1)));const i=Math.max(Math.floor(t),e);return this.le<=2*i?Math.max(Math.floor(t),Math.floor(1*t)):i}Ae(t,e,i){if(this.zt===null)return;const{context:s,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const h=this.Ie(r);let a=null;for(let c=i.from;c<i.to;c++){const u=e[c];u.Ee!==l&&(s.fillStyle=u.Ee,l=u.Ee);let f=Math.round(u.nt*r)-Math.floor(.5*this.le);const g=f+this.le-1,p=Math.round(Math.min(u.ve,u.pe)*o),m=Math.round(Math.max(u.ve,u.pe)*o);if(a!==null&&(f=Math.max(a+1,f),f=Math.min(f,g)),this.zt.he*r>2*h)r0(s,f,p,g-f+1,m-p+1,h);else{const b=g-f+1;s.fillRect(f,p,b,m-p+1)}a=g}}ze(t,e,i){if(this.zt===null)return;const{context:s,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let l="";const h=this.Ie(r);for(let a=i.from;a<i.to;a++){const c=e[a];let u=Math.round(Math.min(c.ve,c.pe)*o),f=Math.round(Math.max(c.ve,c.pe)*o),g=Math.round(c.nt*r)-Math.floor(.5*this.le),p=g+this.le-1;if(c.ue!==l){const m=c.ue;s.fillStyle=m,l=m}this.zt._i&&(g+=h,u+=h,p-=h,f-=h),u>f||s.fillRect(g,u,p-g+1,f-u+1)}}}class C0 extends Bu{constructor(){super(...arguments),this.Ws=new S0}ne(t,e,i){return Object.assign(Object.assign({},this.be(t,e,i)),i.Hs(t))}Gs(){const t=this.Ls.W();this.Ws.J({In:this.Is,he:this.Es.St().he(),Oe:t.wickVisible,_i:t.borderVisible,tt:this.zs})}}class M0{constructor(t,e){this.Ne=t,this.Li=e}X(t,e,i){this.Ne.draw(t,this.Li,e,i)}}class Xn extends Ho{constructor(t,e,i){super(t,e,!1),this.wn=i,this.Ws=new M0(this.wn.renderer(),s=>{const r=t.Ct();return r===null?null:t.Dt().Rt(s,r.Vt)})}Fe(t){return this.wn.priceValueBuilder(t)}We(t){return this.wn.isWhitespace(t)}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(e=>Object.assign(Object.assign({ot:e.se,nt:NaN},t.Hs(e.se)),{je:e.He}))}Ks(t,e){e.Js(this.Is,Yi(this.zs))}Gs(){this.wn.update({bars:this.Is.map(A0),barSpacing:this.Es.St().he(),visibleRange:this.zs},this.Ls.W())}}function A0(n){return{x:n.nt,time:n.ot,originalData:n.je,barColor:n.ue}}class E0 extends jt{constructor(){super(...arguments),this.zt=null,this.$e=[]}J(t){this.zt=t,this.$e=[]}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return;this.$e.length||this.Ue(e);const s=Math.max(1,Math.floor(i)),r=Math.round(this.zt.qe*i)-Math.floor(s/2),o=r+s;for(let l=this.zt.tt.from;l<this.zt.tt.to;l++){const h=this.zt.it[l],a=this.$e[l-this.zt.tt.from],c=Math.round(h.st*i);let u,f;t.fillStyle=h.ue,c<=r?(u=c,f=o):(u=r,f=c-Math.floor(s/2)+s),t.fillRect(a.Vs,u,a.ui-a.Vs+1,f-u)}}Ue(t){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return void(this.$e=[]);const e=Math.ceil(this.zt.he*t)<=1?0:Math.max(1,Math.floor(t)),i=Math.round(this.zt.he*t)-e;this.$e=new Array(this.zt.tt.to-this.zt.tt.from);for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const o=this.zt.it[r],l=Math.round(o.nt*t);let h,a;if(i%2){const c=(i-1)/2;h=l-c,a=l+c}else{const c=i/2;h=l-c,a=l+c-1}this.$e[r-this.zt.tt.from]={Vs:h,ui:a,Ye:l,Ze:o.nt*t,ot:o.ot}}for(let r=this.zt.tt.from+1;r<this.zt.tt.to;r++){const o=this.$e[r-this.zt.tt.from],l=this.$e[r-this.zt.tt.from-1];o.ot===l.ot+1&&o.Vs-l.ui!==e+1&&(l.Ye>l.Ze?l.ui=o.Vs-e-1:o.Vs=l.ui+e+1)}let s=Math.ceil(this.zt.he*t);for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const o=this.$e[r-this.zt.tt.from];o.ui<o.Vs&&(o.ui=o.Vs);const l=o.ui-o.Vs+1;s=Math.min(l,s)}if(e>0&&s<4)for(let r=this.zt.tt.from;r<this.zt.tt.to;r++){const o=this.$e[r-this.zt.tt.from];o.ui-o.Vs+1>s&&(o.Ye>o.Ze?o.ui-=1:o.Vs+=1)}}}class T0 extends Mn{constructor(){super(...arguments),this.Ws=new E0}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t={it:this.Is,he:this.Es.St().he(),tt:this.zs,qe:this.Ls.Dt().Rt(this.Ls.W().base,M(this.Ls.Ct()).Vt)};this.Ws.J(t)}}class D0 extends Mn{constructor(){super(...arguments),this.Ws=new Ou}ne(t,e,i){return Object.assign(Object.assign({},this.te(t,e)),i.Hs(t))}Gs(){const t=this.Ls.W(),e={it:this.Is,Nt:t.lineStyle,ds:t.lineVisible?t.lineType:void 0,et:t.lineWidth,Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,tt:this.zs,cs:this.Es.St().he()};this.Ws.J(e)}}const L0=/[2-9]/g;class Zi{constructor(t=50){this.Xe=0,this.Ke=1,this.Ge=1,this.Je={},this.Qe=new Map,this.tr=t}ir(){this.Xe=0,this.Qe.clear(),this.Ke=1,this.Ge=1,this.Je={}}xi(t,e,i){return this.nr(t,e,i).width}Mi(t,e,i){const s=this.nr(t,e,i);return((s.actualBoundingBoxAscent||0)-(s.actualBoundingBoxDescent||0))/2}nr(t,e,i){const s=i||L0,r=String(e).replace(s,"0");if(this.Qe.has(r))return St(this.Qe.get(r)).sr;if(this.Xe===this.tr){const l=this.Je[this.Ge];delete this.Je[this.Ge],this.Qe.delete(l),this.Ge++,this.Xe--}t.save(),t.textBaseline="middle";const o=t.measureText(r);return t.restore(),o.width===0&&e.length||(this.Qe.set(r,{sr:o,er:this.Ke}),this.Je[this.Ke]=r,this.Xe++,this.Ke++),o}}class O0{constructor(t){this.rr=null,this.k=null,this.hr="right",this.lr=t}ar(t,e,i){this.rr=t,this.k=e,this.hr=i}X(t){this.k!==null&&this.rr!==null&&this.rr.X(t,this.k,this.lr,this.hr)}}class _u{constructor(t,e,i){this._r=t,this.lr=new Zi(50),this.ur=e,this.F=i,this.j=-1,this.Wt=new O0(this.lr)}gt(){const t=this.F.cr(this.ur);if(t===null)return null;const e=t.dr(this.ur)?t.vr():this.ur.Dt();if(e===null)return null;const i=t.pr(e);if(i==="overlay")return null;const s=this.F.mr();return s.P!==this.j&&(this.j=s.P,this.lr.ir()),this.Wt.ar(this._r.Ii(),s,i),this.Wt}}class P0 extends jt{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}br(t,e){var i;if(!(!((i=this.zt)===null||i===void 0)&&i.yt))return null;const{st:s,et:r,wr:o}=this.zt;return e>=s-r-7&&e<=s+r+7?{gr:this.zt,wr:o}:null}K({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.zt===null||this.zt.yt===!1)return;const r=Math.round(this.zt.st*s);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.zt.V,t.lineWidth=Math.floor(this.zt.et*i),He(t,this.zt.Nt),xu(t,r,0,e.width))}}class jo{constructor(t){this.Mr={st:0,V:"rgba(0, 0, 0, 0)",et:1,Nt:0,yt:!1},this.Sr=new P0,this.ft=!0,this.Ls=t,this.Es=t.$t(),this.Sr.J(this.Mr)}bt(){this.ft=!0}gt(){return this.Ls.yt()?(this.ft&&(this.kr(),this.ft=!1),this.Sr):null}}class N0 extends jo{constructor(t){super(t)}kr(){this.Mr.yt=!1;const t=this.Ls.Dt(),e=t.yr().yr;if(e!==2&&e!==3)return;const i=this.Ls.W();if(!i.baseLineVisible||!this.Ls.yt())return;const s=this.Ls.Ct();s!==null&&(this.Mr.yt=!0,this.Mr.st=t.Rt(s.Vt,s.Vt),this.Mr.V=i.baseLineColor,this.Mr.et=i.baseLineWidth,this.Mr.Nt=i.baseLineStyle)}}class z0 extends jt{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}He(){return this.zt}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const s=this.zt;if(s===null)return;const r=Math.max(1,Math.floor(e)),o=r%2/2,l=Math.round(s.Ze.x*e)+o,h=s.Ze.y*i;t.fillStyle=s.Cr,t.beginPath();const a=Math.max(2,1.5*s.Tr)*e;t.arc(l,h,a,0,2*Math.PI,!1),t.fill(),t.fillStyle=s.Pr,t.beginPath(),t.arc(l,h,s.ht*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=s.Rr,t.beginPath(),t.arc(l,h,s.ht*e+r/2,0,2*Math.PI,!1),t.stroke()}}const B0=[{Dr:0,Vr:.25,Or:4,Br:10,Ar:.25,Ir:0,zr:.4,Lr:.8},{Dr:.25,Vr:.525,Or:10,Br:14,Ar:0,Ir:0,zr:.8,Lr:0},{Dr:.525,Vr:1,Or:14,Br:14,Ar:0,Ir:0,zr:0,Lr:0}];function zh(n,t,e,i){return function(s,r){if(s==="transparent")return s;const o=qi(s),l=o[3];return`rgba(${o[0]}, ${o[1]}, ${o[2]}, ${r*l})`}(n,e+(i-e)*t)}function Bh(n,t){const e=n%2600/2600;let i;for(const h of B0)if(e>=h.Dr&&e<=h.Vr){i=h;break}De(i!==void 0,"Last price animation internal logic error");const s=(e-i.Dr)/(i.Vr-i.Dr);return{Pr:zh(t,s,i.Ar,i.Ir),Rr:zh(t,s,i.zr,i.Lr),ht:(r=s,o=i.Or,l=i.Br,o+(l-o)*r)};var r,o,l}class _0{constructor(t){this.Wt=new z0,this.ft=!0,this.Er=!0,this.Nr=performance.now(),this.Fr=this.Nr-1,this.Wr=t}jr(){this.Fr=this.Nr-1,this.bt()}Hr(){if(this.bt(),this.Wr.W().lastPriceAnimation===2){const t=performance.now(),e=this.Fr-t;if(e>0)return void(e<650&&(this.Fr+=2600));this.Nr=t,this.Fr=t+2600}}bt(){this.ft=!0}$r(){this.Er=!0}yt(){return this.Wr.W().lastPriceAnimation!==0}Ur(){switch(this.Wr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Fr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Er=!1):this.Er&&(this.qr(),this.Er=!1),this.Wt}Mt(){this.Wt.J(null);const t=this.Wr.$t().St(),e=t.Zs(),i=this.Wr.Ct();if(e===null||i===null)return;const s=this.Wr.Yr(!0);if(s.Zr||!e.Xr(s.se))return;const r={x:t.It(s.se),y:this.Wr.Dt().Rt(s._t,i.Vt)},o=s.V,l=this.Wr.W().lineWidth,h=Bh(this.Kr(),o);this.Wt.J({Cr:o,Tr:l,Pr:h.Pr,Rr:h.Rr,ht:h.ht,Ze:r})}qr(){const t=this.Wt.He();if(t!==null){const e=Bh(this.Kr(),t.Cr);t.Pr=e.Pr,t.Rr=e.Rr,t.ht=e.ht}}Kr(){return this.Ur()?performance.now()-this.Nr:2599}}function _i(n,t){return Du(Math.min(Math.max(n,12),30)*t)}function Qi(n,t){switch(n){case"arrowDown":case"arrowUp":return _i(t,1);case"circle":return _i(t,.8);case"square":return _i(t,.7)}}function Ru(n){return function(t){const e=Math.ceil(t);return e%2!=0?e-1:e}(_i(n,1))}function _h(n){return Math.max(_i(n,.1),3)}function Rh(n,t,e){return t?n:e?Math.ceil(n/2):0}function Fu(n,t,e,i,s){const r=Qi("square",e),o=(r-1)/2,l=n-o,h=t-o;return i>=l&&i<=l+r&&s>=h&&s<=h+r}function Fh(n,t,e,i){const s=(Qi("arrowUp",i)-1)/2*e.Gr,r=(Du(i/2)-1)/2*e.Gr;t.beginPath(),n?(t.moveTo(e.nt-s,e.st),t.lineTo(e.nt,e.st-s),t.lineTo(e.nt+s,e.st),t.lineTo(e.nt+r,e.st),t.lineTo(e.nt+r,e.st+s),t.lineTo(e.nt-r,e.st+s),t.lineTo(e.nt-r,e.st)):(t.moveTo(e.nt-s,e.st),t.lineTo(e.nt,e.st+s),t.lineTo(e.nt+s,e.st),t.lineTo(e.nt+r,e.st),t.lineTo(e.nt+r,e.st-s),t.lineTo(e.nt-r,e.st-s),t.lineTo(e.nt-r,e.st)),t.fill()}function R0(n,t,e,i,s,r){return Fu(t,e,i,s,r)}class F0 extends jt{constructor(){super(...arguments),this.zt=null,this.lr=new Zi,this.j=-1,this.H="",this.Jr=""}J(t){this.zt=t}ar(t,e){this.j===t&&this.H===e||(this.j=t,this.H=e,this.Jr=di(t,e),this.lr.ir())}br(t,e){if(this.zt===null||this.zt.tt===null)return null;for(let i=this.zt.tt.from;i<this.zt.tt.to;i++){const s=this.zt.it[i];if(I0(s,t,e))return{gr:s.Qr,wr:s.wr}}return null}K({context:t,horizontalPixelRatio:e,verticalPixelRatio:i},s,r){if(this.zt!==null&&this.zt.tt!==null){t.textBaseline="middle",t.font=this.Jr;for(let o=this.zt.tt.from;o<this.zt.tt.to;o++){const l=this.zt.it[o];l.Kt!==void 0&&(l.Kt.Hi=this.lr.xi(t,l.Kt.th),l.Kt.At=this.j,l.Kt.nt=l.nt-l.Kt.Hi/2),V0(l,t,e,i)}}}}function V0(n,t,e,i){t.fillStyle=n.V,n.Kt!==void 0&&function(s,r,o,l,h,a){s.save(),s.scale(h,a),s.fillText(r,o,l),s.restore()}(t,n.Kt.th,n.Kt.nt,n.Kt.st,e,i),function(s,r,o){if(s.Xs!==0){switch(s.ih){case"arrowDown":return void Fh(!1,r,o,s.Xs);case"arrowUp":return void Fh(!0,r,o,s.Xs);case"circle":return void function(l,h,a){const c=(Qi("circle",a)-1)/2;l.beginPath(),l.arc(h.nt,h.st,c*h.Gr,0,2*Math.PI,!1),l.fill()}(r,o,s.Xs);case"square":return void function(l,h,a){const c=Qi("square",a),u=(c-1)*h.Gr/2,f=h.nt-u,g=h.st-u;l.fillRect(f,g,c*h.Gr,c*h.Gr)}(r,o,s.Xs)}s.ih}}(n,t,function(s,r,o){const l=Math.max(1,Math.floor(r))%2/2;return{nt:Math.round(s.nt*r)+l,st:s.st*o,Gr:r}}(n,e,i))}function I0(n,t,e){return!(n.Kt===void 0||!function(i,s,r,o,l,h){const a=o/2;return l>=i&&l<=i+r&&h>=s-a&&h<=s+a}(n.Kt.nt,n.Kt.st,n.Kt.Hi,n.Kt.At,t,e))||function(i,s,r){if(i.Xs===0)return!1;switch(i.ih){case"arrowDown":case"arrowUp":return R0(0,i.nt,i.st,i.Xs,s,r);case"circle":return function(o,l,h,a,c){const u=2+Qi("circle",h)/2,f=o-a,g=l-c;return Math.sqrt(f*f+g*g)<=u}(i.nt,i.st,i.Xs,s,r);case"square":return Fu(i.nt,i.st,i.Xs,s,r)}}(n,t,e)}function W0(n,t,e,i,s,r,o,l,h){const a=Zt(e)?e:e.xe,c=Zt(e)?e:e.ge,u=Zt(e)?e:e.Me,f=Zt(t.size)?Math.max(t.size,0):1,g=Ru(l.he())*f,p=g/2;switch(n.Xs=g,t.position){case"inBar":return n.st=o.Rt(a,h),void(n.Kt!==void 0&&(n.Kt.st=n.st+p+r+.6*s));case"aboveBar":return n.st=o.Rt(c,h)-p-i.nh,n.Kt!==void 0&&(n.Kt.st=n.st-p-.6*s,i.nh+=1.2*s),void(i.nh+=g+r);case"belowBar":return n.st=o.Rt(u,h)+p+i.sh,n.Kt!==void 0&&(n.Kt.st=n.st+p+r+.6*s,i.sh+=1.2*s),void(i.sh+=g+r)}t.position}class H0{constructor(t,e){this.ft=!0,this.eh=!0,this.rh=!0,this.hh=null,this.ah=null,this.Wt=new F0,this.Wr=t,this.$i=e,this.zt={it:[],tt:null}}bt(t){this.ft=!0,this.rh=!0,t==="data"&&(this.eh=!0,this.ah=null)}gt(t){if(!this.Wr.yt())return null;this.ft&&this.oh();const e=this.$i.W().layout;return this.Wt.ar(e.fontSize,e.fontFamily),this.Wt.J(this.zt),this.Wt}_h(){if(this.rh){if(this.Wr.uh().length>0){const t=this.$i.St().he(),e=_h(t),i=1.5*Ru(t)+2*e,s=this.dh();this.hh={above:Rh(i,s.aboveBar,s.inBar),below:Rh(i,s.belowBar,s.inBar)}}else this.hh=null;this.rh=!1}return this.hh}dh(){return this.ah===null&&(this.ah=this.Wr.uh().reduce((t,e)=>(t[e.position]||(t[e.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1})),this.ah}oh(){const t=this.Wr.Dt(),e=this.$i.St(),i=this.Wr.uh();this.eh&&(this.zt.it=i.map(c=>({ot:c.time,nt:0,st:0,Xs:0,ih:c.shape,V:c.color,Qr:c.Qr,wr:c.id,Kt:void 0})),this.eh=!1);const s=this.$i.W().layout;this.zt.tt=null;const r=e.Zs();if(r===null)return;const o=this.Wr.Ct();if(o===null||this.zt.it.length===0)return;let l=NaN;const h=_h(e.he()),a={nh:h,sh:h};this.zt.tt=zu(this.zt.it,r,!0);for(let c=this.zt.tt.from;c<this.zt.tt.to;c++){const u=i[c];u.time!==l&&(a.nh=h,a.sh=h,l=u.time);const f=this.zt.it[c];f.nt=e.It(u.time),u.text!==void 0&&u.text.length>0&&(f.Kt={th:u.text,nt:0,st:0,Hi:0,At:0});const g=this.Wr.fh(u.time);g!==null&&W0(f,u,g,a,s.fontSize,h,t,e,o.Vt)}this.ft=!1}}class j0 extends jo{constructor(t){super(t)}kr(){const t=this.Mr;t.yt=!1;const e=this.Ls.W();if(!e.priceLineVisible||!this.Ls.yt())return;const i=this.Ls.Yr(e.priceLineSource===0);i.Zr||(t.yt=!0,t.st=i.ki,t.V=this.Ls.ph(i.V),t.et=e.priceLineWidth,t.Nt=e.priceLineStyle)}}class K0 extends kn{constructor(t){super(),this.jt=t}zi(t,e,i){t.yt=!1,e.yt=!1;const s=this.jt;if(!s.yt())return;const r=s.W(),o=r.lastValueVisible,l=s.mh()!=="",h=r.seriesLastValueMode===0,a=s.Yr(!1);if(a.Zr)return;o&&(t.Kt=this.bh(a,o,h),t.yt=t.Kt.length!==0),(l||h)&&(e.Kt=this.wh(a,o,l,h),e.yt=e.Kt.length>0);const c=s.ph(a.V),u=yn(c);i.t=u.t,i.ki=a.ki,e.Ot=s.$t().Bt(a.ki/s.Dt().At()),t.Ot=c,t.V=u.i,e.V=u.i}wh(t,e,i,s){let r="";const o=this.jt.mh();return i&&o.length!==0&&(r+=`${o} `),e&&s&&(r+=this.jt.Dt().gh()?t.Mh:t.xh),r.trim()}bh(t,e,i){return e?i?this.jt.Dt().gh()?t.xh:t.Mh:t.Kt:""}}function Vh(n,t,e,i){const s=Number.isFinite(t),r=Number.isFinite(e);return s&&r?n(t,e):s||r?s?t:e:i}class Tt{constructor(t,e){this.Sh=t,this.kh=e}yh(t){return t!==null&&this.Sh===t.Sh&&this.kh===t.kh}Ch(){return new Tt(this.Sh,this.kh)}Th(){return this.Sh}Ph(){return this.kh}Rh(){return this.kh-this.Sh}Ni(){return this.kh===this.Sh||Number.isNaN(this.kh)||Number.isNaN(this.Sh)}ts(t){return t===null?this:new Tt(Vh(Math.min,this.Th(),t.Th(),-1/0),Vh(Math.max,this.Ph(),t.Ph(),1/0))}Dh(t){if(!Zt(t)||this.kh-this.Sh===0)return;const e=.5*(this.kh+this.Sh);let i=this.kh-e,s=this.Sh-e;i*=t,s*=t,this.kh=e+i,this.Sh=e+s}Vh(t){Zt(t)&&(this.kh+=t,this.Sh+=t)}Oh(){return{minValue:this.Sh,maxValue:this.kh}}static Bh(t){return t===null?null:new Tt(t.minValue,t.maxValue)}}class un{constructor(t,e){this.Ah=t,this.Ih=e||null}zh(){return this.Ah}Lh(){return this.Ih}Oh(){return this.Ah===null?null:{priceRange:this.Ah.Oh(),margins:this.Ih||void 0}}static Bh(t){return t===null?null:new un(Tt.Bh(t.priceRange),t.margins)}}class $0 extends jo{constructor(t,e){super(t),this.Eh=e}kr(){const t=this.Mr;t.yt=!1;const e=this.Eh.W();if(!this.Ls.yt()||!e.lineVisible)return;const i=this.Eh.Nh();i!==null&&(t.yt=!0,t.st=i,t.V=e.color,t.et=e.lineWidth,t.Nt=e.lineStyle,t.wr=this.Eh.W().id)}}class U0 extends kn{constructor(t,e){super(),this.Wr=t,this.Eh=e}zi(t,e,i){t.yt=!1,e.yt=!1;const s=this.Eh.W(),r=s.axisLabelVisible,o=s.title!=="",l=this.Wr;if(!r||!l.yt())return;const h=this.Eh.Nh();if(h===null)return;o&&(e.Kt=s.title,e.yt=!0),e.Ot=l.$t().Bt(h/l.Dt().At()),t.Kt=this.Fh(s.price),t.yt=!0;const a=yn(s.axisLabelColor||s.color);i.t=a.t;const c=s.axisLabelTextColor||a.i;t.V=c,e.V=c,i.ki=h}Fh(t){const e=this.Wr.Ct();return e===null?"":this.Wr.Dt().Fi(t,e.Vt)}}class X0{constructor(t,e){this.Wr=t,this.cn=e,this.Wh=new $0(t,this),this._r=new U0(t,this),this.jh=new _u(this._r,t,t.$t())}Hh(t){Wt(this.cn,t),this.bt(),this.Wr.$t().$h()}W(){return this.cn}Uh(){return this.Wh}qh(){return this.jh}Yh(){return this._r}bt(){this.Wh.bt(),this._r.bt()}Nh(){const t=this.Wr,e=t.Dt();if(t.$t().St().Ni()||e.Ni())return null;const i=t.Ct();return i===null?null:e.Rt(this.cn.price,i.Vt)}}class G0 extends Io{constructor(t){super(),this.$i=t}$t(){return this.$i}}const q0={Bar:(n,t,e,i)=>{var s;const r=t.upColor,o=t.downColor,l=M(n(e,i)),h=Je(l.Vt[0])<=Je(l.Vt[3]);return{ue:(s=l.V)!==null&&s!==void 0?s:h?r:o}},Candlestick:(n,t,e,i)=>{var s,r,o;const l=t.upColor,h=t.downColor,a=t.borderUpColor,c=t.borderDownColor,u=t.wickUpColor,f=t.wickDownColor,g=M(n(e,i)),p=Je(g.Vt[0])<=Je(g.Vt[3]);return{ue:(s=g.V)!==null&&s!==void 0?s:p?l:h,Ee:(r=g.Ot)!==null&&r!==void 0?r:p?a:c,Le:(o=g.Zh)!==null&&o!==void 0?o:p?u:f}},Custom:(n,t,e,i)=>{var s;return{ue:(s=M(n(e,i)).V)!==null&&s!==void 0?s:t.color}},Area:(n,t,e,i)=>{var s,r,o,l;const h=M(n(e,i));return{ue:(s=h.lt)!==null&&s!==void 0?s:t.lineColor,lt:(r=h.lt)!==null&&r!==void 0?r:t.lineColor,Ts:(o=h.Ts)!==null&&o!==void 0?o:t.topColor,Ps:(l=h.Ps)!==null&&l!==void 0?l:t.bottomColor}},Baseline:(n,t,e,i)=>{var s,r,o,l,h,a;const c=M(n(e,i));return{ue:c.Vt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,Pe:(s=c.Pe)!==null&&s!==void 0?s:t.topLineColor,Re:(r=c.Re)!==null&&r!==void 0?r:t.bottomLineColor,Se:(o=c.Se)!==null&&o!==void 0?o:t.topFillColor1,ke:(l=c.ke)!==null&&l!==void 0?l:t.topFillColor2,ye:(h=c.ye)!==null&&h!==void 0?h:t.bottomFillColor1,Ce:(a=c.Ce)!==null&&a!==void 0?a:t.bottomFillColor2}},Line:(n,t,e,i)=>{var s,r;const o=M(n(e,i));return{ue:(s=o.V)!==null&&s!==void 0?s:t.color,lt:(r=o.V)!==null&&r!==void 0?r:t.color}},Histogram:(n,t,e,i)=>{var s;return{ue:(s=M(n(e,i)).V)!==null&&s!==void 0?s:t.color}}};class J0{constructor(t){this.Xh=(e,i)=>i!==void 0?i.Vt:this.Wr.In().Kh(e),this.Wr=t,this.Gh=q0[t.Jh()]}Hs(t,e){return this.Gh(this.Xh,this.Wr.W(),t,e)}}var Ih;(function(n){n[n.NearestLeft=-1]="NearestLeft",n[n.None=0]="None",n[n.NearestRight=1]="NearestRight"})(Ih||(Ih={}));const ge=30;class Y0{constructor(){this.Qh=[],this.tl=new Map,this.il=new Map}nl(){return this.Xs()>0?this.Qh[this.Qh.length-1]:null}sl(){return this.Xs()>0?this.el(0):null}An(){return this.Xs()>0?this.el(this.Qh.length-1):null}Xs(){return this.Qh.length}Ni(){return this.Xs()===0}Xr(t){return this.rl(t,0)!==null}Kh(t){return this.hl(t)}hl(t,e=0){const i=this.rl(t,e);return i===null?null:Object.assign(Object.assign({},this.ll(i)),{se:this.el(i)})}ie(){return this.Qh}al(t,e,i){if(this.Ni())return null;let s=null;for(const r of i)s=Ls(s,this.ol(t,e,r));return s}J(t){this.il.clear(),this.tl.clear(),this.Qh=t}el(t){return this.Qh[t].se}ll(t){return this.Qh[t]}rl(t,e){const i=this._l(t);if(i===null&&e!==0)switch(e){case-1:return this.ul(t);case 1:return this.cl(t);default:throw new TypeError("Unknown search mode")}return i}ul(t){let e=this.dl(t);return e>0&&(e-=1),e!==this.Qh.length&&this.el(e)<t?e:null}cl(t){const e=this.fl(t);return e!==this.Qh.length&&t<this.el(e)?e:null}_l(t){const e=this.dl(t);return e===this.Qh.length||t<this.Qh[e].se?null:e}dl(t){return as(this.Qh,t,(e,i)=>e.se<i)}fl(t){return Nu(this.Qh,t,(e,i)=>e.se>i)}vl(t,e,i){let s=null;for(let r=t;r<e;r++){const o=this.Qh[r].Vt[i];Number.isNaN(o)||(s===null?s={pl:o,ml:o}:(o<s.pl&&(s.pl=o),o>s.ml&&(s.ml=o)))}return s}ol(t,e,i){if(this.Ni())return null;let s=null;const r=M(this.sl()),o=M(this.An()),l=Math.max(t,r),h=Math.min(e,o),a=Math.ceil(l/ge)*ge,c=Math.max(a,Math.floor(h/ge)*ge);{const f=this.dl(l),g=this.fl(Math.min(h,a,e));s=Ls(s,this.vl(f,g,i))}let u=this.tl.get(i);u===void 0&&(u=new Map,this.tl.set(i,u));for(let f=Math.max(a+1,l);f<c;f+=ge){const g=Math.floor(f/ge);let p=u.get(g);if(p===void 0){const m=this.dl(g*ge),b=this.fl((g+1)*ge-1);p=this.vl(m,b,i),u.set(g,p)}s=Ls(s,p)}{const f=this.dl(c),g=this.fl(h);s=Ls(s,this.vl(f,g,i))}return s}}function Ls(n,t){return n===null?t:t===null?n:{pl:Math.min(n.pl,t.pl),ml:Math.max(n.ml,t.ml)}}class Z0{constructor(t){this.bl=t}X(t,e,i){this.bl.draw(t)}wl(t,e,i){var s,r;(r=(s=this.bl).drawBackground)===null||r===void 0||r.call(s,t)}}class Gn{constructor(t){this.Qe=null,this.wn=t}gt(){var t;const e=this.wn.renderer();if(e===null)return null;if(((t=this.Qe)===null||t===void 0?void 0:t.gl)===e)return this.Qe.Ml;const i=new Z0(e);return this.Qe={gl:e,Ml:i},i}xl(){var t,e,i;return(i=(e=(t=this.wn).zOrder)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:"normal"}}function Vu(n){var t,e,i,s,r;return{Kt:n.text(),ki:n.coordinate(),Si:(t=n.fixedCoordinate)===null||t===void 0?void 0:t.call(n),V:n.textColor(),t:n.backColor(),yt:(i=(e=n.visible)===null||e===void 0?void 0:e.call(n))===null||i===void 0||i,hi:(r=(s=n.tickVisible)===null||s===void 0?void 0:s.call(n))===null||r===void 0||r}}class Q0{constructor(t,e){this.Wt=new Mu,this.Sl=t,this.kl=e}gt(){return this.Wt.J(Object.assign({Hi:this.kl.Hi()},Vu(this.Sl))),this.Wt}}class tb extends kn{constructor(t,e){super(),this.Sl=t,this.Li=e}zi(t,e,i){const s=Vu(this.Sl);i.t=s.t,t.V=s.V;const r=2/12*this.Li.P();i.wi=r,i.gi=r,i.ki=s.ki,i.Si=s.Si,t.Kt=s.Kt,t.yt=s.yt,t.hi=s.hi}}class eb{constructor(t,e){this.yl=null,this.Cl=null,this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=t,this.Wr=e}Vl(){return this.Dl}Vn(){var t,e;(e=(t=this.Dl).updateAllViews)===null||e===void 0||e.call(t)}Pn(){var t,e,i,s;const r=(i=(e=(t=this.Dl).paneViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((s=this.yl)===null||s===void 0?void 0:s.gl)===r)return this.yl.Ml;const o=r.map(l=>new Gn(l));return this.yl={gl:r,Ml:o},o}Qi(){var t,e,i,s;const r=(i=(e=(t=this.Dl).timeAxisViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((s=this.Cl)===null||s===void 0?void 0:s.gl)===r)return this.Cl.Ml;const o=this.Wr.$t().St(),l=r.map(h=>new Q0(h,o));return this.Cl={gl:r,Ml:l},l}Rn(){var t,e,i,s;const r=(i=(e=(t=this.Dl).priceAxisViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((s=this.Tl)===null||s===void 0?void 0:s.gl)===r)return this.Tl.Ml;const o=this.Wr.Dt(),l=r.map(h=>new tb(h,o));return this.Tl={gl:r,Ml:l},l}Ol(){var t,e,i,s;const r=(i=(e=(t=this.Dl).priceAxisPaneViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((s=this.Pl)===null||s===void 0?void 0:s.gl)===r)return this.Pl.Ml;const o=r.map(l=>new Gn(l));return this.Pl={gl:r,Ml:o},o}Bl(){var t,e,i,s;const r=(i=(e=(t=this.Dl).timeAxisPaneViews)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:[];if(((s=this.Rl)===null||s===void 0?void 0:s.gl)===r)return this.Rl.Ml;const o=r.map(l=>new Gn(l));return this.Rl={gl:r,Ml:o},o}Al(t,e){var i,s,r;return(r=(s=(i=this.Dl).autoscaleInfo)===null||s===void 0?void 0:s.call(i,t,e))!==null&&r!==void 0?r:null}br(t,e){var i,s,r;return(r=(s=(i=this.Dl).hitTest)===null||s===void 0?void 0:s.call(i,t,e))!==null&&r!==void 0?r:null}}function qn(n,t,e,i){n.forEach(s=>{t(s).forEach(r=>{r.xl()===e&&i.push(r)})})}function Jn(n){return n.Pn()}function ib(n){return n.Ol()}function sb(n){return n.Bl()}class Ko extends G0{constructor(t,e,i,s,r){super(t),this.zt=new Y0,this.Wh=new j0(this),this.Il=[],this.zl=new N0(this),this.Ll=null,this.El=null,this.Nl=[],this.Fl=[],this.Wl=null,this.jl=[],this.cn=e,this.Hl=i;const o=new K0(this);this.rn=[o],this.jh=new _u(o,this,t),i!=="Area"&&i!=="Line"&&i!=="Baseline"||(this.Ll=new _0(this)),this.$l(),this.Ul(r)}S(){this.Wl!==null&&clearTimeout(this.Wl)}ph(t){return this.cn.priceLineColor||t}Yr(t){const e={Zr:!0},i=this.Dt();if(this.$t().St().Ni()||i.Ni()||this.zt.Ni())return e;const s=this.$t().St().Zs(),r=this.Ct();if(s===null||r===null)return e;let o,l;if(t){const u=this.zt.nl();if(u===null)return e;o=u,l=u.se}else{const u=this.zt.hl(s.ui(),-1);if(u===null||(o=this.zt.Kh(u.se),o===null))return e;l=u.se}const h=o.Vt[3],a=this.$s().Hs(l,{Vt:o}),c=i.Rt(h,r.Vt);return{Zr:!1,_t:h,Kt:i.Fi(h,r.Vt),Mh:i.ql(h),xh:i.Yl(h,r.Vt),V:a.ue,ki:c,se:l}}$s(){return this.El!==null||(this.El=new J0(this)),this.El}W(){return this.cn}Hh(t){const e=t.priceScaleId;e!==void 0&&e!==this.cn.priceScaleId&&this.$t().Zl(this,e),Wt(this.cn,t),t.priceFormat!==void 0&&(this.$l(),this.$t().Xl()),this.$t().Kl(this),this.$t().Gl(),this.wn.bt("options")}J(t,e){this.zt.J(t),this.Jl(),this.wn.bt("data"),this.dn.bt("data"),this.Ll!==null&&(e&&e.Ql?this.Ll.Hr():t.length===0&&this.Ll.jr());const i=this.$t().cr(this);this.$t().ta(i),this.$t().Kl(this),this.$t().Gl(),this.$t().$h()}ia(t){this.Nl=t,this.Jl();const e=this.$t().cr(this);this.dn.bt("data"),this.$t().ta(e),this.$t().Kl(this),this.$t().Gl(),this.$t().$h()}na(){return this.Nl}uh(){return this.Fl}sa(t){const e=new X0(this,t);return this.Il.push(e),this.$t().Kl(this),e}ea(t){const e=this.Il.indexOf(t);e!==-1&&this.Il.splice(e,1),this.$t().Kl(this)}Jh(){return this.Hl}Ct(){const t=this.ra();return t===null?null:{Vt:t.Vt[3],ha:t.ot}}ra(){const t=this.$t().St().Zs();if(t===null)return null;const e=t.Vs();return this.zt.hl(e,1)}In(){return this.zt}fh(t){const e=this.zt.Kh(t);return e===null?null:this.Hl==="Bar"||this.Hl==="Candlestick"||this.Hl==="Custom"?{we:e.Vt[0],ge:e.Vt[1],Me:e.Vt[2],xe:e.Vt[3]}:e.Vt[3]}la(t){const e=[];qn(this.jl,Jn,"top",e);const i=this.Ll;return i!==null&&i.yt()&&(this.Wl===null&&i.Ur()&&(this.Wl=setTimeout(()=>{this.Wl=null,this.$t().aa()},0)),i.$r(),e.unshift(i)),e}Pn(){const t=[];this.oa()||t.push(this.zl),t.push(this.wn,this.Wh,this.dn);const e=this.Il.map(i=>i.Uh());return t.push(...e),qn(this.jl,Jn,"normal",t),t}_a(){return this.ua(Jn,"bottom")}ca(t){return this.ua(ib,t)}da(t){return this.ua(sb,t)}fa(t,e){return this.jl.map(i=>i.br(t,e)).filter(i=>i!==null)}Ji(t){return[this.jh,...this.Il.map(e=>e.qh())]}Rn(t,e){if(e!==this.Yi&&!this.oa())return[];const i=[...this.rn];for(const s of this.Il)i.push(s.Yh());return this.jl.forEach(s=>{i.push(...s.Rn())}),i}Qi(){const t=[];return this.jl.forEach(e=>{t.push(...e.Qi())}),t}Al(t,e){if(this.cn.autoscaleInfoProvider!==void 0){const i=this.cn.autoscaleInfoProvider(()=>{const s=this.va(t,e);return s===null?null:s.Oh()});return un.Bh(i)}return this.va(t,e)}pa(){return this.cn.priceFormat.minMove}ma(){return this.ba}Vn(){var t;this.wn.bt(),this.dn.bt();for(const e of this.rn)e.bt();for(const e of this.Il)e.bt();this.Wh.bt(),this.zl.bt(),(t=this.Ll)===null||t===void 0||t.bt(),this.jl.forEach(e=>e.Vn())}Dt(){return M(super.Dt())}kt(t){if(!((this.Hl==="Line"||this.Hl==="Area"||this.Hl==="Baseline")&&this.cn.crosshairMarkerVisible))return null;const e=this.zt.Kh(t);return e===null?null:{_t:e.Vt[3],ht:this.wa(),Ot:this.ga(),Pt:this.Ma(),Tt:this.xa(t)}}mh(){return this.cn.title}yt(){return this.cn.visible}Sa(t){this.jl.push(new eb(t,this))}ka(t){this.jl=this.jl.filter(e=>e.Vl()!==t)}ya(){if(this.wn instanceof Xn)return t=>this.wn.Fe(t)}Ca(){if(this.wn instanceof Xn)return t=>this.wn.We(t)}oa(){return!Sn(this.Dt().Ta())}va(t,e){if(!Ji(t)||!Ji(e)||this.zt.Ni())return null;const i=this.Hl==="Line"||this.Hl==="Area"||this.Hl==="Baseline"||this.Hl==="Histogram"?[3]:[2,1],s=this.zt.al(t,e,i);let r=s!==null?new Tt(s.pl,s.ml):null;if(this.Jh()==="Histogram"){const l=this.cn.base,h=new Tt(l,l);r=r!==null?r.ts(h):h}let o=this.dn._h();return this.jl.forEach(l=>{const h=l.Al(t,e);if(h?.priceRange){const g=new Tt(h.priceRange.minValue,h.priceRange.maxValue);r=r!==null?r.ts(g):g}var a,c,u,f;h?.margins&&(a=o,c=h.margins,o={above:Math.max((u=a?.above)!==null&&u!==void 0?u:0,c.above),below:Math.max((f=a?.below)!==null&&f!==void 0?f:0,c.below)})}),new un(r,o)}wa(){switch(this.Hl){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}ga(){switch(this.Hl){case"Line":case"Area":case"Baseline":{const t=this.cn.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}Ma(){switch(this.Hl){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}xa(t){switch(this.Hl){case"Line":case"Area":case"Baseline":{const e=this.cn.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.$s().Hs(t).ue}$l(){switch(this.cn.priceFormat.type){case"custom":this.ba={format:this.cn.priceFormat.formatter};break;case"volume":this.ba=new c0(this.cn.priceFormat.precision);break;case"percent":this.ba=new Au(this.cn.priceFormat.precision);break;default:{const t=Math.pow(10,this.cn.priceFormat.precision);this.ba=new Cn(t,this.cn.priceFormat.minMove*t)}}this.Yi!==null&&this.Yi.Pa()}Jl(){const t=this.$t().St();if(!t.Ra()||this.zt.Ni())return void(this.Fl=[]);const e=M(this.zt.sl());this.Fl=this.Nl.map((i,s)=>{const r=M(t.Da(i.time,!0)),o=r<e?1:-1;return{time:M(this.zt.hl(r,o)).se,position:i.position,shape:i.shape,color:i.color,id:i.id,Qr:s,text:i.text,size:i.size,originalTime:i.originalTime}})}Ul(t){switch(this.dn=new H0(this,this.$t()),this.Hl){case"Bar":this.wn=new w0(this,this.$t());break;case"Candlestick":this.wn=new C0(this,this.$t());break;case"Line":this.wn=new D0(this,this.$t());break;case"Custom":this.wn=new Xn(this,this.$t(),St(t));break;case"Area":this.wn=new b0(this,this.$t());break;case"Baseline":this.wn=new k0(this,this.$t());break;case"Histogram":this.wn=new T0(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.Hl)}}ua(t,e){const i=[];return qn(this.jl,t,e,i),i}}class nb{constructor(t){this.cn=t}Va(t,e,i){let s=t;if(this.cn.mode===0)return s;const r=i.vn(),o=r.Ct();if(o===null)return s;const l=r.Rt(t,o),h=i.Oa().filter(c=>c instanceof Ko).reduce((c,u)=>{if(i.dr(u)||!u.yt())return c;const f=u.Dt(),g=u.In();if(f.Ni()||!g.Xr(e))return c;const p=g.Kh(e);if(p===null)return c;const m=Je(u.Ct());return c.concat([f.Rt(p.Vt[3],m.Vt)])},[]);if(h.length===0)return s;h.sort((c,u)=>Math.abs(c-l)-Math.abs(u-l));const a=h[0];return s=r.pn(a,o),s}}class rb extends jt{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}K({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.zt===null)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r,function(o,l){o.save(),o.lineWidth%2&&o.translate(.5,.5),l(),o.restore()}(t,()=>{const o=M(this.zt);if(o.Ba){t.strokeStyle=o.Aa,He(t,o.Ia),t.beginPath();for(const l of o.za){const h=Math.round(l.La*i);t.moveTo(h,-r),t.lineTo(h,e.height+r)}t.stroke()}if(o.Ea){t.strokeStyle=o.Na,He(t,o.Fa),t.beginPath();for(const l of o.Wa){const h=Math.round(l.La*s);t.moveTo(-r,h),t.lineTo(e.width+r,h)}t.stroke()}})}}class ob{constructor(t){this.Wt=new rb,this.ft=!0,this.tn=t}bt(){this.ft=!0}gt(){if(this.ft){const t=this.tn.$t().W().grid,e={Ea:t.horzLines.visible,Ba:t.vertLines.visible,Na:t.horzLines.color,Aa:t.vertLines.color,Fa:t.horzLines.style,Ia:t.vertLines.style,Wa:this.tn.vn().ja(),za:(this.tn.$t().St().ja()||[]).map(i=>({La:i.coord}))};this.Wt.J(e),this.ft=!1}return this.Wt}}class lb{constructor(t){this.wn=new ob(t)}Uh(){return this.wn}}const Yn={Ha:4,$a:1e-4};function Ye(n,t){const e=100*(n-t)/t;return t<0?-e:e}function hb(n,t){const e=Ye(n.Th(),t),i=Ye(n.Ph(),t);return new Tt(e,i)}function Ri(n,t){const e=100*(n-t)/t+100;return t<0?-e:e}function ab(n,t){const e=Ri(n.Th(),t),i=Ri(n.Ph(),t);return new Tt(e,i)}function fn(n,t){const e=Math.abs(n);if(e<1e-15)return 0;const i=Math.log10(e+t.$a)+t.Ha;return n<0?-i:i}function Fi(n,t){const e=Math.abs(n);if(e<1e-15)return 0;const i=Math.pow(10,e-t.Ha)-t.$a;return n<0?-i:i}function Ci(n,t){if(n===null)return null;const e=fn(n.Th(),t),i=fn(n.Ph(),t);return new Tt(e,i)}function Os(n,t){if(n===null)return null;const e=Fi(n.Th(),t),i=Fi(n.Ph(),t);return new Tt(e,i)}function Zn(n){if(n===null)return Yn;const t=Math.abs(n.Ph()-n.Th());if(t>=1||t<1e-15)return Yn;const e=Math.ceil(Math.abs(Math.log10(t))),i=Yn.Ha+e;return{Ha:i,$a:1/Math.pow(10,i)}}class Qn{constructor(t,e){if(this.Ua=t,this.qa=e,function(i){if(i<0)return!1;for(let s=i;s>1;s/=10)if(s%10!=0)return!1;return!0}(this.Ua))this.Ya=[2,2.5,2];else{this.Ya=[];for(let i=this.Ua;i!==1;){if(i%2==0)this.Ya.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.Ya.push(2,2.5),i/=5}if(this.Ya.length>100)throw new Error("something wrong with base")}}}Za(t,e,i){const s=this.Ua===0?0:1/this.Ua;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),o=0,l=this.qa[0];for(;;){const u=Ds(r,s,1e-14)&&r>s+1e-14,f=Ds(r,i*l,1e-14),g=Ds(r,1,1e-14);if(!(u&&f&&g))break;r/=l,l=this.qa[++o%this.qa.length]}if(r<=s+1e-14&&(r=s),r=Math.max(1,r),this.Ya.length>0&&(h=r,a=1,c=1e-14,Math.abs(h-a)<c))for(o=0,l=this.Ya[0];Ds(r,i*l,1e-14)&&r>s+1e-14;)r/=l,l=this.Ya[++o%this.Ya.length];var h,a,c;return r}}class Wh{constructor(t,e,i,s){this.Xa=[],this.Li=t,this.Ua=e,this.Ka=i,this.Ga=s}Za(t,e){if(t<e)throw new Error("high < low");const i=this.Li.At(),s=(t-e)*this.Ja()/i,r=new Qn(this.Ua,[2,2.5,2]),o=new Qn(this.Ua,[2,2,2.5]),l=new Qn(this.Ua,[2.5,2,2]),h=[];return h.push(r.Za(t,e,s),o.Za(t,e,s),l.Za(t,e,s)),function(a){if(a.length<1)throw Error("array is empty");let c=a[0];for(let u=1;u<a.length;++u)a[u]<c&&(c=a[u]);return c}(h)}Qa(){const t=this.Li,e=t.Ct();if(e===null)return void(this.Xa=[]);const i=t.At(),s=this.Ka(i-1,e),r=this.Ka(0,e),o=this.Li.W().entireTextOnly?this.io()/2:0,l=o,h=i-1-o,a=Math.max(s,r),c=Math.min(s,r);if(a===c)return void(this.Xa=[]);let u=this.Za(a,c),f=a%u;f+=f<0?u:0;const g=a>=c?1:-1;let p=null,m=0;for(let b=a-f;b>c;b-=u){const v=this.Ga(b,e,!0);p!==null&&Math.abs(v-p)<this.Ja()||v<l||v>h||(m<this.Xa.length?(this.Xa[m].La=v,this.Xa[m].no=t.so(b)):this.Xa.push({La:v,no:t.so(b)}),m++,p=v,t.eo()&&(u=this.Za(b*g,c)))}this.Xa.length=m}ja(){return this.Xa}io(){return this.Li.P()}Ja(){return Math.ceil(2.5*this.io())}}function Iu(n){return n.slice().sort((t,e)=>M(t.Xi())-M(e.Xi()))}var Hh;(function(n){n[n.Normal=0]="Normal",n[n.Logarithmic=1]="Logarithmic",n[n.Percentage=2]="Percentage",n[n.IndexedTo100=3]="IndexedTo100"})(Hh||(Hh={}));const jh=new Au,Kh=new Cn(100,1);class cb{constructor(t,e,i,s){this.ro=0,this.ho=null,this.Ah=null,this.lo=null,this.ao={oo:!1,_o:null},this.uo=0,this.co=0,this.do=new lt,this.fo=new lt,this.vo=[],this.po=null,this.mo=null,this.bo=null,this.wo=null,this.ba=Kh,this.Mo=Zn(null),this.xo=t,this.cn=e,this.So=i,this.ko=s,this.yo=new Wh(this,100,this.Co.bind(this),this.To.bind(this))}Ta(){return this.xo}W(){return this.cn}Hh(t){if(Wt(this.cn,t),this.Pa(),t.mode!==void 0&&this.Po({yr:t.mode}),t.scaleMargins!==void 0){const e=St(t.scaleMargins.top),i=St(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.Ro(),this.mo=null}}Do(){return this.cn.autoScale}eo(){return this.cn.mode===1}gh(){return this.cn.mode===2}Vo(){return this.cn.mode===3}yr(){return{Wn:this.cn.autoScale,Oo:this.cn.invertScale,yr:this.cn.mode}}Po(t){const e=this.yr();let i=null;t.Wn!==void 0&&(this.cn.autoScale=t.Wn),t.yr!==void 0&&(this.cn.mode=t.yr,t.yr!==2&&t.yr!==3||(this.cn.autoScale=!0),this.ao.oo=!1),e.yr===1&&t.yr!==e.yr&&(function(r,o){if(r===null)return!1;const l=Fi(r.Th(),o),h=Fi(r.Ph(),o);return isFinite(l)&&isFinite(h)}(this.Ah,this.Mo)?(i=Os(this.Ah,this.Mo),i!==null&&this.Bo(i)):this.cn.autoScale=!0),t.yr===1&&t.yr!==e.yr&&(i=Ci(this.Ah,this.Mo),i!==null&&this.Bo(i));const s=e.yr!==this.cn.mode;s&&(e.yr===2||this.gh())&&this.Pa(),s&&(e.yr===3||this.Vo())&&this.Pa(),t.Oo!==void 0&&e.Oo!==t.Oo&&(this.cn.invertScale=t.Oo,this.Ao()),this.fo.m(e,this.yr())}Io(){return this.fo}P(){return this.So.fontSize}At(){return this.ro}zo(t){this.ro!==t&&(this.ro=t,this.Ro(),this.mo=null)}Lo(){if(this.ho)return this.ho;const t=this.At()-this.Eo()-this.No();return this.ho=t,t}zh(){return this.Fo(),this.Ah}Bo(t,e){const i=this.Ah;(e||i===null&&t!==null||i!==null&&!i.yh(t))&&(this.mo=null,this.Ah=t)}Ni(){return this.Fo(),this.ro===0||!this.Ah||this.Ah.Ni()}Wo(t){return this.Oo()?t:this.At()-1-t}Rt(t,e){return this.gh()?t=Ye(t,e):this.Vo()&&(t=Ri(t,e)),this.To(t,e)}Qs(t,e,i){this.Fo();const s=this.No(),r=M(this.zh()),o=r.Th(),l=r.Ph(),h=this.Lo()-1,a=this.Oo(),c=h/(l-o),u=i===void 0?0:i.from,f=i===void 0?t.length:i.to,g=this.jo();for(let p=u;p<f;p++){const m=t[p],b=m._t;if(isNaN(b))continue;let v=b;g!==null&&(v=g(m._t,e));const w=s+c*(v-o),x=a?w:this.ro-1-w;m.st=x}}me(t,e,i){this.Fo();const s=this.No(),r=M(this.zh()),o=r.Th(),l=r.Ph(),h=this.Lo()-1,a=this.Oo(),c=h/(l-o),u=i===void 0?0:i.from,f=i===void 0?t.length:i.to,g=this.jo();for(let p=u;p<f;p++){const m=t[p];let b=m.we,v=m.ge,w=m.Me,x=m.xe;g!==null&&(b=g(m.we,e),v=g(m.ge,e),w=g(m.Me,e),x=g(m.xe,e));let y=s+c*(b-o),k=a?y:this.ro-1-y;m.ve=k,y=s+c*(v-o),k=a?y:this.ro-1-y,m.ce=k,y=s+c*(w-o),k=a?y:this.ro-1-y,m.de=k,y=s+c*(x-o),k=a?y:this.ro-1-y,m.pe=k}}pn(t,e){const i=this.Co(t,e);return this.Ho(i,e)}Ho(t,e){let i=t;return this.gh()?i=function(s,r){return r<0&&(s=-s),s/100*r+r}(i,e):this.Vo()&&(i=function(s,r){return s-=100,r<0&&(s=-s),s/100*r+r}(i,e)),i}Oa(){return this.vo}$o(){if(this.po)return this.po;let t=[];for(let e=0;e<this.vo.length;e++){const i=this.vo[e];i.Xi()===null&&i.Ki(e+1),t.push(i)}return t=Iu(t),this.po=t,this.po}Uo(t){this.vo.indexOf(t)===-1&&(this.vo.push(t),this.Pa(),this.qo())}Yo(t){const e=this.vo.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.vo.splice(e,1),this.vo.length===0&&(this.Po({Wn:!0}),this.Bo(null)),this.Pa(),this.qo()}Ct(){let t=null;for(const e of this.vo){const i=e.Ct();i!==null&&(t===null||i.ha<t.ha)&&(t=i)}return t===null?null:t.Vt}Oo(){return this.cn.invertScale}ja(){const t=this.Ct()===null;if(this.mo!==null&&(t||this.mo.Zo===t))return this.mo.ja;this.yo.Qa();const e=this.yo.ja();return this.mo={ja:e,Zo:t},this.do.m(),e}Xo(){return this.do}Ko(t){this.gh()||this.Vo()||this.bo===null&&this.lo===null&&(this.Ni()||(this.bo=this.ro-t,this.lo=M(this.zh()).Ch()))}Go(t){if(this.gh()||this.Vo()||this.bo===null)return;this.Po({Wn:!1}),(t=this.ro-t)<0&&(t=0);let e=(this.bo+.2*(this.ro-1))/(t+.2*(this.ro-1));const i=M(this.lo).Ch();e=Math.max(e,.1),i.Dh(e),this.Bo(i)}Jo(){this.gh()||this.Vo()||(this.bo=null,this.lo=null)}Qo(t){this.Do()||this.wo===null&&this.lo===null&&(this.Ni()||(this.wo=t,this.lo=M(this.zh()).Ch()))}t_(t){if(this.Do()||this.wo===null)return;const e=M(this.zh()).Rh()/(this.Lo()-1);let i=t-this.wo;this.Oo()&&(i*=-1);const s=i*e,r=M(this.lo).Ch();r.Vh(s),this.Bo(r,!0),this.mo=null}i_(){this.Do()||this.wo!==null&&(this.wo=null,this.lo=null)}ma(){return this.ba||this.Pa(),this.ba}Fi(t,e){switch(this.cn.mode){case 2:return this.n_(Ye(t,e));case 3:return this.ma().format(Ri(t,e));default:return this.Fh(t)}}so(t){switch(this.cn.mode){case 2:return this.n_(t);case 3:return this.ma().format(t);default:return this.Fh(t)}}ql(t){return this.Fh(t,M(this.s_()).ma())}Yl(t,e){return t=Ye(t,e),this.n_(t,jh)}e_(){return this.vo}r_(t){this.ao={_o:t,oo:!1}}Vn(){this.vo.forEach(t=>t.Vn())}Pa(){this.mo=null;const t=this.s_();let e=100;t!==null&&(e=Math.round(1/t.pa())),this.ba=Kh,this.gh()?(this.ba=jh,e=100):this.Vo()?(this.ba=new Cn(100,1),e=100):t!==null&&(this.ba=t.ma()),this.yo=new Wh(this,e,this.Co.bind(this),this.To.bind(this)),this.yo.Qa()}qo(){this.po=null}s_(){return this.vo[0]||null}Eo(){return this.Oo()?this.cn.scaleMargins.bottom*this.At()+this.co:this.cn.scaleMargins.top*this.At()+this.uo}No(){return this.Oo()?this.cn.scaleMargins.top*this.At()+this.uo:this.cn.scaleMargins.bottom*this.At()+this.co}Fo(){this.ao.oo||(this.ao.oo=!0,this.h_())}Ro(){this.ho=null}To(t,e){if(this.Fo(),this.Ni())return 0;t=this.eo()&&t?fn(t,this.Mo):t;const i=M(this.zh()),s=this.No()+(this.Lo()-1)*(t-i.Th())/i.Rh();return this.Wo(s)}Co(t,e){if(this.Fo(),this.Ni())return 0;const i=this.Wo(t),s=M(this.zh()),r=s.Th()+s.Rh()*((i-this.No())/(this.Lo()-1));return this.eo()?Fi(r,this.Mo):r}Ao(){this.mo=null,this.yo.Qa()}h_(){const t=this.ao._o;if(t===null)return;let e=null;const i=this.e_();let s=0,r=0;for(const h of i){if(!h.yt())continue;const a=h.Ct();if(a===null)continue;const c=h.Al(t.Vs(),t.ui());let u=c&&c.zh();if(u!==null){switch(this.cn.mode){case 1:u=Ci(u,this.Mo);break;case 2:u=hb(u,a.Vt);break;case 3:u=ab(u,a.Vt)}if(e=e===null?u:e.ts(M(u)),c!==null){const f=c.Lh();f!==null&&(s=Math.max(s,f.above),r=Math.max(r,f.below))}}}if(s===this.uo&&r===this.co||(this.uo=s,this.co=r,this.mo=null,this.Ro()),e!==null){if(e.Th()===e.Ph()){const h=this.s_(),a=5*(h===null||this.gh()||this.Vo()?1:h.pa());this.eo()&&(e=Os(e,this.Mo)),e=new Tt(e.Th()-a,e.Ph()+a),this.eo()&&(e=Ci(e,this.Mo))}if(this.eo()){const h=Os(e,this.Mo),a=Zn(h);if(o=a,l=this.Mo,o.Ha!==l.Ha||o.$a!==l.$a){const c=this.lo!==null?Os(this.lo,this.Mo):null;this.Mo=a,e=Ci(h,a),c!==null&&(this.lo=Ci(c,a))}}this.Bo(e)}else this.Ah===null&&(this.Bo(new Tt(-.5,.5)),this.Mo=Zn(null));var o,l;this.ao.oo=!0}jo(){return this.gh()?Ye:this.Vo()?Ri:this.eo()?t=>fn(t,this.Mo):null}l_(t,e,i){return e===void 0?(i===void 0&&(i=this.ma()),i.format(t)):e(t)}Fh(t,e){return this.l_(t,this.ko.priceFormatter,e)}n_(t,e){return this.l_(t,this.ko.percentageFormatter,e)}}class ub{constructor(t,e){this.vo=[],this.a_=new Map,this.ro=0,this.o_=0,this.__=1e3,this.po=null,this.u_=new lt,this.kl=t,this.$i=e,this.c_=new lb(this);const i=e.W();this.d_=this.f_("left",i.leftPriceScale),this.v_=this.f_("right",i.rightPriceScale),this.d_.Io().l(this.p_.bind(this,this.d_),this),this.v_.Io().l(this.p_.bind(this,this.v_),this),this.m_(i)}m_(t){if(t.leftPriceScale&&this.d_.Hh(t.leftPriceScale),t.rightPriceScale&&this.v_.Hh(t.rightPriceScale),t.localization&&(this.d_.Pa(),this.v_.Pa()),t.overlayPriceScales){const e=Array.from(this.a_.values());for(const i of e){const s=M(i[0].Dt());s.Hh(t.overlayPriceScales),t.localization&&s.Pa()}}}b_(t){switch(t){case"left":return this.d_;case"right":return this.v_}return this.a_.has(t)?St(this.a_.get(t))[0].Dt():null}S(){this.$t().w_().p(this),this.d_.Io().p(this),this.v_.Io().p(this),this.vo.forEach(t=>{t.S&&t.S()}),this.u_.m()}g_(){return this.__}M_(t){this.__=t}$t(){return this.$i}Hi(){return this.o_}At(){return this.ro}x_(t){this.o_=t,this.S_()}zo(t){this.ro=t,this.d_.zo(t),this.v_.zo(t),this.vo.forEach(e=>{if(this.dr(e)){const i=e.Dt();i!==null&&i.zo(t)}}),this.S_()}Oa(){return this.vo}dr(t){const e=t.Dt();return e===null||this.d_!==e&&this.v_!==e}Uo(t,e,i){const s=i!==void 0?i:this.y_().k_+1;this.C_(t,e,s)}Yo(t){const e=this.vo.indexOf(t);De(e!==-1,"removeDataSource: invalid data source"),this.vo.splice(e,1);const i=M(t.Dt()).Ta();if(this.a_.has(i)){const r=St(this.a_.get(i)),o=r.indexOf(t);o!==-1&&(r.splice(o,1),r.length===0&&this.a_.delete(i))}const s=t.Dt();s&&s.Oa().indexOf(t)>=0&&s.Yo(t),s!==null&&(s.qo(),this.T_(s)),this.po=null}pr(t){return t===this.d_?"left":t===this.v_?"right":"overlay"}P_(){return this.d_}R_(){return this.v_}D_(t,e){t.Ko(e)}V_(t,e){t.Go(e),this.S_()}O_(t){t.Jo()}B_(t,e){t.Qo(e)}A_(t,e){t.t_(e),this.S_()}I_(t){t.i_()}S_(){this.vo.forEach(t=>{t.Vn()})}vn(){let t=null;return this.$i.W().rightPriceScale.visible&&this.v_.Oa().length!==0?t=this.v_:this.$i.W().leftPriceScale.visible&&this.d_.Oa().length!==0?t=this.d_:this.vo.length!==0&&(t=this.vo[0].Dt()),t===null&&(t=this.v_),t}vr(){let t=null;return this.$i.W().rightPriceScale.visible?t=this.v_:this.$i.W().leftPriceScale.visible&&(t=this.d_),t}T_(t){t!==null&&t.Do()&&this.z_(t)}L_(t){const e=this.kl.Zs();t.Po({Wn:!0}),e!==null&&t.r_(e),this.S_()}E_(){this.z_(this.d_),this.z_(this.v_)}N_(){this.T_(this.d_),this.T_(this.v_),this.vo.forEach(t=>{this.dr(t)&&this.T_(t.Dt())}),this.S_(),this.$i.$h()}$o(){return this.po===null&&(this.po=Iu(this.vo)),this.po}F_(){return this.u_}W_(){return this.c_}z_(t){const e=t.e_();if(e&&e.length>0&&!this.kl.Ni()){const i=this.kl.Zs();i!==null&&t.r_(i)}t.Vn()}y_(){const t=this.$o();if(t.length===0)return{j_:0,k_:0};let e=0,i=0;for(let s=0;s<t.length;s++){const r=t[s].Xi();r!==null&&(r<e&&(e=r),r>i&&(i=r))}return{j_:e,k_:i}}C_(t,e,i){let s=this.b_(e);if(s===null&&(s=this.f_(e,this.$i.W().overlayPriceScales)),this.vo.push(t),!Sn(e)){const r=this.a_.get(e)||[];r.push(t),this.a_.set(e,r)}s.Uo(t),t.Gi(s),t.Ki(i),this.T_(s),this.po=null}p_(t,e,i){e.yr!==i.yr&&this.z_(t)}f_(t,e){const i=Object.assign({visible:!0,autoScale:!0},ne(e)),s=new cb(t,i,this.$i.W().layout,this.$i.W().localization);return s.zo(this.At()),s}}class fb{constructor(t,e,i=50){this.Xe=0,this.Ke=1,this.Ge=1,this.Qe=new Map,this.Je=new Map,this.H_=t,this.U_=e,this.tr=i}q_(t){const e=t.time,i=this.U_.cacheKey(e),s=this.Qe.get(i);if(s!==void 0)return s.Y_;if(this.Xe===this.tr){const o=this.Je.get(this.Ge);this.Je.delete(this.Ge),this.Qe.delete(St(o)),this.Ge++,this.Xe--}const r=this.H_(t);return this.Qe.set(i,{Y_:r,er:this.Ke}),this.Je.set(this.Ke,i),this.Xe++,this.Ke++,r}}class Vi{constructor(t,e){De(t<=e,"right should be >= left"),this.Z_=t,this.X_=e}Vs(){return this.Z_}ui(){return this.X_}K_(){return this.X_-this.Z_+1}Xr(t){return this.Z_<=t&&t<=this.X_}yh(t){return this.Z_===t.Vs()&&this.X_===t.ui()}}function $h(n,t){return n===null||t===null?n===t:n.yh(t)}class db{constructor(){this.G_=new Map,this.Qe=null,this.J_=!1}Q_(t){this.J_=t,this.Qe=null}tu(t,e){this.iu(e),this.Qe=null;for(let i=e;i<t.length;++i){const s=t[i];let r=this.G_.get(s.timeWeight);r===void 0&&(r=[],this.G_.set(s.timeWeight,r)),r.push({index:i,time:s.time,weight:s.timeWeight,originalTime:s.originalTime})}}nu(t,e){const i=Math.ceil(e/t);return this.Qe!==null&&this.Qe.su===i||(this.Qe={ja:this.eu(i),su:i}),this.Qe.ja}iu(t){if(t===0)return void this.G_.clear();const e=[];this.G_.forEach((i,s)=>{t<=i[0].index?e.push(s):i.splice(as(i,t,r=>r.index<t),1/0)});for(const i of e)this.G_.delete(i)}eu(t){let e=[];for(const i of Array.from(this.G_.keys()).sort((s,r)=>r-s)){if(!this.G_.get(i))continue;const s=e;e=[];const r=s.length;let o=0;const l=St(this.G_.get(i)),h=l.length;let a=1/0,c=-1/0;for(let u=0;u<h;u++){const f=l[u],g=f.index;for(;o<r;){const p=s[o],m=p.index;if(!(m<g)){a=m;break}o++,e.push(p),c=m,a=1/0}if(a-g>=t&&g-c>=t)e.push(f),c=g;else if(this.J_)return s}for(;o<r;o++)e.push(s[o])}return e}}class si{constructor(t){this.ru=t}hu(){return this.ru===null?null:new Vi(Math.floor(this.ru.Vs()),Math.ceil(this.ru.ui()))}lu(){return this.ru}static au(){return new si(null)}}function gb(n,t){return n.weight>t.weight?n:t}class pb{constructor(t,e,i,s){this.o_=0,this.ou=null,this._u=[],this.wo=null,this.bo=null,this.uu=new db,this.cu=new Map,this.du=si.au(),this.fu=!0,this.vu=new lt,this.pu=new lt,this.mu=new lt,this.bu=null,this.wu=null,this.gu=[],this.cn=e,this.ko=i,this.Mu=e.rightOffset,this.xu=e.barSpacing,this.$i=t,this.U_=s,this.Su(),this.uu.Q_(e.uniformDistribution)}W(){return this.cn}ku(t){Wt(this.ko,t),this.yu(),this.Su()}Hh(t,e){var i;Wt(this.cn,t),this.cn.fixLeftEdge&&this.Cu(),this.cn.fixRightEdge&&this.Tu(),t.barSpacing!==void 0&&this.$i.Gn(t.barSpacing),t.rightOffset!==void 0&&this.$i.Jn(t.rightOffset),t.minBarSpacing!==void 0&&this.$i.Gn((i=t.barSpacing)!==null&&i!==void 0?i:this.xu),this.yu(),this.Su(),this.mu.m()}mn(t){var e,i;return(i=(e=this._u[t])===null||e===void 0?void 0:e.time)!==null&&i!==void 0?i:null}Ui(t){var e;return(e=this._u[t])!==null&&e!==void 0?e:null}Da(t,e){if(this._u.length<1)return null;if(this.U_.key(t)>this.U_.key(this._u[this._u.length-1].time))return e?this._u.length-1:null;const i=as(this._u,this.U_.key(t),(s,r)=>this.U_.key(s.time)<r);return this.U_.key(t)<this.U_.key(this._u[i].time)?e?i:null:i}Ni(){return this.o_===0||this._u.length===0||this.ou===null}Ra(){return this._u.length>0}Zs(){return this.Pu(),this.du.hu()}Ru(){return this.Pu(),this.du.lu()}Du(){const t=this.Zs();if(t===null)return null;const e={from:t.Vs(),to:t.ui()};return this.Vu(e)}Vu(t){const e=Math.round(t.from),i=Math.round(t.to),s=M(this.Ou()),r=M(this.Bu());return{from:M(this.Ui(Math.max(s,e))),to:M(this.Ui(Math.min(r,i)))}}Au(t){return{from:M(this.Da(t.from,!0)),to:M(this.Da(t.to,!0))}}Hi(){return this.o_}x_(t){if(!isFinite(t)||t<=0||this.o_===t)return;const e=this.Ru(),i=this.o_;if(this.o_=t,this.fu=!0,this.cn.lockVisibleTimeRangeOnResize&&i!==0){const s=this.xu*t/i;this.xu=s}if(this.cn.fixLeftEdge&&e!==null&&e.Vs()<=0){const s=i-t;this.Mu-=Math.round(s/this.xu)+1,this.fu=!0}this.Iu(),this.zu()}It(t){if(this.Ni()||!Ji(t))return 0;const e=this.Lu()+this.Mu-t;return this.o_-(e+.5)*this.xu-1}Js(t,e){const i=this.Lu(),s=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let o=s;o<r;o++){const l=t[o].ot,h=i+this.Mu-l,a=this.o_-(h+.5)*this.xu-1;t[o].nt=a}}Eu(t){return Math.ceil(this.Nu(t))}Jn(t){this.fu=!0,this.Mu=t,this.zu(),this.$i.Fu(),this.$i.$h()}he(){return this.xu}Gn(t){this.Wu(t),this.zu(),this.$i.Fu(),this.$i.$h()}ju(){return this.Mu}ja(){if(this.Ni())return null;if(this.wu!==null)return this.wu;const t=this.xu,e=5*(this.$i.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),i=Math.round(e/t),s=M(this.Zs()),r=Math.max(s.Vs(),s.Vs()-i),o=Math.max(s.ui(),s.ui()-i),l=this.uu.nu(t,e),h=this.Ou()+i,a=this.Bu()-i,c=this.Hu(),u=this.cn.fixLeftEdge||c,f=this.cn.fixRightEdge||c;let g=0;for(const p of l){if(!(r<=p.index&&p.index<=o))continue;let m;g<this.gu.length?(m=this.gu[g],m.coord=this.It(p.index),m.label=this.$u(p),m.weight=p.weight):(m={needAlignCoordinate:!1,coord:this.It(p.index),label:this.$u(p),weight:p.weight},this.gu.push(m)),this.xu>e/2&&!c?m.needAlignCoordinate=!1:m.needAlignCoordinate=u&&p.index<=h||f&&p.index>=a,g++}return this.gu.length=g,this.wu=this.gu,this.gu}Uu(){this.fu=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}qu(t){this.fu=!0,this.ou=t,this.zu(),this.Cu()}Yu(t,e){const i=this.Nu(t),s=this.he(),r=s+e*(s/10);this.Gn(r),this.cn.rightBarStaysOnScroll||this.Jn(this.ju()+(i-this.Nu(t)))}Ko(t){this.wo&&this.i_(),this.bo===null&&this.bu===null&&(this.Ni()||(this.bo=t,this.Zu()))}Go(t){if(this.bu===null)return;const e=so(this.o_-t,0,this.o_),i=so(this.o_-M(this.bo),0,this.o_);e!==0&&i!==0&&this.Gn(this.bu.he*e/i)}Jo(){this.bo!==null&&(this.bo=null,this.Xu())}Qo(t){this.wo===null&&this.bu===null&&(this.Ni()||(this.wo=t,this.Zu()))}t_(t){if(this.wo===null)return;const e=(this.wo-t)/this.he();this.Mu=M(this.bu).ju+e,this.fu=!0,this.zu()}i_(){this.wo!==null&&(this.wo=null,this.Xu())}Ku(){this.Gu(this.cn.rightOffset)}Gu(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.Mu,s=performance.now();this.$i.Zn({Ju:r=>(r-s)/e>=1,Qu:r=>{const o=(r-s)/e;return o>=1?t:i+(t-i)*o}})}bt(t,e){this.fu=!0,this._u=t,this.uu.tu(t,e),this.zu()}tc(){return this.vu}nc(){return this.pu}sc(){return this.mu}Lu(){return this.ou||0}ec(t){const e=t.K_();this.Wu(this.o_/e),this.Mu=t.ui()-this.Lu(),this.zu(),this.fu=!0,this.$i.Fu(),this.$i.$h()}rc(){const t=this.Ou(),e=this.Bu();t!==null&&e!==null&&this.ec(new Vi(t,e+this.cn.rightOffset))}hc(t){const e=new Vi(t.from,t.to);this.ec(e)}qi(t){return this.ko.timeFormatter!==void 0?this.ko.timeFormatter(t.originalTime):this.U_.formatHorzItem(t.time)}Hu(){const{handleScroll:t,handleScale:e}=this.$i.W();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}Ou(){return this._u.length===0?null:0}Bu(){return this._u.length===0?null:this._u.length-1}lc(t){return(this.o_-1-t)/this.xu}Nu(t){const e=this.lc(t),i=this.Lu()+this.Mu-e;return Math.round(1e6*i)/1e6}Wu(t){const e=this.xu;this.xu=t,this.Iu(),e!==this.xu&&(this.fu=!0,this.ac())}Pu(){if(!this.fu)return;if(this.fu=!1,this.Ni())return void this.oc(si.au());const t=this.Lu(),e=this.o_/this.xu,i=this.Mu+t,s=new Vi(i-e+1,i);this.oc(new si(s))}Iu(){const t=this._c();if(this.xu<t&&(this.xu=t,this.fu=!0),this.o_!==0){const e=.5*this.o_;this.xu>e&&(this.xu=e,this.fu=!0)}}_c(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&this._u.length!==0?this.o_/this._u.length:this.cn.minBarSpacing}zu(){const t=this.uc();this.Mu>t&&(this.Mu=t,this.fu=!0);const e=this.cc();e!==null&&this.Mu<e&&(this.Mu=e,this.fu=!0)}cc(){const t=this.Ou(),e=this.ou;return t===null||e===null?null:t-e-1+(this.cn.fixLeftEdge?this.o_/this.xu:Math.min(2,this._u.length))}uc(){return this.cn.fixRightEdge?0:this.o_/this.xu-Math.min(2,this._u.length)}Zu(){this.bu={he:this.he(),ju:this.ju()}}Xu(){this.bu=null}$u(t){let e=this.cu.get(t.weight);return e===void 0&&(e=new fb(i=>this.dc(i),this.U_),this.cu.set(t.weight,e)),e.q_(t)}dc(t){return this.U_.formatTickmark(t,this.ko)}oc(t){const e=this.du;this.du=t,$h(e.hu(),this.du.hu())||this.vu.m(),$h(e.lu(),this.du.lu())||this.pu.m(),this.ac()}ac(){this.wu=null}yu(){this.ac(),this.cu.clear()}Su(){this.U_.updateFormatter(this.ko)}Cu(){if(!this.cn.fixLeftEdge)return;const t=this.Ou();if(t===null)return;const e=this.Zs();if(e===null)return;const i=e.Vs()-t;if(i<0){const s=this.Mu-i-1;this.Jn(s)}this.Iu()}Tu(){this.zu(),this.Iu()}}class mb{X(t,e,i){t.useMediaCoordinateSpace(s=>this.K(s,e,i))}wl(t,e,i){t.useMediaCoordinateSpace(s=>this.fc(s,e,i))}fc(t,e,i){}}class bb extends mb{constructor(t){super(),this.vc=new Map,this.zt=t}K(t){}fc(t){if(!this.zt.yt)return;const{context:e,mediaSize:i}=t;let s=0;for(const o of this.zt.mc){if(o.Kt.length===0)continue;e.font=o.R;const l=this.bc(e,o.Kt);l>i.width?o.Yu=i.width/l:o.Yu=1,s+=o.wc*o.Yu}let r=0;switch(this.zt.gc){case"top":r=0;break;case"center":r=Math.max((i.height-s)/2,0);break;case"bottom":r=Math.max(i.height-s,0)}e.fillStyle=this.zt.V;for(const o of this.zt.mc){e.save();let l=0;switch(this.zt.Mc){case"left":e.textAlign="left",l=o.wc/2;break;case"center":e.textAlign="center",l=i.width/2;break;case"right":e.textAlign="right",l=i.width-1-o.wc/2}e.translate(l,r),e.textBaseline="top",e.font=o.R,e.scale(o.Yu,o.Yu),e.fillText(o.Kt,0,o.xc),e.restore(),r+=o.wc*o.Yu}}bc(t,e){const i=this.Sc(t.font);let s=i.get(e);return s===void 0&&(s=t.measureText(e).width,i.set(e,s)),s}Sc(t){let e=this.vc.get(t);return e===void 0&&(e=new Map,this.vc.set(t,e)),e}}class vb{constructor(t){this.ft=!0,this.Ft={yt:!1,V:"",mc:[],gc:"center",Mc:"center"},this.Wt=new bb(this.Ft),this.jt=t}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const t=this.jt.W(),e=this.Ft;e.yt=t.visible,e.yt&&(e.V=t.color,e.Mc=t.horzAlign,e.gc=t.vertAlign,e.mc=[{Kt:t.text,R:di(t.fontSize,t.fontFamily,t.fontStyle),wc:1.2*t.fontSize,xc:0,Yu:0}])}}class wb extends Io{constructor(t,e){super(),this.cn=e,this.wn=new vb(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}Vn(){this.wn.bt()}}var Uh,Xh,Gh,dn,qh;(function(n){n[n.OnTouchEnd=0]="OnTouchEnd",n[n.OnNextTap=1]="OnNextTap"})(Uh||(Uh={}));class yb{constructor(t,e,i){this.kc=[],this.yc=[],this.o_=0,this.Cc=null,this.Tc=new lt,this.Pc=new lt,this.Rc=null,this.Dc=t,this.cn=e,this.U_=i,this.Vc=new Zm(this),this.kl=new pb(this,e.timeScale,this.cn.localization,i),this.vt=new a0(this,e.crosshair),this.Oc=new nb(e.crosshair),this.Bc=new wb(this,e.watermark),this.Ac(),this.kc[0].M_(2e3),this.Ic=this.zc(0),this.Lc=this.zc(1)}Xl(){this.Ec(pt.es())}$h(){this.Ec(pt.ss())}aa(){this.Ec(new pt(1))}Kl(t){const e=this.Nc(t);this.Ec(e)}Fc(){return this.Cc}Wc(t){const e=this.Cc;this.Cc=t,e!==null&&this.Kl(e.jc),t!==null&&this.Kl(t.jc)}W(){return this.cn}Hh(t){Wt(this.cn,t),this.kc.forEach(e=>e.m_(t)),t.timeScale!==void 0&&this.kl.Hh(t.timeScale),t.localization!==void 0&&this.kl.ku(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Tc.m(),this.Ic=this.zc(0),this.Lc=this.zc(1),this.Xl()}Hc(t,e){if(t==="left")return void this.Hh({leftPriceScale:e});if(t==="right")return void this.Hh({rightPriceScale:e});const i=this.$c(t);i!==null&&(i.Dt.Hh(e),this.Tc.m())}$c(t){for(const e of this.kc){const i=e.b_(t);if(i!==null)return{Ht:e,Dt:i}}return null}St(){return this.kl}Uc(){return this.kc}qc(){return this.Bc}Yc(){return this.vt}Zc(){return this.Pc}Xc(t,e){t.zo(e),this.Fu()}x_(t){this.o_=t,this.kl.x_(this.o_),this.kc.forEach(e=>e.x_(t)),this.Fu()}Ac(t){const e=new ub(this.kl,this);t!==void 0?this.kc.splice(t,0,e):this.kc.push(e);const i=t===void 0?this.kc.length-1:t,s=pt.es();return s.Nn(i,{Fn:0,Wn:!0}),this.Ec(s),e}D_(t,e,i){t.D_(e,i)}V_(t,e,i){t.V_(e,i),this.Gl(),this.Ec(this.Kc(t,2))}O_(t,e){t.O_(e),this.Ec(this.Kc(t,2))}B_(t,e,i){e.Do()||t.B_(e,i)}A_(t,e,i){e.Do()||(t.A_(e,i),this.Gl(),this.Ec(this.Kc(t,2)))}I_(t,e){e.Do()||(t.I_(e),this.Ec(this.Kc(t,2)))}L_(t,e){t.L_(e),this.Ec(this.Kc(t,2))}Gc(t){this.kl.Ko(t)}Jc(t,e){const i=this.St();if(i.Ni()||e===0)return;const s=i.Hi();t=Math.max(1,Math.min(t,s)),i.Yu(t,e),this.Fu()}Qc(t){this.td(0),this.nd(t),this.sd()}ed(t){this.kl.Go(t),this.Fu()}rd(){this.kl.Jo(),this.$h()}td(t){this.kl.Qo(t)}nd(t){this.kl.t_(t),this.Fu()}sd(){this.kl.i_(),this.$h()}wt(){return this.yc}hd(t,e,i,s,r){this.vt.gn(t,e);let o=NaN,l=this.kl.Eu(t);const h=this.kl.Zs();h!==null&&(l=Math.min(Math.max(h.Vs(),l),h.ui()));const a=s.vn(),c=a.Ct();c!==null&&(o=a.pn(e,c)),o=this.Oc.Va(o,l,s),this.vt.kn(l,o,s),this.aa(),r||this.Pc.m(this.vt.xt(),{x:t,y:e},i)}ld(t,e,i){const s=i.vn(),r=s.Ct(),o=s.Rt(t,M(r)),l=this.kl.Da(e,!0),h=this.kl.It(M(l));this.hd(h,o,null,i,!0)}ad(t){this.Yc().Cn(),this.aa(),t||this.Pc.m(null,null,null)}Gl(){const t=this.vt.Ht();if(t!==null){const e=this.vt.xn(),i=this.vt.Sn();this.hd(e,i,null,t)}this.vt.Vn()}od(t,e,i){const s=this.kl.mn(0);e!==void 0&&i!==void 0&&this.kl.bt(e,i);const r=this.kl.mn(0),o=this.kl.Lu(),l=this.kl.Zs();if(l!==null&&s!==null&&r!==null){const h=l.Xr(o),a=this.U_.key(s)>this.U_.key(r),c=t!==null&&t>o&&!a,u=this.kl.W().allowShiftVisibleRangeOnWhitespaceReplacement,f=h&&(i!==void 0||u)&&this.kl.W().shiftVisibleRangeOnNewBar;if(c&&!f){const g=t-o;this.kl.Jn(this.kl.ju()-g)}}this.kl.qu(t)}ta(t){t!==null&&t.N_()}cr(t){const e=this.kc.find(i=>i.$o().includes(t));return e===void 0?null:e}Fu(){this.Bc.Vn(),this.kc.forEach(t=>t.N_()),this.Gl()}S(){this.kc.forEach(t=>t.S()),this.kc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}_d(){return this.Vc}mr(){return this.Vc.W()}w_(){return this.Tc}ud(t,e,i){const s=this.kc[0],r=this.dd(e,t,s,i);return this.yc.push(r),this.yc.length===1?this.Xl():this.$h(),r}fd(t){const e=this.cr(t),i=this.yc.indexOf(t);De(i!==-1,"Series not found"),this.yc.splice(i,1),M(e).Yo(t),t.S&&t.S()}Zl(t,e){const i=M(this.cr(t));i.Yo(t);const s=this.$c(e);if(s===null){const r=t.Xi();i.Uo(t,e,r)}else{const r=s.Ht===i?t.Xi():void 0;s.Ht.Uo(t,e,r)}}rc(){const t=pt.ss();t.$n(),this.Ec(t)}vd(t){const e=pt.ss();e.Yn(t),this.Ec(e)}Kn(){const t=pt.ss();t.Kn(),this.Ec(t)}Gn(t){const e=pt.ss();e.Gn(t),this.Ec(e)}Jn(t){const e=pt.ss();e.Jn(t),this.Ec(e)}Zn(t){const e=pt.ss();e.Zn(t),this.Ec(e)}Un(){const t=pt.ss();t.Un(),this.Ec(t)}pd(){return this.cn.rightPriceScale.visible?"right":"left"}md(){return this.Lc}q(){return this.Ic}Bt(t){const e=this.Lc,i=this.Ic;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Rc===null||this.Rc.Ts!==i||this.Rc.Ps!==e)this.Rc={Ts:i,Ps:e,bd:new Map};else{const r=this.Rc.bd.get(t);if(r!==void 0)return r}const s=function(r,o,l){const[h,a,c,u]=qi(r),[f,g,p,m]=qi(o),b=[Pt(h+l*(f-h)),Pt(a+l*(g-a)),Pt(c+l*(p-c)),ku(u+l*(m-u))];return`rgba(${b[0]}, ${b[1]}, ${b[2]}, ${b[3]})`}(i,e,t/100);return this.Rc.bd.set(t,s),s}Kc(t,e){const i=new pt(e);if(t!==null){const s=this.kc.indexOf(t);i.Nn(s,{Fn:e})}return i}Nc(t,e){return e===void 0&&(e=2),this.Kc(this.cr(t),e)}Ec(t){this.Dc&&this.Dc(t),this.kc.forEach(e=>e.W_().Uh().bt())}dd(t,e,i,s){const r=new Ko(this,t,e,i,s),o=t.priceScaleId!==void 0?t.priceScaleId:this.pd();return i.Uo(r,o),Sn(o)||r.Hh(t),r}zc(t){const e=this.cn.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}}function no(n){return!Zt(n)&&!hs(n)}function Wu(n){return Zt(n)}(function(n){n[n.Disabled=0]="Disabled",n[n.Continuous=1]="Continuous",n[n.OnDataUpdate=2]="OnDataUpdate"})(Xh||(Xh={})),function(n){n[n.LastBar=0]="LastBar",n[n.LastVisible=1]="LastVisible"}(Gh||(Gh={})),function(n){n.Solid="solid",n.VerticalGradient="gradient"}(dn||(dn={})),function(n){n[n.Year=0]="Year",n[n.Month=1]="Month",n[n.DayOfMonth=2]="DayOfMonth",n[n.Time=3]="Time",n[n.TimeWithSeconds=4]="TimeWithSeconds"}(qh||(qh={}));const Jh=n=>n.getUTCFullYear();function xb(n,t,e){return t.replace(/yyyy/g,(i=>re(Jh(i),4))(n)).replace(/yy/g,(i=>re(Jh(i)%100,2))(n)).replace(/MMMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"long"}))(n,e)).replace(/MMM/g,((i,s)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(s,{month:"short"}))(n,e)).replace(/MM/g,(i=>re((s=>s.getUTCMonth()+1)(i),2))(n)).replace(/dd/g,(i=>re((s=>s.getUTCDate())(i),2))(n))}class Hu{constructor(t="yyyy-MM-dd",e="default"){this.wd=t,this.gd=e}q_(t){return xb(t,this.wd,this.gd)}}class kb{constructor(t){this.Md=t||"%h:%m:%s"}q_(t){return this.Md.replace("%h",re(t.getUTCHours(),2)).replace("%m",re(t.getUTCMinutes(),2)).replace("%s",re(t.getUTCSeconds(),2))}}const Sb={xd:"yyyy-MM-dd",Sd:"%h:%m:%s",kd:" ",yd:"default"};class Cb{constructor(t={}){const e=Object.assign(Object.assign({},Sb),t);this.Cd=new Hu(e.xd,e.yd),this.Td=new kb(e.Sd),this.Pd=e.kd}q_(t){return`${this.Cd.q_(t)}${this.Pd}${this.Td.q_(t)}`}}function Ps(n){return 60*n*60*1e3}function tr(n){return 60*n*1e3}const Ns=[{Rd:(Yh=1,1e3*Yh),Dd:10},{Rd:tr(1),Dd:20},{Rd:tr(5),Dd:21},{Rd:tr(30),Dd:22},{Rd:Ps(1),Dd:30},{Rd:Ps(3),Dd:31},{Rd:Ps(6),Dd:32},{Rd:Ps(12),Dd:33}];var Yh;function Zh(n,t){if(n.getUTCFullYear()!==t.getUTCFullYear())return 70;if(n.getUTCMonth()!==t.getUTCMonth())return 60;if(n.getUTCDate()!==t.getUTCDate())return 50;for(let e=Ns.length-1;e>=0;--e)if(Math.floor(t.getTime()/Ns[e].Rd)!==Math.floor(n.getTime()/Ns[e].Rd))return Ns[e].Dd;return 0}function er(n){let t=n;if(hs(n)&&(t=$o(n)),!no(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Vd:Math.round(e.getTime()/1e3),Od:t}}function Qh(n){if(!Wu(n))throw new Error("time must be of type isUTCTimestamp");return{Vd:n}}function $o(n){const t=new Date(n);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${n}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function ta(n){hs(n.time)&&(n.time=$o(n.time))}class ea{options(){return this.cn}setOptions(t){this.cn=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(ta)}(t):ta(t)}createConverterToInternalObj(t){return M(function(e){return e.length===0?null:no(e[0].time)||hs(e[0].time)?er:Qh}(t))}key(t){return typeof t=="object"&&"Vd"in t?t.Vd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.Od===void 0?new Date(1e3*e.Vd).getTime():new Date(Date.UTC(e.Od.year,e.Od.month-1,e.Od.day)).getTime()}convertHorzItemToInternal(t){return Wu(e=t)?Qh(e):no(e)?er(e):er($o(e));var e}updateFormatter(t){if(!this.cn)return;const e=t.dateFormat;this.cn.timeScale.timeVisible?this.Bd=new Cb({xd:e,Sd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",kd:"   ",yd:t.locale}):this.Bd=new Hu(e,t.locale)}formatHorzItem(t){const e=t;return this.Bd.q_(new Date(1e3*e.Vd))}formatTickmark(t,e){const i=function(r,o,l){switch(r){case 0:case 10:return o?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),s=this.cn.timeScale;if(s.tickMarkFormatter!==void 0){const r=s.tickMarkFormatter(t.originalTime,i,e.locale);if(r!==null)return r}return function(r,o,l){const h={};switch(o){case 0:h.year="numeric";break;case 1:h.month="short";break;case 2:h.day="numeric";break;case 3:h.hour12=!1,h.hour="2-digit",h.minute="2-digit";break;case 4:h.hour12=!1,h.hour="2-digit",h.minute="2-digit",h.second="2-digit"}const a=r.Od===void 0?new Date(1e3*r.Vd):new Date(Date.UTC(r.Od.year,r.Od.month-1,r.Od.day));return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()).toLocaleString(l,h)}(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(gb,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,s=0){if(i.length===0)return;let r=s===0?null:i[s-1].time.Vd,o=r!==null?new Date(1e3*r):null,l=0;for(let h=s;h<i.length;++h){const a=i[h],c=new Date(1e3*a.time.Vd);o!==null&&(a.timeWeight=Zh(c,o)),l+=a.time.Vd-(r||a.time.Vd),r=a.time.Vd,o=c}if(s===0&&i.length>1){const h=Math.ceil(l/(i.length-1)),a=new Date(1e3*(i[0].time.Vd-h));i[0].timeWeight=Zh(new Date(1e3*i[0].time.Vd),a)}})(t,e)}static Ad(t){return Wt({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const gi=typeof window<"u";function ia(){return!!gi&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function ir(){return!!gi&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function ro(n){return n+n%2}function sr(n,t){return n.Id-t.Id}function nr(n,t,e){const i=(n.Id-t.Id)/(n.ot-t.ot);return Math.sign(i)*Math.min(Math.abs(i),e)}class Mb{constructor(t,e,i,s){this.zd=null,this.Ld=null,this.Ed=null,this.Nd=null,this.Fd=null,this.Wd=0,this.jd=0,this.Hd=t,this.$d=e,this.Ud=i,this.rs=s}qd(t,e){if(this.zd!==null){if(this.zd.ot===e)return void(this.zd.Id=t);if(Math.abs(this.zd.Id-t)<this.rs)return}this.Nd=this.Ed,this.Ed=this.Ld,this.Ld=this.zd,this.zd={ot:e,Id:t}}Dr(t,e){if(this.zd===null||this.Ld===null||e-this.zd.ot>50)return;let i=0;const s=nr(this.zd,this.Ld,this.$d),r=sr(this.zd,this.Ld),o=[s],l=[r];if(i+=r,this.Ed!==null){const a=nr(this.Ld,this.Ed,this.$d);if(Math.sign(a)===Math.sign(s)){const c=sr(this.Ld,this.Ed);if(o.push(a),l.push(c),i+=c,this.Nd!==null){const u=nr(this.Ed,this.Nd,this.$d);if(Math.sign(u)===Math.sign(s)){const f=sr(this.Ed,this.Nd);o.push(u),l.push(f),i+=f}}}}let h=0;for(let a=0;a<o.length;++a)h+=l[a]/i*o[a];Math.abs(h)<this.Hd||(this.Fd={Id:t,ot:e},this.jd=h,this.Wd=function(a,c){const u=Math.log(c);return Math.log(1*u/-a)/u}(Math.abs(h),this.Ud))}Qu(t){const e=M(this.Fd),i=t-e.ot;return e.Id+this.jd*(Math.pow(this.Ud,i)-1)/Math.log(this.Ud)}Ju(t){return this.Fd===null||this.Yd(t)===this.Wd}Yd(t){const e=t-M(this.Fd).ot;return Math.min(e,this.Wd)}}class Ab{constructor(t,e){this.Zd=void 0,this.Xd=void 0,this.Kd=void 0,this.en=!1,this.Gd=t,this.Jd=e,this.Qd()}bt(){this.Qd()}tf(){this.Zd&&this.Gd.removeChild(this.Zd),this.Xd&&this.Gd.removeChild(this.Xd),this.Zd=void 0,this.Xd=void 0}if(){return this.en!==this.nf()||this.Kd!==this.sf()}sf(){return Su(qi(this.Jd.W().layout.textColor))>160?"dark":"light"}nf(){return this.Jd.W().layout.attributionLogo}ef(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Qd(){this.if()&&(this.tf(),this.en=this.nf(),this.en&&(this.Kd=this.sf(),this.Xd=document.createElement("style"),this.Xd.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Zd=document.createElement("a"),this.Zd.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.ef()}`,this.Zd.title="Charting by TradingView",this.Zd.id="tv-attr-logo",this.Zd.target="_blank",this.Zd.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 19" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Zd.toggleAttribute("data-dark",this.Kd==="dark"),this.Gd.appendChild(this.Xd),this.Gd.appendChild(this.Zd)))}}function je(n,t){const e=M(n.ownerDocument).createElement("canvas");n.appendChild(e);const i=Rm(e,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(s,r)=>({width:Math.max(s.width,r.width),height:Math.max(s.height,r.height)})});return i.resizeCanvasElement(t),i}function Ke(n){var t;n.width=1,n.height=1,(t=n.getContext("2d"))===null||t===void 0||t.clearRect(0,0,1,1)}function oo(n,t,e,i){n.wl&&n.wl(t,e,i)}function Xs(n,t,e,i){n.X(t,e,i)}function lo(n,t,e,i){const s=n(e,i);for(const r of s){const o=r.gt();o!==null&&t(o)}}function Eb(n){gi&&window.chrome!==void 0&&n.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class Uo{constructor(t,e,i){this.rf=0,this.hf=null,this.lf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.af=0,this._f=null,this.uf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.cf=null,this.df=!1,this.ff=null,this.vf=null,this.pf=!1,this.mf=!1,this.bf=!1,this.wf=null,this.gf=null,this.Mf=null,this.xf=null,this.Sf=null,this.kf=null,this.yf=null,this.Cf=0,this.Tf=!1,this.Pf=!1,this.Rf=!1,this.Df=0,this.Vf=null,this.Of=!ir(),this.Bf=s=>{this.Af(s)},this.If=s=>{if(this.zf(s)){const r=this.Lf(s);if(++this.af,this._f&&this.af>1){const{Ef:o}=this.Nf(Xt(s),this.uf);o<30&&!this.bf&&this.Ff(r,this.jf.Wf),this.Hf()}}else{const r=this.Lf(s);if(++this.rf,this.hf&&this.rf>1){const{Ef:o}=this.Nf(Xt(s),this.lf);o<5&&!this.mf&&this.$f(r,this.jf.Uf),this.qf()}}},this.Yf=t,this.jf=e,this.cn=i,this.Zf()}S(){this.wf!==null&&(this.wf(),this.wf=null),this.gf!==null&&(this.gf(),this.gf=null),this.xf!==null&&(this.xf(),this.xf=null),this.Sf!==null&&(this.Sf(),this.Sf=null),this.kf!==null&&(this.kf(),this.kf=null),this.Mf!==null&&(this.Mf(),this.Mf=null),this.Xf(),this.qf()}Kf(t){this.xf&&this.xf();const e=this.Gf.bind(this);if(this.xf=()=>{this.Yf.removeEventListener("mousemove",e)},this.Yf.addEventListener("mousemove",e),this.zf(t))return;const i=this.Lf(t);this.$f(i,this.jf.Jf),this.Of=!0}qf(){this.hf!==null&&clearTimeout(this.hf),this.rf=0,this.hf=null,this.lf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Hf(){this._f!==null&&clearTimeout(this._f),this.af=0,this._f=null,this.uf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Gf(t){if(this.Rf||this.vf!==null||this.zf(t))return;const e=this.Lf(t);this.$f(e,this.jf.Qf),this.Of=!0}tv(t){const e=rr(t.changedTouches,M(this.Vf));if(e===null||(this.Df=zs(t),this.yf!==null)||this.Pf)return;this.Tf=!0;const i=this.Nf(Xt(e),M(this.vf)),{iv:s,nv:r,Ef:o}=i;if(this.pf||!(o<5)){if(!this.pf){const l=.5*s,h=r>=l&&!this.cn.sv(),a=l>r&&!this.cn.ev();h||a||(this.Pf=!0),this.pf=!0,this.bf=!0,this.Xf(),this.Hf()}if(!this.Pf){const l=this.Lf(t,e);this.Ff(l,this.jf.rv),Xe(t)}}}hv(t){if(t.button!==0)return;const e=this.Nf(Xt(t),M(this.ff)),{Ef:i}=e;if(i>=5&&(this.mf=!0,this.qf()),this.mf){const s=this.Lf(t);this.$f(s,this.jf.lv)}}Nf(t,e){const i=Math.abs(e.nt-t.nt),s=Math.abs(e.st-t.st);return{iv:i,nv:s,Ef:i+s}}av(t){let e=rr(t.changedTouches,M(this.Vf));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.Vf=null,this.Df=zs(t),this.Xf(),this.vf=null,this.kf&&(this.kf(),this.kf=null);const i=this.Lf(t,e);if(this.Ff(i,this.jf.ov),++this.af,this._f&&this.af>1){const{Ef:s}=this.Nf(Xt(e),this.uf);s<30&&!this.bf&&this.Ff(i,this.jf.Wf),this.Hf()}else this.bf||(this.Ff(i,this.jf._v),this.jf._v&&Xe(t));this.af===0&&Xe(t),t.touches.length===0&&this.df&&(this.df=!1,Xe(t))}Af(t){if(t.button!==0)return;const e=this.Lf(t);if(this.ff=null,this.Rf=!1,this.Sf&&(this.Sf(),this.Sf=null),ia()&&this.Yf.ownerDocument.documentElement.removeEventListener("mouseleave",this.Bf),!this.zf(t))if(this.$f(e,this.jf.uv),++this.rf,this.hf&&this.rf>1){const{Ef:i}=this.Nf(Xt(t),this.lf);i<5&&!this.mf&&this.$f(e,this.jf.Uf),this.qf()}else this.mf||this.$f(e,this.jf.cv)}Xf(){this.cf!==null&&(clearTimeout(this.cf),this.cf=null)}dv(t){if(this.Vf!==null)return;const e=t.changedTouches[0];this.Vf=e.identifier,this.Df=zs(t);const i=this.Yf.ownerDocument.documentElement;this.bf=!1,this.pf=!1,this.Pf=!1,this.vf=Xt(e),this.kf&&(this.kf(),this.kf=null);{const r=this.tv.bind(this),o=this.av.bind(this);this.kf=()=>{i.removeEventListener("touchmove",r),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",r,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this.Xf(),this.cf=setTimeout(this.fv.bind(this,t),240)}const s=this.Lf(t,e);this.Ff(s,this.jf.vv),this._f||(this.af=0,this._f=setTimeout(this.Hf.bind(this),500),this.uf=Xt(e))}pv(t){if(t.button!==0)return;const e=this.Yf.ownerDocument.documentElement;ia()&&e.addEventListener("mouseleave",this.Bf),this.mf=!1,this.ff=Xt(t),this.Sf&&(this.Sf(),this.Sf=null);{const s=this.hv.bind(this),r=this.Af.bind(this);this.Sf=()=>{e.removeEventListener("mousemove",s),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",s),e.addEventListener("mouseup",r)}if(this.Rf=!0,this.zf(t))return;const i=this.Lf(t);this.$f(i,this.jf.mv),this.hf||(this.rf=0,this.hf=setTimeout(this.qf.bind(this),500),this.lf=Xt(t))}Zf(){this.Yf.addEventListener("mouseenter",this.Kf.bind(this)),this.Yf.addEventListener("touchcancel",this.Xf.bind(this));{const t=this.Yf.ownerDocument,e=i=>{this.jf.bv&&(i.composed&&this.Yf.contains(i.composedPath()[0])||i.target&&this.Yf.contains(i.target)||this.jf.bv())};this.gf=()=>{t.removeEventListener("touchstart",e)},this.wf=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}ir()&&(this.Mf=()=>{this.Yf.removeEventListener("dblclick",this.If)},this.Yf.addEventListener("dblclick",this.If)),this.Yf.addEventListener("mouseleave",this.wv.bind(this)),this.Yf.addEventListener("touchstart",this.dv.bind(this),{passive:!0}),Eb(this.Yf),this.Yf.addEventListener("mousedown",this.pv.bind(this)),this.gv(),this.Yf.addEventListener("touchmove",()=>{},{passive:!1})}gv(){this.jf.Mv===void 0&&this.jf.xv===void 0&&this.jf.Sv===void 0||(this.Yf.addEventListener("touchstart",t=>this.kv(t.touches),{passive:!0}),this.Yf.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.yf!==null&&this.jf.xv!==void 0){const e=sa(t.touches[0],t.touches[1])/this.Cf;this.jf.xv(this.yf,e),Xe(t)}},{passive:!1}),this.Yf.addEventListener("touchend",t=>{this.kv(t.touches)}))}kv(t){t.length===1&&(this.Tf=!1),t.length!==2||this.Tf||this.df?this.yv():this.Cv(t)}Cv(t){const e=this.Yf.getBoundingClientRect()||{left:0,top:0};this.yf={nt:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,st:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Cf=sa(t[0],t[1]),this.jf.Mv!==void 0&&this.jf.Mv(),this.Xf()}yv(){this.yf!==null&&(this.yf=null,this.jf.Sv!==void 0&&this.jf.Sv())}wv(t){if(this.xf&&this.xf(),this.zf(t)||!this.Of)return;const e=this.Lf(t);this.$f(e,this.jf.Tv),this.Of=!ir()}fv(t){const e=rr(t.touches,M(this.Vf));if(e===null)return;const i=this.Lf(t,e);this.Ff(i,this.jf.Pv),this.bf=!0,this.df=!0}zf(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:zs(t)<this.Df+500}Ff(t,e){e&&e.call(this.jf,t)}$f(t,e){e&&e.call(this.jf,t)}Lf(t,e){const i=e||t,s=this.Yf.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-s.left,localY:i.clientY-s.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Rv:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Dv:t.type,Vv:i.target,Ov:t.view,Bv:()=>{t.type!=="touchstart"&&Xe(t)}}}}function sa(n,t){const e=n.clientX-t.clientX,i=n.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Xe(n){n.cancelable&&n.preventDefault()}function Xt(n){return{nt:n.pageX,st:n.pageY}}function zs(n){return n.timeStamp||performance.now()}function rr(n,t){for(let e=0;e<n.length;++e)if(n[e].identifier===t)return n[e];return null}function Bs(n){return{jc:n.jc,Av:{wr:n.Iv.externalId},zv:n.Iv.cursorStyle}}function Tb(n,t,e){for(const i of n){const s=i.gt();if(s!==null&&s.br){const r=s.br(t,e);if(r!==null)return{Ov:i,Av:r}}}return null}function or(n,t){return e=>{var i,s,r,o;return((s=(i=e.Dt())===null||i===void 0?void 0:i.Ta())!==null&&s!==void 0?s:"")!==t?[]:(o=(r=e.ca)===null||r===void 0?void 0:r.call(e,n))!==null&&o!==void 0?o:[]}}function na(n,t,e,i){if(!n.length)return;let s=0;const r=e/2,o=n[0].At(i,!0);let l=t===1?r-(n[0].Vi()-o/2):n[0].Vi()-o/2-r;l=Math.max(0,l);for(let h=1;h<n.length;h++){const a=n[h],c=n[h-1],u=c.At(i,!1),f=a.Vi(),g=c.Vi();if(t===1?f>g-u:f<g+u){const p=g-u*t;a.Oi(p);const m=p-t*u/2;if((t===1?m<0:m>e)&&l>0){const b=t===1?-1-m:m-e,v=Math.min(b,l);for(let w=s;w<n.length;w++)n[w].Oi(n[w].Vi()+t*v);l-=v}}else s=h,l=t===1?g-u-f:f-(g+u)}}class ra{constructor(t,e,i,s){this.Li=null,this.Lv=null,this.Ev=!1,this.Nv=new Zi(200),this.Jr=null,this.Fv=0,this.Wv=!1,this.jv=()=>{this.Wv||this.tn.Hv().$t().$h()},this.$v=()=>{this.Wv||this.tn.Hv().$t().$h()},this.tn=t,this.cn=e,this.So=e.layout,this.Vc=i,this.Uv=s==="left",this.qv=or("normal",s),this.Yv=or("top",s),this.Zv=or("bottom",s),this.Xv=document.createElement("div"),this.Xv.style.height="100%",this.Xv.style.overflow="hidden",this.Xv.style.width="25px",this.Xv.style.left="0",this.Xv.style.position="relative",this.Kv=je(this.Xv,Q({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const r=this.Kv.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Gv=je(this.Xv,Q({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const o=this.Gv.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const l={mv:this.Jv.bind(this),vv:this.Jv.bind(this),lv:this.Qv.bind(this),rv:this.Qv.bind(this),bv:this.tp.bind(this),uv:this.ip.bind(this),ov:this.ip.bind(this),Uf:this.np.bind(this),Wf:this.np.bind(this),Jf:this.sp.bind(this),Tv:this.ep.bind(this)};this.rp=new Uo(this.Gv.canvasElement,l,{sv:()=>!this.cn.handleScroll.vertTouchDrag,ev:()=>!0})}S(){this.rp.S(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),Ke(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Ke(this.Kv.canvasElement),this.Kv.dispose(),this.Li!==null&&this.Li.Xo().p(this),this.Li=null}hp(){return this.Xv}P(){return this.So.fontSize}lp(){const t=this.Vc.W();return this.Jr!==t.R&&(this.Nv.ir(),this.Jr=t.R),t}ap(){if(this.Li===null)return 0;let t=0;const e=this.lp(),i=M(this.Kv.canvasElement.getContext("2d"));i.save();const s=this.Li.ja();i.font=this.op(),s.length>0&&(t=Math.max(this.Nv.xi(i,s[0].no),this.Nv.xi(i,s[s.length-1].no)));const r=this._p();for(let h=r.length;h--;){const a=this.Nv.xi(i,r[h].Kt());a>t&&(t=a)}const o=this.Li.Ct();if(o!==null&&this.Lv!==null){const h=this.Li.pn(1,o),a=this.Li.pn(this.Lv.height-2,o);t=Math.max(t,this.Nv.xi(i,this.Li.Fi(Math.floor(Math.min(h,a))+.11111111111111,o)),this.Nv.xi(i,this.Li.Fi(Math.ceil(Math.max(h,a))-.11111111111111,o)))}i.restore();const l=t||34;return ro(Math.ceil(e.C+e.T+e.A+e.I+5+l))}up(t){this.Lv!==null&&Be(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`)}cp(){return M(this.Lv).width}Gi(t){this.Li!==t&&(this.Li!==null&&this.Li.Xo().p(this),this.Li=t,t.Xo().l(this.do.bind(this),this))}Dt(){return this.Li}ir(){const t=this.tn.dp();this.tn.Hv().$t().L_(t,M(this.Dt()))}fp(t){if(this.Lv===null)return;if(t!==1){this.vp(),this.Kv.applySuggestedBitmapSize();const i=We(this.Kv);i!==null&&(i.useBitmapCoordinateSpace(s=>{this.pp(s),this.Ae(s)}),this.tn.mp(i,this.Zv),this.bp(i),this.tn.mp(i,this.qv),this.wp(i))}this.Gv.applySuggestedBitmapSize();const e=We(this.Gv);e!==null&&(e.useBitmapCoordinateSpace(({context:i,bitmapSize:s})=>{i.clearRect(0,0,s.width,s.height)}),this.gp(e),this.tn.mp(e,this.Yv))}Mp(){return this.Kv.bitmapSize}xp(t,e,i){const s=this.Mp();s.width>0&&s.height>0&&t.drawImage(this.Kv.canvasElement,e,i)}bt(){var t;(t=this.Li)===null||t===void 0||t.ja()}Jv(t){if(this.Li===null||this.Li.Ni()||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.Hv().$t(),i=this.tn.dp();this.Ev=!0,e.D_(i,this.Li,t.localY)}Qv(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.Hv().$t(),i=this.tn.dp(),s=this.Li;e.V_(i,s,t.localY)}tp(){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const t=this.tn.Hv().$t(),e=this.tn.dp(),i=this.Li;this.Ev&&(this.Ev=!1,t.O_(e,i))}ip(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const e=this.tn.Hv().$t(),i=this.tn.dp();this.Ev=!1,e.O_(i,this.Li)}np(t){this.cn.handleScale.axisDoubleClickReset.price&&this.ir()}sp(t){this.Li!==null&&(!this.tn.Hv().$t().W().handleScale.axisPressedMouseMove.price||this.Li.gh()||this.Li.Vo()||this.Sp(1))}ep(t){this.Sp(0)}_p(){const t=[],e=this.Li===null?void 0:this.Li;return(i=>{for(let s=0;s<i.length;++s){const r=i[s].Rn(this.tn.dp(),e);for(let o=0;o<r.length;o++)t.push(r[o])}})(this.tn.dp().$o()),t}pp({context:t,bitmapSize:e}){const{width:i,height:s}=e,r=this.tn.dp().$t(),o=r.q(),l=r.md();o===l?xn(t,0,0,i,s,o):Cu(t,0,0,i,s,o,l)}Ae({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.Lv===null||this.Li===null||!this.Li.W().borderVisible)return;t.fillStyle=this.Li.W().borderColor;const s=Math.max(1,Math.floor(this.lp().C*i));let r;r=this.Uv?e.width-s:0,t.fillRect(r,0,s,e.height)}bp(t){if(this.Lv===null||this.Li===null)return;const e=this.Li.ja(),i=this.Li.W(),s=this.lp(),r=this.Uv?this.Lv.width-s.T:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:l,verticalPixelRatio:h})=>{o.fillStyle=i.borderColor;const a=Math.max(1,Math.floor(h)),c=Math.floor(.5*h),u=Math.round(s.T*l);o.beginPath();for(const f of e)o.rect(Math.floor(r*l),Math.round(f.La*h)-c,u,a);o.fill()}),t.useMediaCoordinateSpace(({context:o})=>{var l;o.font=this.op(),o.fillStyle=(l=i.textColor)!==null&&l!==void 0?l:this.So.textColor,o.textAlign=this.Uv?"right":"left",o.textBaseline="middle";const h=this.Uv?Math.round(r-s.A):Math.round(r+s.T+s.A),a=e.map(c=>this.Nv.Mi(o,c.no));for(let c=e.length;c--;){const u=e[c];o.fillText(u.no,h,u.La+a[c])}})}vp(){if(this.Lv===null||this.Li===null)return;const t=[],e=this.Li.$o().slice(),i=this.tn.dp(),s=this.lp();this.Li===i.vr()&&this.tn.dp().$o().forEach(o=>{i.dr(o)&&e.push(o)});const r=this.Li;e.forEach(o=>{o.Rn(i,r).forEach(l=>{l.Oi(null),l.Bi()&&t.push(l)})}),t.forEach(o=>o.Oi(o.ki())),this.Li.W().alignLabels&&this.kp(t,s)}kp(t,e){if(this.Lv===null)return;const i=this.Lv.height/2,s=t.filter(o=>o.ki()<=i),r=t.filter(o=>o.ki()>i);s.sort((o,l)=>l.ki()-o.ki()),r.sort((o,l)=>o.ki()-l.ki());for(const o of t){const l=Math.floor(o.At(e)/2),h=o.ki();h>-l&&h<l&&o.Oi(l),h>this.Lv.height-l&&h<this.Lv.height+l&&o.Oi(this.Lv.height-l)}na(s,1,this.Lv.height,e),na(r,-1,this.Lv.height,e)}wp(t){if(this.Lv===null)return;const e=this._p(),i=this.lp(),s=this.Uv?"right":"left";e.forEach(r=>{r.Ai()&&r.gt(M(this.Li)).X(t,i,this.Nv,s)})}gp(t){if(this.Lv===null||this.Li===null)return;const e=this.tn.Hv().$t(),i=[],s=this.tn.dp(),r=e.Yc().Rn(s,this.Li);r.length&&i.push(r);const o=this.lp(),l=this.Uv?"right":"left";i.forEach(h=>{h.forEach(a=>{a.gt(M(this.Li)).X(t,o,this.Nv,l)})})}Sp(t){this.Xv.style.cursor=t===1?"ns-resize":"default"}do(){const t=this.ap();this.Fv<t&&this.tn.Hv().$t().Xl(),this.Fv=t}op(){return di(this.So.fontSize,this.So.fontFamily)}}function Db(n,t){var e,i;return(i=(e=n._a)===null||e===void 0?void 0:e.call(n,t))!==null&&i!==void 0?i:[]}function _s(n,t){var e,i;return(i=(e=n.Pn)===null||e===void 0?void 0:e.call(n,t))!==null&&i!==void 0?i:[]}function Lb(n,t){var e,i;return(i=(e=n.Ji)===null||e===void 0?void 0:e.call(n,t))!==null&&i!==void 0?i:[]}function Ob(n,t){var e,i;return(i=(e=n.la)===null||e===void 0?void 0:e.call(n,t))!==null&&i!==void 0?i:[]}class Xo{constructor(t,e){this.Lv=Q({width:0,height:0}),this.yp=null,this.Cp=null,this.Tp=null,this.Pp=null,this.Rp=!1,this.Dp=new lt,this.Vp=new lt,this.Op=0,this.Bp=!1,this.Ap=null,this.Ip=!1,this.zp=null,this.Lp=null,this.Wv=!1,this.jv=()=>{this.Wv||this.Ep===null||this.$i().$h()},this.$v=()=>{this.Wv||this.Ep===null||this.$i().$h()},this.Jd=t,this.Ep=e,this.Ep.F_().l(this.Np.bind(this),this,!0),this.Fp=document.createElement("td"),this.Fp.style.padding="0",this.Fp.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.Wp=document.createElement("td"),this.Wp.style.padding="0",this.jp=document.createElement("td"),this.jp.style.padding="0",this.Fp.appendChild(i),this.Kv=je(i,Q({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const s=this.Kv.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Gv=je(i,Q({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const r=this.Gv.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.Hp=document.createElement("tr"),this.Hp.appendChild(this.Wp),this.Hp.appendChild(this.Fp),this.Hp.appendChild(this.jp),this.$p(),this.rp=new Uo(this.Gv.canvasElement,this,{sv:()=>this.Ap===null&&!this.Jd.W().handleScroll.vertTouchDrag,ev:()=>this.Ap===null&&!this.Jd.W().handleScroll.horzTouchDrag})}S(){this.yp!==null&&this.yp.S(),this.Cp!==null&&this.Cp.S(),this.Tp=null,this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),Ke(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Ke(this.Kv.canvasElement),this.Kv.dispose(),this.Ep!==null&&this.Ep.F_().p(this),this.rp.S()}dp(){return M(this.Ep)}Up(t){var e,i;this.Ep!==null&&this.Ep.F_().p(this),this.Ep=t,this.Ep!==null&&this.Ep.F_().l(Xo.prototype.Np.bind(this),this,!0),this.$p(),this.Jd.qp().indexOf(this)===this.Jd.qp().length-1?(this.Tp=(e=this.Tp)!==null&&e!==void 0?e:new Ab(this.Fp,this.Jd),this.Tp.bt()):((i=this.Tp)===null||i===void 0||i.tf(),this.Tp=null)}Hv(){return this.Jd}hp(){return this.Hp}$p(){if(this.Ep!==null&&(this.Yp(),this.$i().wt().length!==0)){if(this.yp!==null){const t=this.Ep.P_();this.yp.Gi(M(t))}if(this.Cp!==null){const t=this.Ep.R_();this.Cp.Gi(M(t))}}}Zp(){this.yp!==null&&this.yp.bt(),this.Cp!==null&&this.Cp.bt()}g_(){return this.Ep!==null?this.Ep.g_():0}M_(t){this.Ep&&this.Ep.M_(t)}Jf(t){if(!this.Ep)return;this.Xp();const e=t.localX,i=t.localY;this.Kp(e,i,t)}mv(t){this.Xp(),this.Gp(),this.Kp(t.localX,t.localY,t)}Qf(t){var e;if(!this.Ep)return;this.Xp();const i=t.localX,s=t.localY;this.Kp(i,s,t);const r=this.br(i,s);this.Jd.Jp((e=r?.zv)!==null&&e!==void 0?e:null),this.$i().Wc(r&&{jc:r.jc,Av:r.Av})}cv(t){this.Ep!==null&&(this.Xp(),this.Qp(t))}Uf(t){this.Ep!==null&&this.tm(this.Vp,t)}Wf(t){this.Uf(t)}lv(t){this.Xp(),this.im(t),this.Kp(t.localX,t.localY,t)}uv(t){this.Ep!==null&&(this.Xp(),this.Bp=!1,this.nm(t))}_v(t){this.Ep!==null&&this.Qp(t)}Pv(t){if(this.Bp=!0,this.Ap===null){const e={x:t.localX,y:t.localY};this.sm(e,e,t)}}Tv(t){this.Ep!==null&&(this.Xp(),this.Ep.$t().Wc(null),this.rm())}hm(){return this.Dp}lm(){return this.Vp}Mv(){this.Op=1,this.$i().Un()}xv(t,e){if(!this.Jd.W().handleScale.pinch)return;const i=5*(e-this.Op);this.Op=e,this.$i().Jc(t.nt,i)}vv(t){this.Bp=!1,this.Ip=this.Ap!==null,this.Gp();const e=this.$i().Yc();this.Ap!==null&&e.yt()&&(this.zp={x:e.Yt(),y:e.Zt()},this.Ap={x:t.localX,y:t.localY})}rv(t){if(this.Ep===null)return;const e=t.localX,i=t.localY;if(this.Ap===null)this.im(t);else{this.Ip=!1;const s=M(this.zp),r=s.x+(e-this.Ap.x),o=s.y+(i-this.Ap.y);this.Kp(r,o,t)}}ov(t){this.Hv().W().trackingMode.exitMode===0&&(this.Ip=!0),this.am(),this.nm(t)}br(t,e){const i=this.Ep;return i===null?null:function(s,r,o){const l=s.$o(),h=function(a,c,u){var f,g;let p,m;for(const w of a){const x=(g=(f=w.fa)===null||f===void 0?void 0:f.call(w,c,u))!==null&&g!==void 0?g:[];for(const y of x)b=y.zOrder,(!(v=p?.zOrder)||b==="top"&&v!=="top"||b==="normal"&&v==="bottom")&&(p=y,m=w)}var b,v;return p&&m?{Iv:p,jc:m}:null}(l,r,o);if(h?.Iv.zOrder==="top")return Bs(h);for(const a of l){if(h&&h.jc===a&&h.Iv.zOrder!=="bottom"&&!h.Iv.isBackground)return Bs(h);const c=Tb(a.Pn(s),r,o);if(c!==null)return{jc:a,Ov:c.Ov,Av:c.Av};if(h&&h.jc===a&&h.Iv.zOrder!=="bottom"&&h.Iv.isBackground)return Bs(h)}return h?.Iv?Bs(h):null}(i,t,e)}om(t,e){M(e==="left"?this.yp:this.Cp).up(Q({width:t,height:this.Lv.height}))}_m(){return this.Lv}up(t){Be(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Fp.style.width=t.width+"px",this.Fp.style.height=t.height+"px")}um(){const t=M(this.Ep);t.T_(t.P_()),t.T_(t.R_());for(const e of t.Oa())if(t.dr(e)){const i=e.Dt();i!==null&&t.T_(i),e.Vn()}}Mp(){return this.Kv.bitmapSize}xp(t,e,i){const s=this.Mp();s.width>0&&s.height>0&&t.drawImage(this.Kv.canvasElement,e,i)}fp(t){if(t===0||this.Ep===null)return;if(t>1&&this.um(),this.yp!==null&&this.yp.fp(t),this.Cp!==null&&this.Cp.fp(t),t!==1){this.Kv.applySuggestedBitmapSize();const i=We(this.Kv);i!==null&&(i.useBitmapCoordinateSpace(s=>{this.pp(s)}),this.Ep&&(this.dm(i,Db),this.fm(i),this.vm(i),this.dm(i,_s),this.dm(i,Lb)))}this.Gv.applySuggestedBitmapSize();const e=We(this.Gv);e!==null&&(e.useBitmapCoordinateSpace(({context:i,bitmapSize:s})=>{i.clearRect(0,0,s.width,s.height)}),this.pm(e),this.dm(e,Ob))}bm(){return this.yp}wm(){return this.Cp}mp(t,e){this.dm(t,e)}Np(){this.Ep!==null&&this.Ep.F_().p(this),this.Ep=null}Qp(t){this.tm(this.Dp,t)}tm(t,e){const i=e.localX,s=e.localY;t.M()&&t.m(this.$i().St().Eu(i),{x:i,y:s},e)}pp({context:t,bitmapSize:e}){const{width:i,height:s}=e,r=this.$i(),o=r.q(),l=r.md();o===l?xn(t,0,0,i,s,l):Cu(t,0,0,i,s,o,l)}fm(t){const e=M(this.Ep).W_().Uh().gt();e!==null&&e.X(t,!1)}vm(t){const e=this.$i().qc();this.gm(t,_s,oo,e),this.gm(t,_s,Xs,e)}pm(t){this.gm(t,_s,Xs,this.$i().Yc())}dm(t,e){const i=M(this.Ep).$o();for(const s of i)this.gm(t,e,oo,s);for(const s of i)this.gm(t,e,Xs,s)}gm(t,e,i,s){const r=M(this.Ep),o=r.$t().Fc(),l=o!==null&&o.jc===s,h=o!==null&&l&&o.Av!==void 0?o.Av.gr:void 0;lo(e,a=>i(a,t,l,h),s,r)}Yp(){if(this.Ep===null)return;const t=this.Jd,e=this.Ep.P_().W().visible,i=this.Ep.R_().W().visible;e||this.yp===null||(this.Wp.removeChild(this.yp.hp()),this.yp.S(),this.yp=null),i||this.Cp===null||(this.jp.removeChild(this.Cp.hp()),this.Cp.S(),this.Cp=null);const s=t.$t()._d();e&&this.yp===null&&(this.yp=new ra(this,t.W(),s,"left"),this.Wp.appendChild(this.yp.hp())),i&&this.Cp===null&&(this.Cp=new ra(this,t.W(),s,"right"),this.jp.appendChild(this.Cp.hp()))}Mm(t){return t.Rv&&this.Bp||this.Ap!==null}xm(t){return Math.max(0,Math.min(t,this.Lv.width-1))}Sm(t){return Math.max(0,Math.min(t,this.Lv.height-1))}Kp(t,e,i){this.$i().hd(this.xm(t),this.Sm(e),i,M(this.Ep))}rm(){this.$i().ad()}am(){this.Ip&&(this.Ap=null,this.rm())}sm(t,e,i){this.Ap=t,this.Ip=!1,this.Kp(e.x,e.y,i);const s=this.$i().Yc();this.zp={x:s.Yt(),y:s.Zt()}}$i(){return this.Jd.$t()}nm(t){if(!this.Rp)return;const e=this.$i(),i=this.dp();if(e.I_(i,i.vn()),this.Pp=null,this.Rp=!1,e.sd(),this.Lp!==null){const s=performance.now(),r=e.St();this.Lp.Dr(r.ju(),s),this.Lp.Ju(s)||e.Zn(this.Lp)}}Xp(){this.Ap=null}Gp(){if(this.Ep){if(this.$i().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)M(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.Ep.vn().Ni()&&this.$i().St().Ni()}}im(t){if(this.Ep===null)return;const e=this.$i(),i=e.St();if(i.Ni())return;const s=this.Jd.W(),r=s.handleScroll,o=s.kineticScroll;if((!r.pressedMouseMove||t.Rv)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.Rv))return;const l=this.Ep.vn(),h=performance.now();if(this.Pp!==null||this.Mm(t)||(this.Pp={x:t.clientX,y:t.clientY,Vd:h,km:t.localX,ym:t.localY}),this.Pp!==null&&!this.Rp&&(this.Pp.x!==t.clientX||this.Pp.y!==t.clientY)){if(t.Rv&&o.touch||!t.Rv&&o.mouse){const a=i.he();this.Lp=new Mb(.2/a,7/a,.997,15/a),this.Lp.qd(i.ju(),this.Pp.Vd)}else this.Lp=null;l.Ni()||e.B_(this.Ep,l,t.localY),e.td(t.localX),this.Rp=!0}this.Rp&&(l.Ni()||e.A_(this.Ep,l,t.localY),e.nd(t.localX),this.Lp!==null&&this.Lp.qd(i.ju(),h))}}class oa{constructor(t,e,i,s,r){this.ft=!0,this.Lv=Q({width:0,height:0}),this.jv=()=>this.fp(3),this.Uv=t==="left",this.Vc=i._d,this.cn=e,this.Cm=s,this.Tm=r,this.Xv=document.createElement("div"),this.Xv.style.width="25px",this.Xv.style.height="100%",this.Xv.style.overflow="hidden",this.Kv=je(this.Xv,Q({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv)}S(){this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Ke(this.Kv.canvasElement),this.Kv.dispose()}hp(){return this.Xv}_m(){return this.Lv}up(t){Be(this.Lv,t)||(this.Lv=t,this.Kv.resizeCanvasElement(t),this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`,this.ft=!0)}fp(t){if(t<3&&!this.ft||this.Lv.width===0||this.Lv.height===0)return;this.ft=!1,this.Kv.applySuggestedBitmapSize();const e=We(this.Kv);e!==null&&e.useBitmapCoordinateSpace(i=>{this.pp(i),this.Ae(i)})}Mp(){return this.Kv.bitmapSize}xp(t,e,i){const s=this.Mp();s.width>0&&s.height>0&&t.drawImage(this.Kv.canvasElement,e,i)}Ae({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:s}){if(!this.Cm())return;t.fillStyle=this.cn.timeScale.borderColor;const r=Math.floor(this.Vc.W().C*i),o=Math.floor(this.Vc.W().C*s),l=this.Uv?e.width-r:0;t.fillRect(l,0,r,o)}pp({context:t,bitmapSize:e}){xn(t,0,0,e.width,e.height,this.Tm())}}function Go(n){return t=>{var e,i;return(i=(e=t.da)===null||e===void 0?void 0:e.call(t,n))!==null&&i!==void 0?i:[]}}const Pb=Go("normal"),Nb=Go("top"),zb=Go("bottom");class Bb{constructor(t,e){this.Pm=null,this.Rm=null,this.k=null,this.Dm=!1,this.Lv=Q({width:0,height:0}),this.Vm=new lt,this.Nv=new Zi(5),this.Wv=!1,this.jv=()=>{this.Wv||this.Jd.$t().$h()},this.$v=()=>{this.Wv||this.Jd.$t().$h()},this.Jd=t,this.U_=e,this.cn=t.W().layout,this.Zd=document.createElement("tr"),this.Om=document.createElement("td"),this.Om.style.padding="0",this.Bm=document.createElement("td"),this.Bm.style.padding="0",this.Xv=document.createElement("td"),this.Xv.style.height="25px",this.Xv.style.padding="0",this.Am=document.createElement("div"),this.Am.style.width="100%",this.Am.style.height="100%",this.Am.style.position="relative",this.Am.style.overflow="hidden",this.Xv.appendChild(this.Am),this.Kv=je(this.Am,Q({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const i=this.Kv.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Gv=je(this.Am,Q({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const s=this.Gv.canvasElement;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.Zd.appendChild(this.Om),this.Zd.appendChild(this.Xv),this.Zd.appendChild(this.Bm),this.Im(),this.Jd.$t().w_().l(this.Im.bind(this),this),this.rp=new Uo(this.Gv.canvasElement,this,{sv:()=>!0,ev:()=>!this.Jd.W().handleScroll.horzTouchDrag})}S(){this.rp.S(),this.Pm!==null&&this.Pm.S(),this.Rm!==null&&this.Rm.S(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),Ke(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),Ke(this.Kv.canvasElement),this.Kv.dispose()}hp(){return this.Zd}zm(){return this.Pm}Lm(){return this.Rm}mv(t){if(this.Dm)return;this.Dm=!0;const e=this.Jd.$t();!e.St().Ni()&&this.Jd.W().handleScale.axisPressedMouseMove.time&&e.Gc(t.localX)}vv(t){this.mv(t)}bv(){const t=this.Jd.$t();!t.St().Ni()&&this.Dm&&(this.Dm=!1,this.Jd.W().handleScale.axisPressedMouseMove.time&&t.rd())}lv(t){const e=this.Jd.$t();!e.St().Ni()&&this.Jd.W().handleScale.axisPressedMouseMove.time&&e.ed(t.localX)}rv(t){this.lv(t)}uv(){this.Dm=!1;const t=this.Jd.$t();t.St().Ni()&&!this.Jd.W().handleScale.axisPressedMouseMove.time||t.rd()}ov(){this.uv()}Uf(){this.Jd.W().handleScale.axisDoubleClickReset.time&&this.Jd.$t().Kn()}Wf(){this.Uf()}Jf(){this.Jd.$t().W().handleScale.axisPressedMouseMove.time&&this.Sp(1)}Tv(){this.Sp(0)}_m(){return this.Lv}Em(){return this.Vm}Nm(t,e,i){Be(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`,this.Vm.m(t)),this.Pm!==null&&this.Pm.up(Q({width:e,height:t.height})),this.Rm!==null&&this.Rm.up(Q({width:i,height:t.height}))}Fm(){const t=this.Wm();return Math.ceil(t.C+t.T+t.P+t.L+t.B+t.jm)}bt(){this.Jd.$t().St().ja()}Mp(){return this.Kv.bitmapSize}xp(t,e,i){const s=this.Mp();s.width>0&&s.height>0&&t.drawImage(this.Kv.canvasElement,e,i)}fp(t){if(t===0)return;if(t!==1){this.Kv.applySuggestedBitmapSize();const i=We(this.Kv);i!==null&&(i.useBitmapCoordinateSpace(s=>{this.pp(s),this.Ae(s),this.Hm(i,zb)}),this.bp(i),this.Hm(i,Pb)),this.Pm!==null&&this.Pm.fp(t),this.Rm!==null&&this.Rm.fp(t)}this.Gv.applySuggestedBitmapSize();const e=We(this.Gv);e!==null&&(e.useBitmapCoordinateSpace(({context:i,bitmapSize:s})=>{i.clearRect(0,0,s.width,s.height)}),this.$m([...this.Jd.$t().wt(),this.Jd.$t().Yc()],e),this.Hm(e,Nb))}Hm(t,e){const i=this.Jd.$t().wt();for(const s of i)lo(e,r=>oo(r,t,!1,void 0),s,void 0);for(const s of i)lo(e,r=>Xs(r,t,!1,void 0),s,void 0)}pp({context:t,bitmapSize:e}){xn(t,0,0,e.width,e.height,this.Jd.$t().md())}Ae({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this.Jd.W().timeScale.borderVisible){t.fillStyle=this.Um();const s=Math.max(1,Math.floor(this.Wm().C*i));t.fillRect(0,0,e.width,s)}}bp(t){const e=this.Jd.$t().St(),i=e.ja();if(!i||i.length===0)return;const s=this.U_.maxTickMarkWeight(i),r=this.Wm(),o=e.W();o.borderVisible&&o.ticksVisible&&t.useBitmapCoordinateSpace(({context:l,horizontalPixelRatio:h,verticalPixelRatio:a})=>{l.strokeStyle=this.Um(),l.fillStyle=this.Um();const c=Math.max(1,Math.floor(h)),u=Math.floor(.5*h);l.beginPath();const f=Math.round(r.T*a);for(let g=i.length;g--;){const p=Math.round(i[g].coord*h);l.rect(p-u,0,c,f)}l.fill()}),t.useMediaCoordinateSpace(({context:l})=>{const h=r.C+r.T+r.L+r.P/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.$(),l.font=this.op();for(const a of i)if(a.weight<s){const c=a.needAlignCoordinate?this.qm(l,a.coord,a.label):a.coord;l.fillText(a.label,c,h)}this.Jd.W().timeScale.allowBoldLabels&&(l.font=this.Ym());for(const a of i)if(a.weight>=s){const c=a.needAlignCoordinate?this.qm(l,a.coord,a.label):a.coord;l.fillText(a.label,c,h)}})}qm(t,e,i){const s=this.Nv.xi(t,i),r=s/2,o=Math.floor(e-r)+.5;return o<0?e+=Math.abs(0-o):o+s>this.Lv.width&&(e-=Math.abs(this.Lv.width-(o+s))),e}$m(t,e){const i=this.Wm();for(const s of t)for(const r of s.Qi())r.gt().X(e,i)}Um(){return this.Jd.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}op(){return di(this.j(),this.cn.fontFamily)}Ym(){return di(this.j(),this.cn.fontFamily,"bold")}Wm(){this.k===null&&(this.k={C:1,N:NaN,L:NaN,B:NaN,ji:NaN,T:5,P:NaN,R:"",Wi:new Zi,jm:0});const t=this.k,e=this.op();if(t.R!==e){const i=this.j();t.P=i,t.R=e,t.L=3*i/12,t.B=3*i/12,t.ji=9*i/12,t.N=0,t.jm=4*i/12,t.Wi.ir()}return this.k}Sp(t){this.Xv.style.cursor=t===1?"ew-resize":"default"}Im(){const t=this.Jd.$t(),e=t.W();e.leftPriceScale.visible||this.Pm===null||(this.Om.removeChild(this.Pm.hp()),this.Pm.S(),this.Pm=null),e.rightPriceScale.visible||this.Rm===null||(this.Bm.removeChild(this.Rm.hp()),this.Rm.S(),this.Rm=null);const i={_d:this.Jd.$t()._d()},s=()=>e.leftPriceScale.borderVisible&&t.St().W().borderVisible,r=()=>t.md();e.leftPriceScale.visible&&this.Pm===null&&(this.Pm=new oa("left",e,i,s,r),this.Om.appendChild(this.Pm.hp())),e.rightPriceScale.visible&&this.Rm===null&&(this.Rm=new oa("right",e,i,s,r),this.Bm.appendChild(this.Rm.hp()))}}const _b=!!gi&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(n=>n.brand.includes("Chromium"))&&!!gi&&(!((lr=navigator?.userAgentData)===null||lr===void 0)&&lr.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);var lr;class Rb{constructor(t,e,i){var s;this.Zm=[],this.Xm=0,this.ro=0,this.o_=0,this.Km=0,this.Gm=0,this.Jm=null,this.Qm=!1,this.Dp=new lt,this.Vp=new lt,this.Pc=new lt,this.tb=null,this.ib=null,this.Gd=t,this.cn=e,this.U_=i,this.Zd=document.createElement("div"),this.Zd.classList.add("tv-lightweight-charts"),this.Zd.style.overflow="hidden",this.Zd.style.direction="ltr",this.Zd.style.width="100%",this.Zd.style.height="100%",(s=this.Zd).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.nb=document.createElement("table"),this.nb.setAttribute("cellspacing","0"),this.Zd.appendChild(this.nb),this.sb=this.eb.bind(this),hr(this.cn)&&this.rb(!0),this.$i=new yb(this.Dc.bind(this),this.cn,i),this.$t().Zc().l(this.hb.bind(this),this),this.lb=new Bb(this,this.U_),this.nb.appendChild(this.lb.hp());const r=e.autoSize&&this.ab();let o=this.cn.width,l=this.cn.height;if(r||o===0||l===0){const h=t.getBoundingClientRect();o=o||h.width,l=l||h.height}this.ob(o,l),this._b(),t.appendChild(this.Zd),this.ub(),this.$i.St().sc().l(this.$i.Xl.bind(this.$i),this),this.$i.w_().l(this.$i.Xl.bind(this.$i),this)}$t(){return this.$i}W(){return this.cn}qp(){return this.Zm}cb(){return this.lb}S(){this.rb(!1),this.Xm!==0&&window.cancelAnimationFrame(this.Xm),this.$i.Zc().p(this),this.$i.St().sc().p(this),this.$i.w_().p(this),this.$i.S();for(const t of this.Zm)this.nb.removeChild(t.hp()),t.hm().p(this),t.lm().p(this),t.S();this.Zm=[],M(this.lb).S(),this.Zd.parentElement!==null&&this.Zd.parentElement.removeChild(this.Zd),this.Pc.S(),this.Dp.S(),this.Vp.S(),this.fb()}ob(t,e,i=!1){if(this.ro===e&&this.o_===t)return;const s=function(l){const h=Math.floor(l.width),a=Math.floor(l.height);return Q({width:h-h%2,height:a-a%2})}(Q({width:t,height:e}));this.ro=s.height,this.o_=s.width;const r=this.ro+"px",o=this.o_+"px";M(this.Zd).style.height=r,M(this.Zd).style.width=o,this.nb.style.height=r,this.nb.style.width=o,i?this.pb(pt.es(),performance.now()):this.$i.Xl()}fp(t){t===void 0&&(t=pt.es());for(let e=0;e<this.Zm.length;e++)this.Zm[e].fp(t.Hn(e).Fn);this.cn.timeScale.visible&&this.lb.fp(t.jn())}Hh(t){const e=hr(this.cn);this.$i.Hh(t);const i=hr(this.cn);i!==e&&this.rb(i),this.ub(),this.mb(t)}hm(){return this.Dp}lm(){return this.Vp}Zc(){return this.Pc}bb(){this.Jm!==null&&(this.pb(this.Jm,performance.now()),this.Jm=null);const t=this.wb(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=M(e.getContext("2d"));return this.wb(i),e}gb(t){return t==="left"&&!this.Mb()||t==="right"&&!this.xb()||this.Zm.length===0?0:M(t==="left"?this.Zm[0].bm():this.Zm[0].wm()).cp()}Sb(){return this.cn.autoSize&&this.tb!==null}kb(){return this.Zd}Jp(t){this.ib=t,this.ib?this.kb().style.setProperty("cursor",t):this.kb().style.removeProperty("cursor")}yb(){return this.ib}Cb(){return St(this.Zm[0])._m()}mb(t){(t.autoSize!==void 0||!this.tb||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.tb&&this.ab(),t.autoSize===!1&&this.tb!==null&&this.fb(),t.autoSize||t.width===void 0&&t.height===void 0||this.ob(t.width||this.o_,t.height||this.ro))}wb(t){let e=0,i=0;const s=this.Zm[0],r=(l,h)=>{let a=0;for(let c=0;c<this.Zm.length;c++){const u=this.Zm[c],f=M(l==="left"?u.bm():u.wm()),g=f.Mp();t!==null&&f.xp(t,h,a),a+=g.height}};this.Mb()&&(r("left",0),e+=M(s.bm()).Mp().width);for(let l=0;l<this.Zm.length;l++){const h=this.Zm[l],a=h.Mp();t!==null&&h.xp(t,e,i),i+=a.height}e+=s.Mp().width,this.xb()&&(r("right",e),e+=M(s.wm()).Mp().width);const o=(l,h,a)=>{M(l==="left"?this.lb.zm():this.lb.Lm()).xp(M(t),h,a)};if(this.cn.timeScale.visible){const l=this.lb.Mp();if(t!==null){let h=0;this.Mb()&&(o("left",h,i),h=M(s.bm()).Mp().width),this.lb.xp(t,h,i),h+=l.width,this.xb()&&o("right",h,i)}i+=l.height}return Q({width:e,height:i})}Tb(){let t=0,e=0,i=0;for(const p of this.Zm)this.Mb()&&(e=Math.max(e,M(p.bm()).ap(),this.cn.leftPriceScale.minimumWidth)),this.xb()&&(i=Math.max(i,M(p.wm()).ap(),this.cn.rightPriceScale.minimumWidth)),t+=p.g_();e=ro(e),i=ro(i);const s=this.o_,r=this.ro,o=Math.max(s-e-i,0),l=this.cn.timeScale.visible;let h=l?Math.max(this.lb.Fm(),this.cn.timeScale.minimumHeight):0;var a;h=(a=h)+a%2;const c=0+h,u=r<c?0:r-c,f=u/t;let g=0;for(let p=0;p<this.Zm.length;++p){const m=this.Zm[p];m.Up(this.$i.Uc()[p]);let b=0,v=0;v=p===this.Zm.length-1?u-g:Math.round(m.g_()*f),b=Math.max(v,2),g+=b,m.up(Q({width:o,height:b})),this.Mb()&&m.om(e,"left"),this.xb()&&m.om(i,"right"),m.dp()&&this.$i.Xc(m.dp(),b)}this.lb.Nm(Q({width:l?o:0,height:h}),l?e:0,l?i:0),this.$i.x_(o),this.Km!==e&&(this.Km=e),this.Gm!==i&&(this.Gm=i)}rb(t){t?this.Zd.addEventListener("wheel",this.sb,{passive:!1}):this.Zd.removeEventListener("wheel",this.sb)}Pb(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return _b?1/window.devicePixelRatio:1}eb(t){if(!(t.deltaX!==0&&this.cn.handleScroll.mouseWheel||t.deltaY!==0&&this.cn.handleScale.mouseWheel))return;const e=this.Pb(t),i=e*t.deltaX/100,s=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),s!==0&&this.cn.handleScale.mouseWheel){const r=Math.sign(s)*Math.min(1,Math.abs(s)),o=t.clientX-this.Zd.getBoundingClientRect().left;this.$t().Jc(o,r)}i!==0&&this.cn.handleScroll.mouseWheel&&this.$t().Qc(-80*i)}pb(t,e){var i;const s=t.jn();s===3&&this.Rb(),s!==3&&s!==2||(this.Db(t),this.Vb(t,e),this.lb.bt(),this.Zm.forEach(r=>{r.Zp()}),((i=this.Jm)===null||i===void 0?void 0:i.jn())===3&&(this.Jm.ts(t),this.Rb(),this.Db(this.Jm),this.Vb(this.Jm,e),t=this.Jm,this.Jm=null)),this.fp(t)}Vb(t,e){for(const i of t.Qn())this.ns(i,e)}Db(t){const e=this.$i.Uc();for(let i=0;i<e.length;i++)t.Hn(i).Wn&&e[i].E_()}ns(t,e){const i=this.$i.St();switch(t.qn){case 0:i.rc();break;case 1:i.hc(t.Vt);break;case 2:i.Gn(t.Vt);break;case 3:i.Jn(t.Vt);break;case 4:i.Uu();break;case 5:t.Vt.Ju(e)||i.Jn(t.Vt.Qu(e))}}Dc(t){this.Jm!==null?this.Jm.ts(t):this.Jm=t,this.Qm||(this.Qm=!0,this.Xm=window.requestAnimationFrame(e=>{if(this.Qm=!1,this.Xm=0,this.Jm!==null){const i=this.Jm;this.Jm=null,this.pb(i,e);for(const s of i.Qn())if(s.qn===5&&!s.Vt.Ju(e)){this.$t().Zn(s.Vt);break}}}))}Rb(){this._b()}_b(){const t=this.$i.Uc(),e=t.length,i=this.Zm.length;for(let s=e;s<i;s++){const r=St(this.Zm.pop());this.nb.removeChild(r.hp()),r.hm().p(this),r.lm().p(this),r.S()}for(let s=i;s<e;s++){const r=new Xo(this,t[s]);r.hm().l(this.Ob.bind(this),this),r.lm().l(this.Bb.bind(this),this),this.Zm.push(r),this.nb.insertBefore(r.hp(),this.lb.hp())}for(let s=0;s<e;s++){const r=t[s],o=this.Zm[s];o.dp()!==r?o.Up(r):o.$p()}this.ub(),this.Tb()}Ab(t,e,i){var s;const r=new Map;t!==null&&this.$i.wt().forEach(c=>{const u=c.In().hl(t);u!==null&&r.set(c,u)});let o;if(t!==null){const c=(s=this.$i.St().Ui(t))===null||s===void 0?void 0:s.originalTime;c!==void 0&&(o=c)}const l=this.$t().Fc(),h=l!==null&&l.jc instanceof Ko?l.jc:void 0,a=l!==null&&l.Av!==void 0?l.Av.wr:void 0;return{Ib:o,se:t??void 0,zb:e??void 0,Lb:h,Eb:r,Nb:a,Fb:i??void 0}}Ob(t,e,i){this.Dp.m(()=>this.Ab(t,e,i))}Bb(t,e,i){this.Vp.m(()=>this.Ab(t,e,i))}hb(t,e,i){this.Pc.m(()=>this.Ab(t,e,i))}ub(){const t=this.cn.timeScale.visible?"":"none";this.lb.hp().style.display=t}Mb(){return this.Zm[0].dp().P_().W().visible}xb(){return this.Zm[0].dp().R_().W().visible}ab(){return"ResizeObserver"in window&&(this.tb=new ResizeObserver(t=>{const e=t.find(i=>i.target===this.Gd);e&&this.ob(e.contentRect.width,e.contentRect.height)}),this.tb.observe(this.Gd,{box:"border-box"}),!0)}fb(){this.tb!==null&&this.tb.disconnect(),this.tb=null}}function hr(n){return!!(n.handleScroll.mouseWheel||n.handleScale.mouseWheel)}function Fb(n){return function(t){return t.open!==void 0}(n)||function(t){return t.value!==void 0}(n)}function ju(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var s=0;for(i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]])}return e}function la(n,t,e,i){const s=e.value,r={se:t,ot:n,Vt:[s,s,s,s],Ib:i};return e.color!==void 0&&(r.V=e.color),r}function Vb(n,t,e,i){const s=e.value,r={se:t,ot:n,Vt:[s,s,s,s],Ib:i};return e.lineColor!==void 0&&(r.lt=e.lineColor),e.topColor!==void 0&&(r.Ts=e.topColor),e.bottomColor!==void 0&&(r.Ps=e.bottomColor),r}function Ib(n,t,e,i){const s=e.value,r={se:t,ot:n,Vt:[s,s,s,s],Ib:i};return e.topLineColor!==void 0&&(r.Pe=e.topLineColor),e.bottomLineColor!==void 0&&(r.Re=e.bottomLineColor),e.topFillColor1!==void 0&&(r.Se=e.topFillColor1),e.topFillColor2!==void 0&&(r.ke=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.ye=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.Ce=e.bottomFillColor2),r}function Wb(n,t,e,i){const s={se:t,ot:n,Vt:[e.open,e.high,e.low,e.close],Ib:i};return e.color!==void 0&&(s.V=e.color),s}function Hb(n,t,e,i){const s={se:t,ot:n,Vt:[e.open,e.high,e.low,e.close],Ib:i};return e.color!==void 0&&(s.V=e.color),e.borderColor!==void 0&&(s.Ot=e.borderColor),e.wickColor!==void 0&&(s.Zh=e.wickColor),s}function jb(n,t,e,i,s){const r=St(s)(e),o=Math.max(...r),l=Math.min(...r),h=r[r.length-1],a=[h,o,l,h],c=e,{time:u,color:f}=c;return{se:t,ot:n,Vt:a,Ib:i,He:ju(c,["time","color"]),V:f}}function Rs(n){return n.Vt!==void 0}function ha(n,t){return t.customValues!==void 0&&(n.Wb=t.customValues),n}function Pe(n){return(t,e,i,s,r,o)=>function(l,h){return h?h(l):(a=l).open===void 0&&a.value===void 0;var a}(i,o)?ha({ot:t,se:e,Ib:s},i):ha(n(t,e,i,s,r),i)}function aa(n){return{Candlestick:Pe(Hb),Bar:Pe(Wb),Area:Pe(Vb),Baseline:Pe(Ib),Histogram:Pe(la),Line:Pe(la),Custom:Pe(jb)}[n]}function ca(n){return{se:0,jb:new Map,ha:n}}function ua(n,t){if(n!==void 0&&n.length!==0)return{Hb:t.key(n[0].ot),$b:t.key(n[n.length-1].ot)}}function fa(n){let t;return n.forEach(e=>{t===void 0&&(t=e.Ib)}),St(t)}class Kb{constructor(t){this.Ub=new Map,this.qb=new Map,this.Yb=new Map,this.Zb=[],this.U_=t}S(){this.Ub.clear(),this.qb.clear(),this.Yb.clear(),this.Zb=[]}Xb(t,e){let i=this.Ub.size!==0,s=!1;const r=this.qb.get(t);if(r!==void 0)if(this.qb.size===1)i=!1,s=!0,this.Ub.clear();else for(const h of this.Zb)h.pointData.jb.delete(t)&&(s=!0);let o=[];if(e.length!==0){const h=e.map(g=>g.time),a=this.U_.createConverterToInternalObj(e),c=aa(t.Jh()),u=t.ya(),f=t.Ca();o=e.map((g,p)=>{const m=a(g.time),b=this.U_.key(m);let v=this.Ub.get(b);v===void 0&&(v=ca(m),this.Ub.set(b,v),s=!0);const w=c(m,v.se,g,h[p],u,f);return v.jb.set(t,w),w})}i&&this.Kb(),this.Gb(t,o);let l=-1;if(s){const h=[];this.Ub.forEach(a=>{h.push({timeWeight:0,time:a.ha,pointData:a,originalTime:fa(a.jb)})}),h.sort((a,c)=>this.U_.key(a.time)-this.U_.key(c.time)),l=this.Jb(h)}return this.Qb(t,l,function(h,a,c){const u=ua(h,c),f=ua(a,c);if(u!==void 0&&f!==void 0)return{Ql:u.$b>=f.$b&&u.Hb>=f.Hb}}(this.qb.get(t),r,this.U_))}fd(t){return this.Xb(t,[])}tw(t,e){const i=e;(function(m){m.Ib===void 0&&(m.Ib=m.time)})(i),this.U_.preprocessData(e);const s=this.U_.createConverterToInternalObj([e])(e.time),r=this.Yb.get(t);if(r!==void 0&&this.U_.key(s)<this.U_.key(r))throw new Error(`Cannot update oldest data, last time=${r}, new time=${s}`);let o=this.Ub.get(this.U_.key(s));const l=o===void 0;o===void 0&&(o=ca(s),this.Ub.set(this.U_.key(s),o));const h=aa(t.Jh()),a=t.ya(),c=t.Ca(),u=h(s,o.se,e,i.Ib,a,c);o.jb.set(t,u),this.iw(t,u);const f={Ql:Rs(u)};if(!l)return this.Qb(t,-1,f);const g={timeWeight:0,time:o.ha,pointData:o,originalTime:fa(o.jb)},p=as(this.Zb,this.U_.key(g.time),(m,b)=>this.U_.key(m.time)<b);this.Zb.splice(p,0,g);for(let m=p;m<this.Zb.length;++m)ar(this.Zb[m].pointData,m);return this.U_.fillWeightsForPoints(this.Zb,p),this.Qb(t,p,f)}iw(t,e){let i=this.qb.get(t);i===void 0&&(i=[],this.qb.set(t,i));const s=i.length!==0?i[i.length-1]:null;s===null||this.U_.key(e.ot)>this.U_.key(s.ot)?Rs(e)&&i.push(e):Rs(e)?i[i.length-1]=e:i.splice(-1,1),this.Yb.set(t,e.ot)}Gb(t,e){e.length!==0?(this.qb.set(t,e.filter(Rs)),this.Yb.set(t,e[e.length-1].ot)):(this.qb.delete(t),this.Yb.delete(t))}Kb(){for(const t of this.Zb)t.pointData.jb.size===0&&this.Ub.delete(this.U_.key(t.time))}Jb(t){let e=-1;for(let i=0;i<this.Zb.length&&i<t.length;++i){const s=this.Zb[i],r=t[i];if(this.U_.key(s.time)!==this.U_.key(r.time)){e=i;break}r.timeWeight=s.timeWeight,ar(r.pointData,i)}if(e===-1&&this.Zb.length!==t.length&&(e=Math.min(this.Zb.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)ar(t[i].pointData,i);return this.U_.fillWeightsForPoints(t,e),this.Zb=t,e}nw(){if(this.qb.size===0)return null;let t=0;return this.qb.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].se))}),t}Qb(t,e,i){const s={sw:new Map,St:{Lu:this.nw()}};if(e!==-1)this.qb.forEach((r,o)=>{s.sw.set(o,{He:r,ew:o===t?i:void 0})}),this.qb.has(t)||s.sw.set(t,{He:[],ew:i}),s.St.rw=this.Zb,s.St.hw=e;else{const r=this.qb.get(t);s.sw.set(t,{He:r||[],ew:i})}return s}}function ar(n,t){n.se=t,n.jb.forEach(e=>{e.se=t})}function qo(n){const t={value:n.Vt[3],time:n.Ib};return n.Wb!==void 0&&(t.customValues=n.Wb),t}function da(n){const t=qo(n);return n.V!==void 0&&(t.color=n.V),t}function $b(n){const t=qo(n);return n.lt!==void 0&&(t.lineColor=n.lt),n.Ts!==void 0&&(t.topColor=n.Ts),n.Ps!==void 0&&(t.bottomColor=n.Ps),t}function Ub(n){const t=qo(n);return n.Pe!==void 0&&(t.topLineColor=n.Pe),n.Re!==void 0&&(t.bottomLineColor=n.Re),n.Se!==void 0&&(t.topFillColor1=n.Se),n.ke!==void 0&&(t.topFillColor2=n.ke),n.ye!==void 0&&(t.bottomFillColor1=n.ye),n.Ce!==void 0&&(t.bottomFillColor2=n.Ce),t}function Ku(n){const t={open:n.Vt[0],high:n.Vt[1],low:n.Vt[2],close:n.Vt[3],time:n.Ib};return n.Wb!==void 0&&(t.customValues=n.Wb),t}function Xb(n){const t=Ku(n);return n.V!==void 0&&(t.color=n.V),t}function Gb(n){const t=Ku(n),{V:e,Ot:i,Zh:s}=n;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),s!==void 0&&(t.wickColor=s),t}function ho(n){return{Area:$b,Line:da,Baseline:Ub,Histogram:da,Bar:Xb,Candlestick:Gb,Custom:qb}[n]}function qb(n){const t=n.Ib;return Object.assign(Object.assign({},n.He),{time:t})}const Jb={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Yb={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Zb={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:Fo,attributionLogo:!0},cr={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},Qb={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},tv={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:Fo,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function ga(){return{width:0,height:0,autoSize:!1,layout:Zb,crosshair:Jb,grid:Yb,overlayPriceScales:Object.assign({},cr),leftPriceScale:Object.assign(Object.assign({},cr),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},cr),{visible:!0}),timeScale:Qb,watermark:tv,localization:{locale:gi?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class ev{constructor(t,e){this.lw=t,this.aw=e}applyOptions(t){this.lw.$t().Hc(this.aw,t)}options(){return this.Li().W()}width(){return Sn(this.aw)?this.lw.gb(this.aw):0}Li(){return M(this.lw.$t().$c(this.aw)).Dt}}function pa(n,t,e){const i=ju(n,["time","originalTime"]),s=Object.assign({time:t},i);return e!==void 0&&(s.originalTime=e),s}const iv={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class sv{constructor(t){this.Eh=t}applyOptions(t){this.Eh.Hh(t)}options(){return this.Eh.W()}ow(){return this.Eh}}class nv{constructor(t,e,i,s,r){this._w=new lt,this.Ls=t,this.uw=e,this.cw=i,this.U_=r,this.dw=s}S(){this._w.S()}priceFormatter(){return this.Ls.ma()}priceToCoordinate(t){const e=this.Ls.Ct();return e===null?null:this.Ls.Dt().Rt(t,e.Vt)}coordinateToPrice(t){const e=this.Ls.Ct();return e===null?null:this.Ls.Dt().pn(t,e.Vt)}barsInLogicalRange(t){if(t===null)return null;const e=new si(new Vi(t.from,t.to)).hu(),i=this.Ls.In();if(i.Ni())return null;const s=i.hl(e.Vs(),1),r=i.hl(e.ui(),-1),o=M(i.sl()),l=M(i.An());if(s!==null&&r!==null&&s.se>r.se)return{barsBefore:t.from-o,barsAfter:l-t.to};const h={barsBefore:s===null||s.se===o?t.from-o:s.se-o,barsAfter:r===null||r.se===l?l-t.to:l-r.se};return s!==null&&r!==null&&(h.from=s.Ib,h.to=r.Ib),h}setData(t){this.U_,this.Ls.Jh(),this.uw.fw(this.Ls,t),this.pw("full")}update(t){this.Ls.Jh(),this.uw.mw(this.Ls,t),this.pw("update")}dataByIndex(t,e){const i=this.Ls.In().hl(t,e);return i===null?null:ho(this.seriesType())(i)}data(){const t=ho(this.seriesType());return this.Ls.In().ie().map(e=>t(e))}subscribeDataChanged(t){this._w.l(t)}unsubscribeDataChanged(t){this._w.v(t)}setMarkers(t){this.U_;const e=t.map(i=>pa(i,this.U_.convertHorzItemToInternal(i.time),i.time));this.Ls.ia(e)}markers(){return this.Ls.na().map(t=>pa(t,t.originalTime,void 0))}applyOptions(t){this.Ls.Hh(t)}options(){return ne(this.Ls.W())}priceScale(){return this.cw.priceScale(this.Ls.Dt().Ta())}createPriceLine(t){const e=Wt(ne(iv),t),i=this.Ls.sa(e);return new sv(i)}removePriceLine(t){this.Ls.ea(t.ow())}seriesType(){return this.Ls.Jh()}attachPrimitive(t){this.Ls.Sa(t),t.attached&&t.attached({chart:this.dw,series:this,requestUpdate:()=>this.Ls.$t().Xl()})}detachPrimitive(t){this.Ls.ka(t),t.detached&&t.detached()}pw(t){this._w.M()&&this._w.m(t)}}class rv{constructor(t,e,i){this.bw=new lt,this.pu=new lt,this.Vm=new lt,this.$i=t,this.kl=t.St(),this.lb=e,this.kl.tc().l(this.ww.bind(this)),this.kl.nc().l(this.gw.bind(this)),this.lb.Em().l(this.Mw.bind(this)),this.U_=i}S(){this.kl.tc().p(this),this.kl.nc().p(this),this.lb.Em().p(this),this.bw.S(),this.pu.S(),this.Vm.S()}scrollPosition(){return this.kl.ju()}scrollToPosition(t,e){e?this.kl.Gu(t,1e3):this.$i.Jn(t)}scrollToRealTime(){this.kl.Ku()}getVisibleRange(){const t=this.kl.Du();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.U_.convertHorzItemToInternal(t.from),to:this.U_.convertHorzItemToInternal(t.to)},i=this.kl.Au(e);this.$i.vd(i)}getVisibleLogicalRange(){const t=this.kl.Ru();return t===null?null:{from:t.Vs(),to:t.ui()}}setVisibleLogicalRange(t){De(t.from<=t.to,"The from index cannot be after the to index."),this.$i.vd(t)}resetTimeScale(){this.$i.Kn()}fitContent(){this.$i.rc()}logicalToCoordinate(t){const e=this.$i.St();return e.Ni()?null:e.It(t)}coordinateToLogical(t){return this.kl.Ni()?null:this.kl.Eu(t)}timeToCoordinate(t){const e=this.U_.convertHorzItemToInternal(t),i=this.kl.Da(e,!1);return i===null?null:this.kl.It(i)}coordinateToTime(t){const e=this.$i.St(),i=e.Eu(t),s=e.Ui(i);return s===null?null:s.originalTime}width(){return this.lb._m().width}height(){return this.lb._m().height}subscribeVisibleTimeRangeChange(t){this.bw.l(t)}unsubscribeVisibleTimeRangeChange(t){this.bw.v(t)}subscribeVisibleLogicalRangeChange(t){this.pu.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.pu.v(t)}subscribeSizeChange(t){this.Vm.l(t)}unsubscribeSizeChange(t){this.Vm.v(t)}applyOptions(t){this.kl.Hh(t)}options(){return Object.assign(Object.assign({},ne(this.kl.W())),{barSpacing:this.kl.he()})}ww(){this.bw.M()&&this.bw.m(this.getVisibleRange())}gw(){this.pu.M()&&this.pu.m(this.getVisibleLogicalRange())}Mw(t){this.Vm.m(t.width,t.height)}}function ov(n){if(n===void 0||n.type==="custom")return;const t=n;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const s=Math.round(e);if(Math.abs(s-e)<1e-8)return i;e*=10}return i}(t.minMove))}function ma(n){return function(t){if(Ts(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:s}=t.handleScale;Ts(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),Ts(s)&&(t.handleScale.axisDoubleClickReset={time:s,price:s})}const e=t.handleScroll;Ts(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(n),n}class lv{constructor(t,e,i){this.xw=new Map,this.Sw=new Map,this.kw=new lt,this.yw=new lt,this.Cw=new lt,this.Tw=new Kb(e);const s=i===void 0?ne(ga()):Wt(ne(ga()),ma(i));this.U_=e,this.lw=new Rb(t,s,e),this.lw.hm().l(o=>{this.kw.M()&&this.kw.m(this.Pw(o()))},this),this.lw.lm().l(o=>{this.yw.M()&&this.yw.m(this.Pw(o()))},this),this.lw.Zc().l(o=>{this.Cw.M()&&this.Cw.m(this.Pw(o()))},this);const r=this.lw.$t();this.Rw=new rv(r,this.lw.cb(),this.U_)}remove(){this.lw.hm().p(this),this.lw.lm().p(this),this.lw.Zc().p(this),this.Rw.S(),this.lw.S(),this.xw.clear(),this.Sw.clear(),this.kw.S(),this.yw.S(),this.Cw.S(),this.Tw.S()}resize(t,e,i){this.autoSizeActive()||this.lw.ob(t,e,i)}addCustomSeries(t,e){const i=Je(t),s=Object.assign(Object.assign({},wu),i.defaultOptions());return this.Dw("Custom",s,e,i)}addAreaSeries(t){return this.Dw("Area",Km,t)}addBaselineSeries(t){return this.Dw("Baseline",$m,t)}addBarSeries(t){return this.Dw("Bar",Hm,t)}addCandlestickSeries(t={}){return function(e){e.borderColor!==void 0&&(e.borderUpColor=e.borderColor,e.borderDownColor=e.borderColor),e.wickColor!==void 0&&(e.wickUpColor=e.wickColor,e.wickDownColor=e.wickColor)}(t),this.Dw("Candlestick",Wm,t)}addHistogramSeries(t){return this.Dw("Histogram",Um,t)}addLineSeries(t){return this.Dw("Line",jm,t)}removeSeries(t){const e=St(this.xw.get(t)),i=this.Tw.fd(e);this.lw.$t().fd(e),this.Vw(i),this.xw.delete(t),this.Sw.delete(e)}fw(t,e){this.Vw(this.Tw.Xb(t,e))}mw(t,e){this.Vw(this.Tw.tw(t,e))}subscribeClick(t){this.kw.l(t)}unsubscribeClick(t){this.kw.v(t)}subscribeCrosshairMove(t){this.Cw.l(t)}unsubscribeCrosshairMove(t){this.Cw.v(t)}subscribeDblClick(t){this.yw.l(t)}unsubscribeDblClick(t){this.yw.v(t)}priceScale(t){return new ev(this.lw,t)}timeScale(){return this.Rw}applyOptions(t){this.lw.Hh(ma(t))}options(){return this.lw.W()}takeScreenshot(){return this.lw.bb()}autoSizeActive(){return this.lw.Sb()}chartElement(){return this.lw.kb()}paneSize(){const t=this.lw.Cb();return{height:t.height,width:t.width}}setCrosshairPosition(t,e,i){const s=this.xw.get(i);if(s===void 0)return;const r=this.lw.$t().cr(s);r!==null&&this.lw.$t().ld(t,e,r)}clearCrosshairPosition(){this.lw.$t().ad(!0)}Dw(t,e,i={},s){ov(i.priceFormat);const r=Wt(ne(yu),ne(e),i),o=this.lw.$t().ud(t,r,s),l=new nv(o,this,this,this,this.U_);return this.xw.set(l,o),this.Sw.set(o,l),l}Vw(t){const e=this.lw.$t();e.od(t.St.Lu,t.St.rw,t.St.hw),t.sw.forEach((i,s)=>s.J(i.He,i.ew)),e.Fu()}Ow(t){return St(this.Sw.get(t))}Pw(t){const e=new Map;t.Eb.forEach((s,r)=>{const o=r.Jh(),l=ho(o)(s);if(o!=="Custom")De(Fb(l));else{const h=r.Ca();De(!h||h(l)===!1)}e.set(this.Ow(r),l)});const i=t.Lb!==void 0&&this.Sw.has(t.Lb)?this.Ow(t.Lb):void 0;return{time:t.Ib,logical:t.se,point:t.zb,hoveredSeries:i,hoveredObjectId:t.Nb,seriesData:e,sourceEvent:t.Fb}}}function hv(n,t,e){let i;if(hs(n)){const r=document.getElementById(n);De(r!==null,`Cannot find element in DOM with id=${n}`),i=r}else i=n;const s=new lv(i,t,e);return t.setOptions(s.options()),s}function Kv(n,t){return hv(n,new ea,ea.Ad(t))}Object.assign(Object.assign({},yu),wu);const gt=({variant:n,settings:t,styles:e})=>{const i=B.theme({"&":{backgroundColor:t.background,color:t.foreground},".cm-content":{caretColor:t.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:t.caret},"&.cm-focused .cm-selectionBackgroundm .cm-selectionBackground, .cm-content ::selection":{backgroundColor:t.selection},".cm-activeLine":{backgroundColor:t.lineHighlight},".cm-gutters":{backgroundColor:t.gutterBackground,color:t.gutterForeground},".cm-activeLineGutter":{backgroundColor:t.lineHighlight}},{dark:n==="dark"}),s=ls.define(e);return[i,wm(s)]};gt({variant:"dark",settings:{background:"#200020",foreground:"#D0D0FF",caret:"#7070FF",selection:"#80000080",gutterBackground:"#200020",gutterForeground:"#C080C0",lineHighlight:"#80000040"},styles:[{tag:d.comment,color:"#404080"},{tag:[d.string,d.regexp],color:"#999999"},{tag:d.number,color:"#7090B0"},{tag:[d.bool,d.null],color:"#8080A0"},{tag:[d.punctuation,d.derefOperator],color:"#805080"},{tag:d.keyword,color:"#60B0FF"},{tag:d.definitionKeyword,color:"#B0FFF0"},{tag:d.moduleKeyword,color:"#60B0FF"},{tag:d.operator,color:"#A0A0FF"},{tag:[d.variableName,d.self],color:"#008080"},{tag:d.operatorKeyword,color:"#A0A0FF"},{tag:d.controlKeyword,color:"#80A0FF"},{tag:d.className,color:"#70E080"},{tag:[d.function(d.propertyName),d.propertyName],color:"#50A0A0"},{tag:d.tagName,color:"#009090"},{tag:d.modifier,color:"#B0FFF0"},{tag:[d.squareBracket,d.attributeName],color:"#D0D0FF"}]});gt({variant:"light",settings:{background:"#fcfcfc",foreground:"#5c6166",caret:"#ffaa33",selection:"#036dd626",gutterBackground:"#fcfcfc",gutterForeground:"#8a919966",lineHighlight:"#8a91991a"},styles:[{tag:d.comment,color:"#787b8099"},{tag:d.string,color:"#86b300"},{tag:d.regexp,color:"#4cbf99"},{tag:[d.number,d.bool,d.null],color:"#ffaa33"},{tag:d.variableName,color:"#5c6166"},{tag:[d.definitionKeyword,d.modifier],color:"#fa8d3e"},{tag:[d.keyword,d.special(d.brace)],color:"#fa8d3e"},{tag:d.operator,color:"#ed9366"},{tag:d.separator,color:"#5c6166b3"},{tag:d.punctuation,color:"#5c6166"},{tag:[d.definition(d.propertyName),d.function(d.variableName)],color:"#f2ae49"},{tag:[d.className,d.definition(d.typeName)],color:"#22a4e6"},{tag:[d.tagName,d.typeName,d.self,d.labelName],color:"#55b4d4"},{tag:d.angleBracket,color:"#55b4d480"},{tag:d.attributeName,color:"#f2ae49"}]});gt({variant:"dark",settings:{background:"#15191EFA",foreground:"#EEF2F7",caret:"#C4C4C4",selection:"#90B2D557",gutterBackground:"#15191EFA",gutterForeground:"#aaaaaa95",lineHighlight:"#57575712"},styles:[{tag:d.comment,color:"#6E6E6E"},{tag:[d.string,d.regexp,d.special(d.brace)],color:"#5C81B3"},{tag:d.number,color:"#C1E1B8"},{tag:d.bool,color:"#53667D"},{tag:[d.definitionKeyword,d.modifier,d.function(d.propertyName)],color:"#A3D295",fontWeight:"bold"},{tag:[d.keyword,d.moduleKeyword,d.operatorKeyword,d.operator],color:"#697A8E",fontWeight:"bold"},{tag:[d.variableName,d.attributeName],color:"#708E67"},{tag:[d.function(d.variableName),d.definition(d.propertyName),d.derefOperator],color:"#fff"},{tag:d.tagName,color:"#A3D295"}]});gt({variant:"dark",settings:{background:"#2e241d",foreground:"#BAAE9E",caret:"#A7A7A7",selection:"#DDF0FF33",gutterBackground:"#28211C",gutterForeground:"#BAAE9E90",lineHighlight:"#FFFFFF08"},styles:[{tag:d.comment,color:"#666666"},{tag:[d.string,d.special(d.brace)],color:"#54BE0D"},{tag:d.regexp,color:"#E9C062"},{tag:d.number,color:"#CF6A4C"},{tag:[d.keyword,d.operator],color:"#5EA6EA"},{tag:d.variableName,color:"#7587A6"},{tag:[d.definitionKeyword,d.modifier],color:"#F9EE98"},{tag:[d.propertyName,d.function(d.variableName)],color:"#937121"},{tag:[d.typeName,d.angleBracket,d.tagName],color:"#9B859D"}]});gt({variant:"dark",settings:{background:"#3b2627",foreground:"#E6E1C4",caret:"#E6E1C4",selection:"#16120E",gutterBackground:"#3b2627",gutterForeground:"#E6E1C490",lineHighlight:"#1F1611"},styles:[{tag:d.comment,color:"#6B4E32"},{tag:[d.keyword,d.operator,d.derefOperator],color:"#EF5D32"},{tag:d.className,color:"#EFAC32",fontWeight:"bold"},{tag:[d.typeName,d.propertyName,d.function(d.variableName),d.definition(d.variableName)],color:"#EFAC32"},{tag:d.definition(d.typeName),color:"#EFAC32",fontWeight:"bold"},{tag:d.labelName,color:"#EFAC32",fontWeight:"bold"},{tag:[d.number,d.bool],color:"#6C99BB"},{tag:[d.variableName,d.self],color:"#7DAF9C"},{tag:[d.string,d.special(d.brace),d.regexp],color:"#D9D762"},{tag:[d.angleBracket,d.tagName,d.attributeName],color:"#EFCB43"}]});gt({variant:"dark",settings:{background:"#000205",foreground:"#FFFFFF",caret:"#E60065",selection:"#E60C6559",gutterBackground:"#000205",gutterForeground:"#ffffff90",lineHighlight:"#4DD7FC1A"},styles:[{tag:d.comment,color:"#404040"},{tag:[d.string,d.special(d.brace),d.regexp],color:"#00D8FF"},{tag:d.number,color:"#E62286"},{tag:[d.variableName,d.attributeName,d.self],color:"#E62286",fontWeight:"bold"},{tag:d.function(d.variableName),color:"#fff",fontWeight:"bold"}]});gt({variant:"light",settings:{background:"#fff",foreground:"#000",caret:"#000",selection:"#BDD5FC",gutterBackground:"#fff",gutterForeground:"#00000070",lineHighlight:"#FFFBD1"},styles:[{tag:d.comment,color:"#BCC8BA"},{tag:[d.string,d.special(d.brace),d.regexp],color:"#5D90CD"},{tag:[d.number,d.bool,d.null],color:"#46A609"},{tag:d.keyword,color:"#AF956F"},{tag:[d.definitionKeyword,d.modifier],color:"#C52727"},{tag:[d.angleBracket,d.tagName,d.attributeName],color:"#606060"},{tag:d.self,color:"#000"}]});gt({variant:"dark",settings:{background:"#00254b",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#B36539BF",gutterBackground:"#00254b",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},styles:[{tag:d.comment,color:"#0088FF"},{tag:d.string,color:"#3AD900"},{tag:d.regexp,color:"#80FFC2"},{tag:[d.number,d.bool,d.null],color:"#FF628C"},{tag:[d.definitionKeyword,d.modifier],color:"#FFEE80"},{tag:d.variableName,color:"#CCCCCC"},{tag:d.self,color:"#FF80E1"},{tag:[d.className,d.definition(d.propertyName),d.function(d.variableName),d.definition(d.typeName),d.labelName],color:"#FFDD00"},{tag:[d.keyword,d.operator],color:"#FF9D00"},{tag:[d.propertyName,d.typeName],color:"#80FFBB"},{tag:d.special(d.brace),color:"#EDEF7D"},{tag:d.attributeName,color:"#9EFFFF"},{tag:d.derefOperator,color:"#fff"}]});gt({variant:"dark",settings:{background:"#060521",foreground:"#E0E0E0",caret:"#FFFFFFA6",selection:"#122BBB",gutterBackground:"#060521",gutterForeground:"#E0E0E090",lineHighlight:"#FFFFFF0F"},styles:[{tag:d.comment,color:"#AEAEAE"},{tag:[d.string,d.special(d.brace),d.regexp],color:"#8DFF8E"},{tag:[d.className,d.definition(d.propertyName),d.function(d.variableName),d.function(d.definition(d.variableName)),d.definition(d.typeName)],color:"#A3EBFF"},{tag:[d.number,d.bool,d.null],color:"#62E9BD"},{tag:[d.keyword,d.operator],color:"#2BF1DC"},{tag:[d.definitionKeyword,d.modifier],color:"#F8FBB1"},{tag:[d.variableName,d.self],color:"#B683CA"},{tag:[d.angleBracket,d.tagName,d.typeName,d.propertyName],color:"#60A4F1"},{tag:d.derefOperator,color:"#E0E0E0"},{tag:d.attributeName,color:"#7BACCA"}]});gt({variant:"dark",settings:{background:"#2d2f3f",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"#44475a",gutterBackground:"#282a36",gutterForeground:"rgb(144, 145, 148)",lineHighlight:"#44475a"},styles:[{tag:d.comment,color:"#6272a4"},{tag:[d.string,d.special(d.brace)],color:"#f1fa8c"},{tag:[d.number,d.self,d.bool,d.null],color:"#bd93f9"},{tag:[d.keyword,d.operator],color:"#ff79c6"},{tag:[d.definitionKeyword,d.typeName],color:"#8be9fd"},{tag:d.definition(d.typeName),color:"#f8f8f2"},{tag:[d.className,d.definition(d.propertyName),d.function(d.variableName),d.attributeName],color:"#50fa7b"}]});gt({variant:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#000000",selection:"#80C7FF",gutterBackground:"#FFFFFF",gutterForeground:"#00000070",lineHighlight:"#C1E2F8"},styles:[{tag:d.comment,color:"#AAAAAA"},{tag:[d.keyword,d.operator,d.typeName,d.tagName,d.propertyName],color:"#2F6F9F",fontWeight:"bold"},{tag:[d.attributeName,d.definition(d.propertyName)],color:"#4F9FD0"},{tag:[d.className,d.string,d.special(d.brace)],color:"#CF4F5F"},{tag:d.number,color:"#CF4F5F",fontWeight:"bold"},{tag:d.variableName,fontWeight:"bold"}]});gt({variant:"light",settings:{background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#e1def3"},styles:[{tag:d.comment,color:"#9995b7"},{tag:d.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[d.definitionKeyword,d.modifier],color:"#ff5792"},{tag:[d.className,d.tagName,d.definition(d.typeName)],color:"#0094f0"},{tag:[d.number,d.bool,d.null,d.special(d.brace)],color:"#5842ff"},{tag:[d.definition(d.propertyName),d.function(d.variableName)],color:"#0095a8"},{tag:d.typeName,color:"#b3694d"},{tag:[d.propertyName,d.variableName],color:"#fa8900"},{tag:d.operator,color:"#ff5792"},{tag:d.self,color:"#e64100"},{tag:[d.string,d.regexp],color:"#00b368"},{tag:[d.paren,d.bracket],color:"#0431fa"},{tag:d.labelName,color:"#00bdd6"},{tag:d.attributeName,color:"#e64100"},{tag:d.angleBracket,color:"#9995b7"}]});gt({variant:"light",settings:{background:"#faf4ed",foreground:"#575279",caret:"#575279",selection:"#6e6a8614",gutterBackground:"#faf4ed",gutterForeground:"#57527970",lineHighlight:"#6e6a860d"},styles:[{tag:d.comment,color:"#9893a5"},{tag:[d.bool,d.null],color:"#286983"},{tag:d.number,color:"#d7827e"},{tag:d.className,color:"#d7827e"},{tag:[d.angleBracket,d.tagName,d.typeName],color:"#56949f"},{tag:d.attributeName,color:"#907aa9"},{tag:d.punctuation,color:"#797593"},{tag:[d.keyword,d.modifier],color:"#286983"},{tag:[d.string,d.regexp],color:"#ea9d34"},{tag:d.variableName,color:"#d7827e"}]});gt({variant:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#000000",selection:"#FFFD0054",gutterBackground:"#FFFFFF",gutterForeground:"#00000070",lineHighlight:"#00000008"},styles:[{tag:d.comment,color:"#CFCFCF"},{tag:[d.number,d.bool,d.null],color:"#E66C29"},{tag:[d.className,d.definition(d.propertyName),d.function(d.variableName),d.labelName,d.definition(d.typeName)],color:"#2EB43B"},{tag:d.keyword,color:"#D8B229"},{tag:d.operator,color:"#4EA44E",fontWeight:"bold"},{tag:[d.definitionKeyword,d.modifier],color:"#925A47"},{tag:d.string,color:"#704D3D"},{tag:d.typeName,color:"#2F8996"},{tag:[d.variableName,d.propertyName],color:"#77ACB0"},{tag:d.self,color:"#77ACB0",fontWeight:"bold"},{tag:d.regexp,color:"#E3965E"},{tag:[d.tagName,d.angleBracket],color:"#BAA827"},{tag:d.attributeName,color:"#B06520"},{tag:d.derefOperator,color:"#000"}]});gt({variant:"light",settings:{background:"#fef7e5",foreground:"#586E75",caret:"#000000",selection:"#073642",gutterBackground:"#fef7e5",gutterForeground:"#586E7580",lineHighlight:"#EEE8D5"},styles:[{tag:d.comment,color:"#93A1A1"},{tag:d.string,color:"#2AA198"},{tag:d.regexp,color:"#D30102"},{tag:d.number,color:"#D33682"},{tag:d.variableName,color:"#268BD2"},{tag:[d.keyword,d.operator,d.punctuation],color:"#859900"},{tag:[d.definitionKeyword,d.modifier],color:"#073642",fontWeight:"bold"},{tag:[d.className,d.self,d.definition(d.propertyName)],color:"#268BD2"},{tag:d.function(d.variableName),color:"#268BD2"},{tag:[d.bool,d.null],color:"#B58900"},{tag:d.tagName,color:"#268BD2",fontWeight:"bold"},{tag:d.angleBracket,color:"#93A1A1"},{tag:d.attributeName,color:"#93A1A1"},{tag:d.typeName,color:"#859900"}]});gt({variant:"light",settings:{background:"#FFFFFF",foreground:"#4D4D4C",caret:"#AEAFAD",selection:"#D6D6D6",gutterBackground:"#FFFFFF",gutterForeground:"#4D4D4C80",lineHighlight:"#EFEFEF"},styles:[{tag:d.comment,color:"#8E908C"},{tag:[d.variableName,d.self,d.propertyName,d.attributeName,d.regexp],color:"#C82829"},{tag:[d.number,d.bool,d.null],color:"#F5871F"},{tag:[d.className,d.typeName,d.definition(d.typeName)],color:"#C99E00"},{tag:[d.string,d.special(d.brace)],color:"#718C00"},{tag:d.operator,color:"#3E999F"},{tag:[d.definition(d.propertyName),d.function(d.variableName)],color:"#4271AE"},{tag:d.keyword,color:"#8959A8"},{tag:d.derefOperator,color:"#4D4D4C"}]});const av=gt({variant:"light",settings:{background:"#ffffff",foreground:"#001080",caret:"#000000",selection:"#add6ff",lineHighlight:"#77777740",gutterBackground:"#eeeeee",gutterForeground:"#237893"},styles:[{tag:d.comment,color:"#008001"},{tag:d.variableName,color:"#0070c1"},{tag:[d.string,d.special(d.brace)],color:"#b55b00"},{tag:d.number,color:"#00b97b"},{tag:d.bool,color:"#0000ff"},{tag:d.null,color:"#0000ff"},{tag:d.unit,color:"#0000ff"},{tag:d.keyword,color:"#af01db"},{tag:d.operator,color:"#000000"},{tag:d.className,color:"#257f99"},{tag:d.meta,color:"#0950a9"},{tag:d.definition(d.typeName),color:"#257f99"},{tag:d.angleBracket,color:"#213CF1"},{tag:d.brace,color:"#213CF1"},{tag:d.bracket,color:"#213CF1"},{tag:d.squareBracket,color:"#213CF1"},{tag:d.paren,color:"#213CF1"},{tag:d.punctuation,color:"#464646"},{tag:d.separator,color:"#464646"},{tag:d.typeName,color:"#257f99"},{tag:d.tagName,color:"#800000"},{tag:d.attributeName,color:"#eb3d36"},{tag:d.attributeValue,color:"#444444"},{tag:d.content,color:"#b55b00"},{tag:[d.propertyName,d.definition(d.propertyName)],color:"#0469ff"},{tag:d.labelName,color:"#4fc4ff"},{tag:d.deleted,color:"#cc0000"}]}),cv=gt({variant:"dark",settings:{background:"#1e1e1e",foreground:"#d4d4d4",caret:"#d4d4d4",selection:"#ffffff",lineHighlight:"#99999940",gutterBackground:"#282828",gutterForeground:"#858585"},styles:[{tag:[d.comment,d.lineComment],color:"#6c9e57"},{tag:d.variableName,color:"#9cdcfe"},{tag:[d.string,d.special(d.brace)],color:"#ce9178"},{tag:d.number,color:"#B6CFA9"},{tag:d.bool,color:"#4fc4ff"},{tag:d.null,color:"#4fc4ff"},{tag:d.unit,color:"#608FC2"},{tag:d.keyword,color:"#d18dcc"},{tag:d.operator,color:"#d4d4d4"},{tag:d.className,color:"#4dcab1"},{tag:d.meta,color:"#608FC2"},{tag:d.definition(d.typeName),color:"#4fcfb5"},{tag:d.angleBracket,color:"#F9D849"},{tag:d.brace,color:"#F9D849"},{tag:d.bracket,color:"#F9D849"},{tag:d.squareBracket,color:"#F9D849"},{tag:d.paren,color:"#F9D849"},{tag:d.punctuation,color:"#d4d4d4"},{tag:d.separator,color:"#d4d4d4"},{tag:d.typeName,color:"#4ecdb4"},{tag:d.tagName,color:"#59a3df"},{tag:d.attributeName,color:"#ffffff"},{tag:d.attributeValue,color:"#ffffff"},{tag:d.content,color:"#ce9178"},{tag:[d.propertyName,d.definition(d.propertyName)],color:"#608FC2"},{tag:d.labelName,color:"#4fc4ff"},{tag:d.deleted,color:"#c86464"}]}),uv={layout:{textColor:"white",background:{type:dn.Solid,color:"transparent"}},grid:{vertLines:{color:"#484848"},horzLines:{color:"#484848"}}},fv={layout:{textColor:"black",background:{type:dn.Solid,color:"transparent"}},grid:{vertLines:{color:"#ECECEC"},horzLines:{color:"#ECECEC"}}};function dv(){const n=localStorage.getItem("color-theme");return n||(document.body.classList.contains("dark")?"dark":"light")}const Jo=Ju(dv());Jo.subscribe(n=>localStorage.setItem("color-theme",n));const $v=wa(Jo,n=>n==="dark"?cv:av),Uv=wa(Jo,n=>n==="dark"?uv:fv);export{Wv as $,mi as A,vv as B,ft as C,it as D,B as E,O as F,K as G,xv as H,ru as I,Eg as J,Uc as K,Rt as L,Lv as M,H as N,li as O,gn as P,At as Q,_e as R,Ht as S,yt as T,j as U,Kv as V,Dv as W,Le as X,Pv as Y,Nv as Z,Cv as _,$v as a,kv as a0,Sv as a1,Fv as a2,wm as a3,Hv as a4,jv as a5,Ev as a6,Tv as a7,Mv as a8,Iv as a9,Av as aa,Ep as ab,Jc as ac,Dt as ad,yp as ae,at as af,et as ag,Vp as ah,d as ai,Qr as aj,Zp as ak,Rv as al,lm as am,Vv as an,_v as ao,zv as ap,su as aq,af as b,Jo as c,D as d,ko as e,Jp as f,qp as g,es as h,nu as i,oe as j,tt as k,Uv as l,Yp as m,$ as n,Es as o,Yt as p,dt as q,I as r,te as s,Df as t,Oi as u,wv as v,fr as w,Ov as x,se as y,eh as z};
//# sourceMappingURL=darkMode.B5NsPcRX.js.map
